!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){return t+"_"+e}e.__esModule=!0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},s=n(1),c=function(){function t(){r(this,t),window.KiwoomHelper=this,this._eventHandler={},this._screenNo=0,this._requestScreens=[],this._registerScreens=[],this._attach()}return t.prototype._attach=function(){var e=this;t.EVENTS.forEach(function(t){document.addEventListener(t+".kiwoom",e)})},t.prototype._getScreenNo=function(){return"SRC"+this._screenNo++},t.prototype.handleEvent=function(t){var e=t.detail,n=t.type.substring(0,t.type.indexOf(".kiwoom"));"receiveTrData"===n&&(e.size=kiwoom?kiwoom.getRepeatCnt(e.trCode,e.rQName):0);var r=this._eventHandler[o(n,e.trCode)];r&&r.call(this,e)},t.prototype.on=function(e,n,r){var s=this;if(t.EVENTS.indexOf(e)!==-1)return"object"===("undefined"==typeof n?"undefined":i(n))&&"undefined"==typeof r?(Object.keys(n).forEach(function(t){s.on(e,t,n[t])}),this):("string"==typeof n&&"function"==typeof r&&(this._eventHandler[o(e,n)]=r),this)},t.prototype.off=function(t,e){var n=this;return 0===arguments.length?(this._eventHandler={},this):("undefined"==typeof e?this._eventHandler[t]=void 0:"string"==typeof e?this._eventHandler[o(t,e)]=void 0:Array.isArray(e)&&Object.keys(this._eventHandler).filter(function(e){return 0===e.indexOf(t+"_")}).forEach(function(e){n._eventHandler[o(t,e)]=void 0}),this)},t.prototype.isLogin=function(){return kiwoom.getConnectState()},t.prototype.login=function(){return new s.Promise(function(t,e){var n=kiwoom.getConnectState();if(0==n){var r=kiwoom.commConnect();r<0&&e(Error(r))}else 1==n&&t();var o=function i(n){var r=n.detail;0==r?t():e(Error(r)),document.removeEventListener("eventConnect.kiwoom",i)};document.addEventListener("eventConnect.kiwoom",o)})},t.prototype.getLoginInfo=function(){return{account:kiwoom.getLoginInfo("ACCNO").replace(/;$/,"").split(";"),user:{id:kiwoom.getLoginInfo("USER_ID"),name:kiwoom.getLoginInfo("USER_NAME")}}},t.prototype.request=function(t,e){var n=!(arguments.length<=2||void 0===arguments[2])&&arguments[2];Object.keys(e).forEach(function(t){kiwoom.setInputValue(t,e[t])});var r=this._getScreenNo(),o=kiwoom.commRqData(t,t,n?2:0,r);return 0===o&&this._requestScreens.push(r),r},t.prototype.register=function(t,e){var n=arguments.length<=2||void 0===arguments[2]||arguments[2];Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]);var r=this._getScreenNo(),o=kiwoom.setRealReg(r,t.join(";"),e.join(";"),n?0:1);return 0===o&&this._registerScreens.push(r),o},t.prototype.disconnect=function(t){var e=arguments.length<=1||void 0===arguments[1]?"ALL":arguments[1];t?this._requestScreens.indexOf(t)!==-1?kiwwom.DisconnectRealData(t):this._registerScreens.indexOf(t)!==-1&&kiwwom.SetRealRemove(t,e):(this._requestScreens.forEach(function(t){kiwwom.DisconnectRealData(t)}),this._requestScreens.length=0,kiwwom.SetRealRemove("ALL","ALL"),this._registerScreens.length=0)},t.prototype.get=function(){switch(arguments.length){case 1:return JSON.parse(kiwoom.getCommDataEx(arguments[0],arguments[0]));case 2:return kiwoom.commGetData(arguments[0],"-1","",arguments[1],"");case 3:if(!isNaN(arguments[1])&&isNaN(arguments[2])){var t;return(t=kiwoom).commGetData.apply(t,[arguments[0],""].concat(Array.prototype.slice.call(arguments)))}var e;return(e=kiwoom).commGetData.apply(e,Array.prototype.slice.call(arguments).concat([0,""]))}},t}();c.EVENTS=["receiveMsg","receiveTrData","receiveRealData","receiveChejanData","receiveConditionVer","receiveTrCondition","receiveRealCondition"],e["default"]=new c},function(t,e,n){var r;(function(t,o,i){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
	 * @version   3.2.1
	 */
(function(){"use strict";function s(t){return"function"==typeof t||"object"==typeof t&&null!==t}function c(t){return"function"==typeof t}function u(t){$=t}function a(t){tt=t}function f(){return function(){t.nextTick(v)}}function l(){return function(){W(v)}}function h(){var t=0,e=new rt(v),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function p(){var t=new MessageChannel;return t.port1.onmessage=v,function(){t.port2.postMessage(0)}}function d(){return function(){setTimeout(v,1)}}function v(){for(var t=0;t<Z;t+=2){var e=st[t],n=st[t+1];e(n),st[t]=void 0,st[t+1]=void 0}Z=0}function y(){try{var t=n(5);return W=t.runOnLoop||t.runOnContext,l()}catch(e){return d()}}function m(t,e){var n=this,r=new this.constructor(w);void 0===r[at]&&q(r);var o=n._state;if(o){var i=arguments[o-1];tt(function(){M(o,r,i,n._result)})}else N(n,r,t,e);return r}function _(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(w);return x(n,t),n}function w(){}function g(){return new TypeError("You cannot resolve a promise with itself")}function b(){return new TypeError("A promises callback cannot return that same promise.")}function S(t){try{return t.then}catch(e){return pt.error=e,pt}}function E(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function A(t,e,n){tt(function(t){var r=!1,o=E(n,e,function(n){r||(r=!0,e!==n?x(t,n):L(t,n))},function(e){r||(r=!0,j(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,j(t,o))},t)}function k(t,e){e._state===lt?L(t,e._result):e._state===ht?j(t,e._result):N(e,void 0,function(e){x(t,e)},function(e){j(t,e)})}function C(t,e,n){e.constructor===t.constructor&&n===ct&&constructor.resolve===ut?k(t,e):n===pt?j(t,pt.error):void 0===n?L(t,e):c(n)?A(t,e,n):L(t,e)}function x(t,e){t===e?j(t,g()):s(e)?C(t,e,S(e)):L(t,e)}function T(t){t._onerror&&t._onerror(t._result),O(t)}function L(t,e){t._state===ft&&(t._result=e,t._state=lt,0!==t._subscribers.length&&tt(O,t))}function j(t,e){t._state===ft&&(t._state=ht,t._result=e,tt(T,t))}function N(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+lt]=n,o[i+ht]=r,0===i&&t._state&&tt(O,t)}function O(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?M(n,r,o,i):o(i);t._subscribers.length=0}}function D(){this.error=null}function R(t,e){try{return t(e)}catch(n){return dt.error=n,dt}}function M(t,e,n,r){var o,i,s,u,a=c(n);if(a){if(o=R(n,r),o===dt?(u=!0,i=o.error,o=null):s=!0,e===o)return void j(e,b())}else o=r,s=!0;e._state!==ft||(a&&s?x(e,o):u?j(e,i):t===lt?L(e,o):t===ht&&j(e,o))}function P(t,e){try{e(function(e){x(t,e)},function(e){j(t,e)})}catch(n){j(t,n)}}function H(){return vt++}function q(t){t[at]=vt++,t._state=void 0,t._result=void 0,t._subscribers=[]}function I(t){return new gt(this,t).promise}function V(t){var e=this;return new e(X(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){e(new TypeError("You must pass an array to race."))})}function G(t){var e=this,n=new e(w);return j(n,t),n}function U(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Y(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function F(t){this[at]=H(),this._result=this._state=void 0,this._subscribers=[],w!==t&&("function"!=typeof t&&U(),this instanceof F?P(this,t):Y())}function K(t,e){this._instanceConstructor=t,this.promise=new t(w),this.promise[at]||q(this.promise),X(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?L(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&L(this.promise,this._result))):j(this.promise,z())}function z(){return new Error("Array Methods must be provided an Array")}function J(){var t;if("undefined"!=typeof o)t=o;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;n&&"[object Promise]"===Object.prototype.toString.call(n.resolve())&&!n.cast||(t.Promise=wt)}var Q;Q=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var W,$,B,X=Q,Z=0,tt=function(t,e){st[Z]=t,st[Z+1]=e,Z+=2,2===Z&&($?$(v):B())},et="undefined"!=typeof window?window:void 0,nt=et||{},rt=nt.MutationObserver||nt.WebKitMutationObserver,ot="undefined"==typeof self&&"undefined"!=typeof t&&"[object process]"==={}.toString.call(t),it="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,st=new Array(1e3);B=ot?f():rt?h():it?p():void 0===et?y():d();var ct=m,ut=_,at=Math.random().toString(36).substring(16),ft=void 0,lt=1,ht=2,pt=new D,dt=new D,vt=0,yt=I,mt=V,_t=G,wt=F;F.all=yt,F.race=mt,F.resolve=ut,F.reject=_t,F._setScheduler=u,F._setAsap=a,F._asap=tt,F.prototype={constructor:F,then:ct,"catch":function(t){return this.then(null,t)}};var gt=K;K.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===ft&&n<t;n++)this._eachEntry(e[n],n)},K.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===ut){var o=S(t);if(o===ct&&t._state!==ft)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===wt){var i=new n(w);C(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){e(t)}),e)}else this._willSettleAt(r(t),e)},K.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===ft&&(this._remaining--,t===ht?j(r,n):this._result[e]=n),0===this._remaining&&L(r,this._result)},K.prototype._willSettleAt=function(t,e){var n=this;N(t,void 0,function(t){n._settledAt(lt,e,t)},function(t){n._settledAt(ht,e,t)})};var bt=J,St={Promise:wt,polyfill:bt};n(3).amd?(r=function(){return St}.call(e,n,e,i),!(void 0!==r&&(i.exports=r))):"undefined"!=typeof i&&i.exports?i.exports=St:"undefined"!=typeof this&&(this.ES6Promise=St),bt()}).call(this)}).call(e,n(2),function(){return this}(),n(4)(t))},function(t,e){function n(){l&&a&&(l=!1,a.length?f=a.concat(f):h=-1,f.length&&r())}function r(){if(!l){var t=s(n);l=!0;for(var e=f.length;e;){for(a=f,f=[];++h<e;)a&&a[h].run();h=-1,e=f.length}a=null,l=!1,c(t)}}function o(t,e){this.fun=t,this.array=e}function i(){}var s,c,u=t.exports={};!function(){try{s=setTimeout}catch(t){s=function(){throw new Error("setTimeout is not defined")}}try{c=clearTimeout}catch(t){c=function(){throw new Error("clearTimeout is not defined")}}}();var a,f=[],l=!1,h=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new o(t,e)),1!==f.length||l||s(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=i,u.addListener=i,u.once=i,u.off=i,u.removeListener=i,u.removeAllListeners=i,u.emit=i,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8va2l3b29tLWhlbHBlci5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgNTdkZWU5Njc4MDAxNDA1OTEyNmUiLCJ3ZWJwYWNrOi8vLy4va2l3b29tLWhlbHBlci5qcyIsIndlYnBhY2s6Ly8vLi4vfi9lczYtcHJvbWlzZS9kaXN0L2VzNi1wcm9taXNlLmpzIiwid2VicGFjazovLy8uLi9+L3Byb2Nlc3MvYnJvd3Nlci5qcyIsIndlYnBhY2s6Ly8vLi4vfi93ZWJwYWNrL2J1aWxkaW4vYW1kLWRlZmluZS5qcyIsIndlYnBhY2s6Ly8vLi4vfi93ZWJwYWNrL2J1aWxkaW4vbW9kdWxlLmpzIl0sIm5hbWVzIjpbIm1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpbnN0YWxsZWRNb2R1bGVzIiwiZXhwb3J0cyIsIm1vZHVsZSIsImlkIiwibG9hZGVkIiwiY2FsbCIsIm0iLCJjIiwicCIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJnZXRFdmVudEtleSIsImV2ZW50TmFtZSIsInRyQ29kZSIsIl9fZXNNb2R1bGUiLCJfdHlwZW9mIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJvYmoiLCJjb25zdHJ1Y3RvciIsIl9lczZQcm9taXNlIiwiS2l3b29tSGVscGVyIiwidGhpcyIsIndpbmRvdyIsIl9ldmVudEhhbmRsZXIiLCJfc2NyZWVuTm8iLCJfcmVxdWVzdFNjcmVlbnMiLCJfcmVnaXN0ZXJTY3JlZW5zIiwiX2F0dGFjaCIsInByb3RvdHlwZSIsIl90aGlzIiwiRVZFTlRTIiwiZm9yRWFjaCIsInYiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZ2V0U2NyZWVuTm8iLCJoYW5kbGVFdmVudCIsImUiLCJkYXRhIiwiZGV0YWlsIiwidHlwZSIsInN1YnN0cmluZyIsImluZGV4T2YiLCJzaXplIiwia2l3b29tIiwiZ2V0UmVwZWF0Q250IiwiclFOYW1lIiwiaGFuZGxlciIsIm9uIiwiX3RoaXMyIiwiT2JqZWN0Iiwia2V5cyIsIm9mZiIsIl90aGlzMyIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsIkFycmF5IiwiaXNBcnJheSIsImZpbHRlciIsImlzTG9naW4iLCJnZXRDb25uZWN0U3RhdGUiLCJsb2dpbiIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0Iiwic3RhdHVzIiwicnQiLCJjb21tQ29ubmVjdCIsIkVycm9yIiwiaGFuZGVyIiwiZXJyY29kZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJnZXRMb2dpbkluZm8iLCJhY2NvdW50IiwicmVwbGFjZSIsInNwbGl0IiwidXNlciIsIm5hbWUiLCJyZXF1ZXN0IiwiaW5wdXQiLCJpc0NvbnRpbnVlIiwic2V0SW5wdXRWYWx1ZSIsInNjcmVlbk5vIiwicmVzdWx0IiwiY29tbVJxRGF0YSIsInB1c2giLCJyZWdpc3RlciIsInN0b2NrY29kZXMiLCJmaWRzIiwiaXNOZXciLCJzZXRSZWFsUmVnIiwiam9pbiIsImRpc2Nvbm5lY3QiLCJzdG9ja2NvZGUiLCJraXd3b20iLCJEaXNjb25uZWN0UmVhbERhdGEiLCJTZXRSZWFsUmVtb3ZlIiwiZ2V0IiwiSlNPTiIsInBhcnNlIiwiZ2V0Q29tbURhdGFFeCIsImNvbW1HZXREYXRhIiwiaXNOYU4iLCJfa2l3b29tIiwiYXBwbHkiLCJjb25jYXQiLCJzbGljZSIsIl9raXdvb20yIiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18iLCJwcm9jZXNzIiwiZ2xvYmFsIiwibGliJGVzNiRwcm9taXNlJHV0aWxzJCRvYmplY3RPckZ1bmN0aW9uIiwieCIsImxpYiRlczYkcHJvbWlzZSR1dGlscyQkaXNGdW5jdGlvbiIsImxpYiRlczYkcHJvbWlzZSRhc2FwJCRzZXRTY2hlZHVsZXIiLCJzY2hlZHVsZUZuIiwibGliJGVzNiRwcm9taXNlJGFzYXAkJGN1c3RvbVNjaGVkdWxlckZuIiwibGliJGVzNiRwcm9taXNlJGFzYXAkJHNldEFzYXAiLCJhc2FwRm4iLCJsaWIkZXM2JHByb21pc2UkYXNhcCQkYXNhcCIsImxpYiRlczYkcHJvbWlzZSRhc2FwJCR1c2VOZXh0VGljayIsIm5leHRUaWNrIiwibGliJGVzNiRwcm9taXNlJGFzYXAkJGZsdXNoIiwibGliJGVzNiRwcm9taXNlJGFzYXAkJHVzZVZlcnR4VGltZXIiLCJsaWIkZXM2JHByb21pc2UkYXNhcCQkdmVydHhOZXh0IiwibGliJGVzNiRwcm9taXNlJGFzYXAkJHVzZU11dGF0aW9uT2JzZXJ2ZXIiLCJpdGVyYXRpb25zIiwib2JzZXJ2ZXIiLCJsaWIkZXM2JHByb21pc2UkYXNhcCQkQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIiLCJub2RlIiwiY3JlYXRlVGV4dE5vZGUiLCJvYnNlcnZlIiwiY2hhcmFjdGVyRGF0YSIsImxpYiRlczYkcHJvbWlzZSRhc2FwJCR1c2VNZXNzYWdlQ2hhbm5lbCIsImNoYW5uZWwiLCJNZXNzYWdlQ2hhbm5lbCIsInBvcnQxIiwib25tZXNzYWdlIiwicG9ydDIiLCJwb3N0TWVzc2FnZSIsImxpYiRlczYkcHJvbWlzZSRhc2FwJCR1c2VTZXRUaW1lb3V0Iiwic2V0VGltZW91dCIsImkiLCJsaWIkZXM2JHByb21pc2UkYXNhcCQkbGVuIiwiY2FsbGJhY2siLCJsaWIkZXM2JHByb21pc2UkYXNhcCQkcXVldWUiLCJhcmciLCJsaWIkZXM2JHByb21pc2UkYXNhcCQkYXR0ZW1wdFZlcnR4IiwidmVydHgiLCJydW5Pbkxvb3AiLCJydW5PbkNvbnRleHQiLCJsaWIkZXM2JHByb21pc2UkdGhlbiQkdGhlbiIsIm9uRnVsZmlsbG1lbnQiLCJvblJlamVjdGlvbiIsInBhcmVudCIsImNoaWxkIiwibGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkbm9vcCIsImxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFBST01JU0VfSUQiLCJsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRtYWtlUHJvbWlzZSIsInN0YXRlIiwiX3N0YXRlIiwibGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkaW52b2tlQ2FsbGJhY2siLCJfcmVzdWx0IiwibGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkc3Vic2NyaWJlIiwibGliJGVzNiRwcm9taXNlJHByb21pc2UkcmVzb2x2ZSQkcmVzb2x2ZSIsIm9iamVjdCIsInByb21pc2UiLCJsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRyZXNvbHZlIiwibGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkc2VsZkZ1bGZpbGxtZW50IiwibGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkY2Fubm90UmV0dXJuT3duIiwibGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkZ2V0VGhlbiIsInRoZW4iLCJlcnJvciIsImxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJEdFVF9USEVOX0VSUk9SIiwibGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkdHJ5VGhlbiIsInZhbHVlIiwiZnVsZmlsbG1lbnRIYW5kbGVyIiwicmVqZWN0aW9uSGFuZGxlciIsImxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGhhbmRsZUZvcmVpZ25UaGVuYWJsZSIsInRoZW5hYmxlIiwic2VhbGVkIiwibGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkZnVsZmlsbCIsInJlYXNvbiIsImxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlamVjdCIsIl9sYWJlbCIsImxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGhhbmRsZU93blRoZW5hYmxlIiwibGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkRlVMRklMTEVEIiwibGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkUkVKRUNURUQiLCJsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRoYW5kbGVNYXliZVRoZW5hYmxlIiwibWF5YmVUaGVuYWJsZSIsImxpYiRlczYkcHJvbWlzZSR0aGVuJCRkZWZhdWx0IiwibGliJGVzNiRwcm9taXNlJHByb21pc2UkcmVzb2x2ZSQkZGVmYXVsdCIsImxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHB1Ymxpc2hSZWplY3Rpb24iLCJfb25lcnJvciIsImxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHB1Ymxpc2giLCJsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRQRU5ESU5HIiwiX3N1YnNjcmliZXJzIiwic3Vic2NyaWJlcnMiLCJzZXR0bGVkIiwibGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkRXJyb3JPYmplY3QiLCJsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCR0cnlDYXRjaCIsImxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFRSWV9DQVRDSF9FUlJPUiIsInN1Y2NlZWRlZCIsImZhaWxlZCIsImhhc0NhbGxiYWNrIiwibGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkaW5pdGlhbGl6ZVByb21pc2UiLCJyZXNvbHZlciIsImxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJG5leHRJZCIsImxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGlkIiwibGliJGVzNiRwcm9taXNlJHByb21pc2UkYWxsJCRhbGwiLCJlbnRyaWVzIiwibGliJGVzNiRwcm9taXNlJGVudW1lcmF0b3IkJGRlZmF1bHQiLCJsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRyYWNlJCRyYWNlIiwibGliJGVzNiRwcm9taXNlJHV0aWxzJCRpc0FycmF5IiwibGliJGVzNiRwcm9taXNlJHByb21pc2UkcmVqZWN0JCRyZWplY3QiLCJsaWIkZXM2JHByb21pc2UkcHJvbWlzZSQkbmVlZHNSZXNvbHZlciIsImxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRuZWVkc05ldyIsImxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRQcm9taXNlIiwibGliJGVzNiRwcm9taXNlJGVudW1lcmF0b3IkJEVudW1lcmF0b3IiLCJfaW5zdGFuY2VDb25zdHJ1Y3RvciIsIl9pbnB1dCIsIl9yZW1haW5pbmciLCJfZW51bWVyYXRlIiwibGliJGVzNiRwcm9taXNlJGVudW1lcmF0b3IkJHZhbGlkYXRpb25FcnJvciIsImxpYiRlczYkcHJvbWlzZSRwb2x5ZmlsbCQkcG9seWZpbGwiLCJsb2NhbCIsInNlbGYiLCJGdW5jdGlvbiIsIlAiLCJ0b1N0cmluZyIsImNhc3QiLCJsaWIkZXM2JHByb21pc2UkcHJvbWlzZSQkZGVmYXVsdCIsImxpYiRlczYkcHJvbWlzZSR1dGlscyQkX2lzQXJyYXkiLCJsaWIkZXM2JHByb21pc2UkYXNhcCQkc2NoZWR1bGVGbHVzaCIsImxpYiRlczYkcHJvbWlzZSRhc2FwJCRicm93c2VyV2luZG93IiwibGliJGVzNiRwcm9taXNlJGFzYXAkJGJyb3dzZXJHbG9iYWwiLCJNdXRhdGlvbk9ic2VydmVyIiwiV2ViS2l0TXV0YXRpb25PYnNlcnZlciIsImxpYiRlczYkcHJvbWlzZSRhc2FwJCRpc05vZGUiLCJsaWIkZXM2JHByb21pc2UkYXNhcCQkaXNXb3JrZXIiLCJVaW50OENsYW1wZWRBcnJheSIsImltcG9ydFNjcmlwdHMiLCJNYXRoIiwicmFuZG9tIiwibGliJGVzNiRwcm9taXNlJHByb21pc2UkYWxsJCRkZWZhdWx0IiwibGliJGVzNiRwcm9taXNlJHByb21pc2UkcmFjZSQkZGVmYXVsdCIsImxpYiRlczYkcHJvbWlzZSRwcm9taXNlJHJlamVjdCQkZGVmYXVsdCIsImFsbCIsInJhY2UiLCJfc2V0U2NoZWR1bGVyIiwiX3NldEFzYXAiLCJfYXNhcCIsImNhdGNoIiwiX2VhY2hFbnRyeSIsImVudHJ5IiwiX3NldHRsZWRBdCIsIl93aWxsU2V0dGxlQXQiLCJlbnVtZXJhdG9yIiwibGliJGVzNiRwcm9taXNlJHBvbHlmaWxsJCRkZWZhdWx0IiwibGliJGVzNiRwcm9taXNlJHVtZCQkRVM2UHJvbWlzZSIsInBvbHlmaWxsIiwiY2xlYW5VcE5leHRUaWNrIiwiZHJhaW5pbmciLCJjdXJyZW50UXVldWUiLCJxdWV1ZSIsInF1ZXVlSW5kZXgiLCJkcmFpblF1ZXVlIiwidGltZW91dCIsImNhY2hlZFNldFRpbWVvdXQiLCJsZW4iLCJydW4iLCJjYWNoZWRDbGVhclRpbWVvdXQiLCJJdGVtIiwiZnVuIiwiYXJyYXkiLCJub29wIiwiY2xlYXJUaW1lb3V0IiwiYXJncyIsInRpdGxlIiwiYnJvd3NlciIsImVudiIsImFyZ3YiLCJ2ZXJzaW9uIiwidmVyc2lvbnMiLCJhZGRMaXN0ZW5lciIsIm9uY2UiLCJyZW1vdmVMaXN0ZW5lciIsInJlbW92ZUFsbExpc3RlbmVycyIsImVtaXQiLCJiaW5kaW5nIiwiY3dkIiwiY2hkaXIiLCJkaXIiLCJ1bWFzayIsIndlYnBhY2tQb2x5ZmlsbCIsImRlcHJlY2F0ZSIsInBhdGhzIiwiY2hpbGRyZW4iXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdDSW5CLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBRSxPQUdBLElBQUFDLEdBQUFGLEVBQUFELElBQ0FFLFdBQ0FFLEdBQUFKLEVBQ0FLLFFBQUEsRUFVQSxPQU5BUCxHQUFBRSxHQUFBTSxLQUFBSCxFQUFBRCxRQUFBQyxJQUFBRCxRQUFBSCxHQUdBSSxFQUFBRSxRQUFBLEVBR0FGLEVBQUFELFFBdkJBLEdBQUFELEtBcUNBLE9BVEFGLEdBQUFRLEVBQUFULEVBR0FDLEVBQUFTLEVBQUFQLEVBR0FGLEVBQUFVLEVBQUEsR0FHQVYsRUFBQSxLRE1NLFNBQVNJLEVBQVFELEVBQVNILEdBRS9CLFlBUUEsU0FBU1csR0FBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0VuRGpILFFBQVNDLEdBQVlDLEVBQVdDLEdBQy9CLE1BQU9ELEdBQVksSUFBTUMsRUY0Q3pCZCxFQUFRZSxZQUFhLENBRXJCLElBQUlDLEdBQTRCLGtCQUFYQyxTQUFvRCxnQkFBcEJBLFFBQU9DLFNBQXdCLFNBQVVDLEdBQU8sYUFBY0EsSUFBUyxTQUFVQSxHQUFPLE1BQU9BLElBQXlCLGtCQUFYRixTQUF5QkUsRUFBSUMsY0FBZ0JILE9BQVMsZUFBa0JFLElFbEQzT0UsRUFBQXhCLEVBQUEsR0FPTXlCLEVGc0RjLFdFckRuQixRQUFBQSxLQUFjZCxFQUFBZSxLQUFBRCxHQUNiRSxPQUFPRixhQUFlQyxLQUN0QkEsS0FBS0Us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S0FBQTZQLElBQUF6SyxNQUFBLEtBQUFwRixLQUFBOFAsUUFFQXJLLEVBQUF5SyxNQUFBLFVBQ0F6SyxFQUFBMEssU0FBQSxFQUNBMUssRUFBQTJLLE9BQ0EzSyxFQUFBNEssUUFDQTVLLEVBQUE2SyxRQUFBLEdBQ0E3SyxFQUFBOEssWUFJQTlLLEVBQUE5RCxHQUFBb08sRUFDQXRLLEVBQUErSyxZQUFBVCxFQUNBdEssRUFBQWdMLEtBQUFWLEVBQ0F0SyxFQUFBMUQsSUFBQWdPLEVBQ0F0SyxFQUFBaUwsZUFBQVgsRUFDQXRLLEVBQUFrTCxtQkFBQVosRUFDQXRLLEVBQUFtTCxLQUFBYixFQUVBdEssRUFBQW9MLFFBQUEsU0FBQXBOLEdBQ0EsU0FBQVQsT0FBQSxxQ0FHQXlDLEVBQUFxTCxJQUFBLFdBQTJCLFdBQzNCckwsRUFBQXNMLE1BQUEsU0FBQUMsR0FDQSxTQUFBaE8sT0FBQSxtQ0FFQXlDLEVBQUF3TCxNQUFBLFdBQTRCLFdKeXlDdEIsU0FBU3ZTLEVBQVFELEdLLzVDdkJDLEVBQUFELFFBQUEsV0FBNkIsU0FBQXVFLE9BQUEsb0NMczZDdkIsU0FBU3RFLEVBQVFELEdNdDZDdkJDLEVBQUFELFFBQUEsU0FBQUMsR0FRQSxNQVBBQSxHQUFBd1Msa0JBQ0F4UyxFQUFBeVMsVUFBQSxhQUNBelMsRUFBQTBTLFNBRUExUyxFQUFBMlMsWUFDQTNTLEVBQUF3UyxnQkFBQSxHQUVBeFMsSU44NkNNLFNBQVNBLEVBQVFEIiwiZmlsZSI6Imtpd29vbS1oZWxwZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0XG5cdHZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXHRcblx0dmFyIF9lczZQcm9taXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHQvLyDsnbTrsqTtirjsnZgg7YKk66W8IOyWu+ydjFxuXHRmdW5jdGlvbiBnZXRFdmVudEtleShldmVudE5hbWUsIHRyQ29kZSkge1xuXHRcdHJldHVybiBldmVudE5hbWUgKyBcIl9cIiArIHRyQ29kZTtcblx0fVxuXHRcblx0dmFyIEtpd29vbUhlbHBlciA9IGZ1bmN0aW9uICgpIHtcblx0XHRmdW5jdGlvbiBLaXdvb21IZWxwZXIoKSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgS2l3b29tSGVscGVyKTtcblx0XG5cdFx0XHR3aW5kb3cuS2l3b29tSGVscGVyID0gdGhpcztcblx0XHRcdHRoaXMuX2V2ZW50SGFuZGxlciA9IHt9O1xuXHRcdFx0dGhpcy5fc2NyZWVuTm8gPSAwO1xuXHRcdFx0dGhpcy5fcmVxdWVzdFNjcmVlbnMgPSBbXTtcblx0XHRcdHRoaXMuX3JlZ2lzdGVyU2NyZWVucyA9IFtdO1xuXHRcdFx0dGhpcy5fYXR0YWNoKCk7XG5cdFx0fVxuXHRcblx0XHRLaXdvb21IZWxwZXIucHJvdG90eXBlLl9hdHRhY2ggPSBmdW5jdGlvbiBfYXR0YWNoKCkge1xuXHRcdFx0dmFyIF90aGlzID0gdGhpcztcblx0XG5cdFx0XHQvLyDsgqzsmqnsnpAg6rWs67aEIOyalOyyrSDrqoXsnYAgdHJDb2Rl7JmAIOuPmeydvO2VmOuLpC5cblx0XHRcdEtpd29vbUhlbHBlci5FVkVOVFMuZm9yRWFjaChmdW5jdGlvbiAodikge1xuXHRcdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKHYgKyBcIi5raXdvb21cIiwgX3RoaXMpO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0XHQvLyDtmZTrqbQg67KI7Zi466W8IOyWu+ydjFxuXHRcblx0XG5cdFx0S2l3b29tSGVscGVyLnByb3RvdHlwZS5fZ2V0U2NyZWVuTm8gPSBmdW5jdGlvbiBfZ2V0U2NyZWVuTm8oKSB7XG5cdFx0XHRyZXR1cm4gXCJTUkNcIiArIHRoaXMuX3NjcmVlbk5vKys7XG5cdFx0fTtcblx0XG5cdFx0S2l3b29tSGVscGVyLnByb3RvdHlwZS5oYW5kbGVFdmVudCA9IGZ1bmN0aW9uIGhhbmRsZUV2ZW50KGUpIHtcblx0XHRcdC8vIGNvbnNvbGUubG9nKGUudHlwZSwgZSk7XG5cdFx0XHR2YXIgZGF0YSA9IGUuZGV0YWlsO1xuXHRcdFx0dmFyIHR5cGUgPSBlLnR5cGUuc3Vic3RyaW5nKDAsIGUudHlwZS5pbmRleE9mKFwiLmtpd29vbVwiKSk7XG5cdFx0XHRpZiAodHlwZSA9PT0gXCJyZWNlaXZlVHJEYXRhXCIpIHtcblx0XHRcdFx0ZGF0YS5zaXplID0ga2l3b29tID8ga2l3b29tLmdldFJlcGVhdENudChkYXRhLnRyQ29kZSwgZGF0YS5yUU5hbWUpIDogMDtcblx0XHRcdH1cblx0XG5cdFx0XHR2YXIgaGFuZGxlciA9IHRoaXMuX2V2ZW50SGFuZGxlcltnZXRFdmVudEtleSh0eXBlLCBkYXRhLnRyQ29kZSldO1xuXHRcdFx0Ly8gY29uc29sZS5sb2codHlwZSxkYXRhLGhhbmRsZXIpO1xuXHRcdFx0aGFuZGxlciAmJiBoYW5kbGVyLmNhbGwodGhpcywgZGF0YSk7XG5cdFx0fTtcblx0XHQvKipcclxuXHQgICogQXR0YWNoIGFuIGV2ZW50IGhhbmRsZXIgZnVuY3Rpb24uXHJcblx0ICAqIEBtZXRob2QgS2l3b29tSGVscGVyI29uXHJcblx0ICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWVcclxuXHQgICogQHBhcmFtIHtTdHJpbmd9IHRyQ29kZVxyXG5cdCAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyXHJcblx0ICAqIEByZXR1cm4ge3RoaXN9IGluc3RhbmNlIG9mIGl0c2VsZlxyXG5cdCAgKiBAZXhhbXBsZVxyXG5cdCBcdC8vIOy9lOuTnOuzhCDtlbjrk6Trn6wg65Ox66GdIChzdHJpbmcpXHJcblx0IFx0S2l3b29tSGVscGVyLm9uKFwicmVjZWl2ZVRyRGF0YVwiLCBcIm9wdDEwMDAxXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuXHQgXHRcdC8vIC4uLlxyXG5cdCBcdH0pO1xyXG5cdCBcdC8vIOy9lOuTnOuzhCDtlbjrk6Trn6wg65Ox66GdIChoYXNobWFwKVxyXG5cdCBcdEtpd29vbUhlbHBlci5vbihcInJlY2VpdmVUckRhdGFcIiwge1xyXG5cdCBcdFx0XCJvcHQxMDAwMVwiIDogZnVuY3Rpb24oZGF0YSkgeyAvLyAuLi4gfSxcclxuXHQgXHRcdFwib3B0MTAwMDJcIiA6IGZ1bmN0aW9uKGRhdGEpIHsgLy8gLi4uIH1cclxuXHQgXHR9KTtcclxuXHQgICovXG5cdFxuXHRcblx0XHRLaXdvb21IZWxwZXIucHJvdG90eXBlLm9uID0gZnVuY3Rpb24gb24oZXZlbnROYW1lLCB0ckNvZGUsIGhhbmRsZXIpIHtcblx0XHRcdHZhciBfdGhpczIgPSB0aGlzO1xuXHRcblx0XHRcdGlmIChLaXdvb21IZWxwZXIuRVZFTlRTLmluZGV4T2YoZXZlbnROYW1lKSA9PT0gLTEpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcblx0XHRcdC8vIHRyQ29kZeqwgCBvYmplY3Qg7J24IOqyveyasC5cblx0XHRcdGlmICgodHlwZW9mIHRyQ29kZSA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKHRyQ29kZSkpID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBoYW5kbGVyID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdE9iamVjdC5rZXlzKHRyQ29kZSkuZm9yRWFjaChmdW5jdGlvbiAodikge1xuXHRcdFx0XHRcdF90aGlzMi5vbihldmVudE5hbWUsIHYsIHRyQ29kZVt2XSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0Ly8g64uo6rG07J24IOqyveyasC5cblx0XHRcdH0gZWxzZSBpZiAodHlwZW9mIHRyQ29kZSA9PT0gXCJzdHJpbmdcIiAmJiB0eXBlb2YgaGFuZGxlciA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRcdHRoaXMuX2V2ZW50SGFuZGxlcltnZXRFdmVudEtleShldmVudE5hbWUsIHRyQ29kZSldID0gaGFuZGxlcjtcblx0XHRcdH1cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH07XG5cdFx0LyoqXHJcblx0ICAqIERldGFjaCBhbiBldmVudCBoYW5kbGVyIGZ1bmN0aW9uLlxyXG5cdCAgKiBAbWV0aG9kIEtpd29vbUhlbHBlciNvZmZcclxuXHQgICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZVxyXG5cdCAgKiBAcGFyYW0ge1N0cmluZ30gdHJDb2RlXHJcblx0ICAqIEByZXR1cm4ge3RoaXN9IGluc3RhbmNlIG9mIGl0c2VsZlxyXG5cdCAgKiBAZXhhbXBsZVxyXG5cdCBcdEtpd29vbUhlbHBlci5vZmYoKTtcclxuXHQgXHRLaXdvb21IZWxwZXIub2ZmKFwicmVjZWl2ZVRyRGF0YS5raXdvb21cIik7XHJcblx0IFx0S2l3b29tSGVscGVyLm9mZihcInJlY2VpdmVUckRhdGEua2l3b29tXCIsIFwib3B0MTAwMDFcIik7XHJcblx0IFx0S2l3b29tSGVscGVyLm9mZihcInJlY2VpdmVUckRhdGEua2l3b29tXCIsIFtcIm9wdDEwMDAxXCIsIFwib3B0MTAwMDJcIl0gKTtcclxuXHQgICovXG5cdFxuXHRcblx0XHRLaXdvb21IZWxwZXIucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uIG9mZihldmVudE5hbWUsIHRyQ29kZSkge1xuXHRcdFx0dmFyIF90aGlzMyA9IHRoaXM7XG5cdFxuXHRcdFx0Ly8gQWxsIGV2ZW50IGRldGFjaC5cblx0XHRcdGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdHRoaXMuX2V2ZW50SGFuZGxlciA9IHt9O1xuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH1cblx0XHRcdGlmICh0eXBlb2YgdHJDb2RlID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdHRoaXMuX2V2ZW50SGFuZGxlcltldmVudE5hbWVdID0gdW5kZWZpbmVkO1xuXHRcdFx0fSBlbHNlIGlmICh0eXBlb2YgdHJDb2RlID09PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRcdHRoaXMuX2V2ZW50SGFuZGxlcltnZXRFdmVudEtleShldmVudE5hbWUsIHRyQ29kZSldID0gdW5kZWZpbmVkO1xuXHRcdFx0fSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHRyQ29kZSkpIHtcblx0XHRcdFx0T2JqZWN0LmtleXModGhpcy5fZXZlbnRIYW5kbGVyKS5maWx0ZXIoZnVuY3Rpb24gKHYpIHtcblx0XHRcdFx0XHRyZXR1cm4gdi5pbmRleE9mKGV2ZW50TmFtZSArIFwiX1wiKSA9PT0gMDtcblx0XHRcdFx0fSkuZm9yRWFjaChmdW5jdGlvbiAodikge1xuXHRcdFx0XHRcdF90aGlzMy5fZXZlbnRIYW5kbGVyW2dldEV2ZW50S2V5KGV2ZW50TmFtZSwgdildID0gdW5kZWZpbmVkO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH07XG5cdFx0LyoqXHJcblx0ICAqIGlzTG9naW5cclxuXHQgICogQG1ldGhvZCBLaXdvb21IZWxwZXIjaXNMb2dpblxyXG5cdCAgKiBAcmV0dXJuIHtOdW1iZXJ9IGxvZ2luIHN0YXR1c1xyXG5cdCAgKiBAZXhhbXBsZVxyXG5cdCBcdEtpd29vbUhlbHBlci5pc0xvZ2luKCk7XHJcblx0ICAqL1xuXHRcblx0XG5cdFx0S2l3b29tSGVscGVyLnByb3RvdHlwZS5pc0xvZ2luID0gZnVuY3Rpb24gaXNMb2dpbigpIHtcblx0XHRcdHJldHVybiBraXdvb20uZ2V0Q29ubmVjdFN0YXRlKCk7XG5cdFx0fTtcblx0XHQvKipcclxuXHQgICogbG9naW5cclxuXHQgICogQG1ldGhvZCBLaXdvb21IZWxwZXIjbG9naW5cclxuXHQgICogQHJldHVybiB7UHJvbWlzZX0gUHJvbWlzZSBpbnN0YW5jZVxyXG5cdCAgKiBAZXhhbXBsZVxyXG5cdCBcdEtpd29vbUhlbHBlci5sb2dpbigpLnRoZW4oZnVuY3Rpb24oKSB7XHJcblx0IFx0XHQvLyAuLi5cclxuXHQgXHR9KTtcclxuXHQgICovXG5cdFxuXHRcblx0XHRLaXdvb21IZWxwZXIucHJvdG90eXBlLmxvZ2luID0gZnVuY3Rpb24gbG9naW4oKSB7XG5cdFx0XHRyZXR1cm4gbmV3IF9lczZQcm9taXNlLlByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdFx0XHR2YXIgc3RhdHVzID0ga2l3b29tLmdldENvbm5lY3RTdGF0ZSgpO1xuXHRcdFx0XHRpZiAoc3RhdHVzID09IDApIHtcblx0XHRcdFx0XHR2YXIgcnQgPSBraXdvb20uY29tbUNvbm5lY3QoKTtcblx0XHRcdFx0XHRydCA8IDAgJiYgcmVqZWN0KEVycm9yKHJ0KSk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoc3RhdHVzID09IDEpIHtcblx0XHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dmFyIGhhbmRlciA9IGZ1bmN0aW9uIGhhbmRlcihlKSB7XG5cdFx0XHRcdFx0dmFyIGVycmNvZGUgPSBlLmRldGFpbDtcblx0XHRcdFx0XHRlcnJjb2RlID09IDAgPyByZXNvbHZlKCkgOiByZWplY3QoRXJyb3IoZXJyY29kZSkpO1xuXHRcdFx0XHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJldmVudENvbm5lY3Qua2l3b29tXCIsIGhhbmRlcik7XG5cdFx0XHRcdH07XG5cdFx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJldmVudENvbm5lY3Qua2l3b29tXCIsIGhhbmRlcik7XG5cdFx0XHR9KTtcblx0XHR9O1xuXHRcdC8qKlxyXG5cdCAgKiBnZXQgbG9naW4gaW5mb3JtYXRpb25cclxuXHQgICogQG1ldGhvZCBLaXdvb21IZWxwZXIjZ2V0TG9naW5JbmZvXHJcblx0ICAqIEByZXR1cm4ge09iamVjdH0gdXNlciBpbmZvcm1hdGlvblxyXG5cdCAgKiBAZXhhbXBsZVxyXG5cdCBcdEtpd29vbUhlbHBlci5nZXRMb2dpbkluZm8oKTtcclxuXHQgICovXG5cdFxuXHRcblx0XHRLaXdvb21IZWxwZXIucHJvdG90eXBlLmdldExvZ2luSW5mbyA9IGZ1bmN0aW9uIGdldExvZ2luSW5mbygpIHtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGFjY291bnQ6IGtpd29vbS5nZXRMb2dpbkluZm8oXCJBQ0NOT1wiKS5yZXBsYWNlKC87JC8sIFwiXCIpLnNwbGl0KFwiO1wiKSxcblx0XHRcdFx0dXNlcjoge1xuXHRcdFx0XHRcdGlkOiBraXdvb20uZ2V0TG9naW5JbmZvKFwiVVNFUl9JRFwiKSxcblx0XHRcdFx0XHRuYW1lOiBraXdvb20uZ2V0TG9naW5JbmZvKFwiVVNFUl9OQU1FXCIpXG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0fTtcblx0XHQvKipcclxuXHQgICogcmVxdWVzdFxyXG5cdCAgKiBAbWV0aG9kIEtpd29vbUhlbHBlciNyZXF1ZXN0XHJcblx0ICAqIEBwYXJhbSB7U3RyaW5nfSB0ckNvZGVcclxuXHQgICogQHBhcmFtIHtPYmplY3R9IGlucHV0XHJcblx0ICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNDb250aW51ZT1mYWxzZVxyXG5cdCAgKiBAcmV0dXJuIHtTdHJpbmd9IHNjcmVlbk5vXHJcblx0ICAqIEBleGFtcGxlXHJcblx0IFx0S2l3b29tSGVscGVyLnJlcXVlc3QoXCJvcHQxMDAwMVwiLCB7XHJcblx0IFx0XHRcIuyiheuqqey9lOuTnFwiIDogXCIwMzU0MjBcIlxyXG5cdCBcdH0pO1xyXG5cdCAgKi9cblx0XG5cdFxuXHRcdEtpd29vbUhlbHBlci5wcm90b3R5cGUucmVxdWVzdCA9IGZ1bmN0aW9uIHJlcXVlc3QodHJDb2RlLCBpbnB1dCkge1xuXHRcdFx0dmFyIGlzQ29udGludWUgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IGFyZ3VtZW50c1syXTtcblx0XG5cdFx0XHQvL0B0b2RvIHNjcmVlbk5vIDIwMOqwnOqwgCDrhJjsnLzrqbQg7JWI65Cc64ukLlxuXHRcdFx0Ly/si6Tsi5zqsIQg7KGw6rG06rKA7IOJ7J2AIOy1nOuMgCAxMOqwnFxuXHRcdFx0T2JqZWN0LmtleXMoaW5wdXQpLmZvckVhY2goZnVuY3Rpb24gKHYpIHtcblx0XHRcdFx0a2l3b29tLnNldElucHV0VmFsdWUodiwgaW5wdXRbdl0pO1xuXHRcdFx0fSk7XG5cdFx0XHQvLyDtmZTrqbQg67KI7Zi464qUIOyekOuPmeycvOuhnFxuXHRcdFx0dmFyIHNjcmVlbk5vID0gdGhpcy5fZ2V0U2NyZWVuTm8oKTtcblx0XHRcdHZhciByZXN1bHQgPSBraXdvb20uY29tbVJxRGF0YSh0ckNvZGUsIHRyQ29kZSwgaXNDb250aW51ZSA/IDIgOiAwLCBzY3JlZW5Obyk7XG5cdFx0XHRpZiAocmVzdWx0ID09PSAwKSB7XG5cdFx0XHRcdC8vIO2ZlOuptCDrsojtmLjrpbwg7KCA7J6lXG5cdFx0XHRcdHRoaXMuX3JlcXVlc3RTY3JlZW5zLnB1c2goc2NyZWVuTm8pO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHNjcmVlbk5vO1xuXHRcdH07XG5cdFxuXHRcdEtpd29vbUhlbHBlci5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbiByZWdpc3RlcihzdG9ja2NvZGVzLCBmaWRzKSB7XG5cdFx0XHR2YXIgaXNOZXcgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyB0cnVlIDogYXJndW1lbnRzWzJdO1xuXHRcblx0XHRcdGlmICghQXJyYXkuaXNBcnJheShzdG9ja2NvZGVzKSkge1xuXHRcdFx0XHRzdG9ja2NvZGVzID0gW3N0b2NrY29kZXNdO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCFBcnJheS5pc0FycmF5KGZpZHMpKSB7XG5cdFx0XHRcdGZpZHMgPSBbZmlkc107XG5cdFx0XHR9XG5cdFx0XHR2YXIgc2NyZWVuTm8gPSB0aGlzLl9nZXRTY3JlZW5ObygpO1xuXHRcdFx0dmFyIHJlc3VsdCA9IGtpd29vbS5zZXRSZWFsUmVnKHNjcmVlbk5vLCBzdG9ja2NvZGVzLmpvaW4oXCI7XCIpLCBmaWRzLmpvaW4oXCI7XCIpLCBpc05ldyA/IDAgOiAxKTtcblx0XG5cdFx0XHRpZiAocmVzdWx0ID09PSAwKSB7XG5cdFx0XHRcdC8vIO2ZlOuptCDrsojtmLjrpbwg7KCA7J6lXG5cdFx0XHRcdHRoaXMuX3JlZ2lzdGVyU2NyZWVucy5wdXNoKHNjcmVlbk5vKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0fTtcblx0XHQvKipcclxuXHQgICogZGlzY29ubmVjdFxyXG5cdCAgKiBAbWV0aG9kIEtpd29vbUhlbHBlciNkaXNjb25uZWN0XHJcblx0ICAqIEBwYXJhbSB7U3RyaW5nfSBzY3JlZW5Ob1xyXG5cdCAgKiBAcGFyYW0ge1N0cmluZ30gW3N0b2NrY29kZT1cIkFMTFwiXVxyXG5cdCAgKiBAZXhhbXBsZVxyXG5cdCBcdEtpd29vbUhlbHBlci5kaXNjb25uZWN0KFwiU1JDMVwiKTtcclxuXHQgXHRLaXdvb21IZWxwZXIuZGlzY29ubmVjdChcIlNSQzJcIiwgXCJcIjAzNTQyMFwiKTtcclxuXHQgICovXG5cdFxuXHRcblx0XHRLaXdvb21IZWxwZXIucHJvdG90eXBlLmRpc2Nvbm5lY3QgPSBmdW5jdGlvbiBkaXNjb25uZWN0KHNjcmVlbk5vKSB7XG5cdFx0XHR2YXIgc3RvY2tjb2RlID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gXCJBTExcIiA6IGFyZ3VtZW50c1sxXTtcblx0XG5cdFx0XHRpZiAoc2NyZWVuTm8pIHtcblx0XHRcdFx0aWYgKHRoaXMuX3JlcXVlc3RTY3JlZW5zLmluZGV4T2Yoc2NyZWVuTm8pICE9PSAtMSkge1xuXHRcdFx0XHRcdGtpd3dvbS5EaXNjb25uZWN0UmVhbERhdGEoc2NyZWVuTm8pO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHRoaXMuX3JlZ2lzdGVyU2NyZWVucy5pbmRleE9mKHNjcmVlbk5vKSAhPT0gLTEpIHtcblx0XHRcdFx0XHRraXd3b20uU2V0UmVhbFJlbW92ZShzY3JlZW5Obywgc3RvY2tjb2RlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5fcmVxdWVzdFNjcmVlbnMuZm9yRWFjaChmdW5jdGlvbiAodikge1xuXHRcdFx0XHRcdGtpd3dvbS5EaXNjb25uZWN0UmVhbERhdGEodik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHR0aGlzLl9yZXF1ZXN0U2NyZWVucy5sZW5ndGggPSAwO1xuXHRcdFx0XHRraXd3b20uU2V0UmVhbFJlbW92ZShcIkFMTFwiLCBcIkFMTFwiKTtcblx0XHRcdFx0dGhpcy5fcmVnaXN0ZXJTY3JlZW5zLmxlbmd0aCA9IDA7XG5cdFx0XHR9XG5cdFx0fTtcblx0XG5cdFx0S2l3b29tSGVscGVyLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiBnZXQoKSB7XG5cdFx0XHRzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcblx0XHRcdFx0Y2FzZSAxOlxuXHRcdFx0XHRcdC8vIOuMgOyaqeufiSDrjbDsnbTthLAgKHRyQ29kZeunjCDsnoXroKUpXG5cdFx0XHRcdFx0cmV0dXJuIEpTT04ucGFyc2Uoa2l3b29tLmdldENvbW1EYXRhRXgoYXJndW1lbnRzWzBdLCBhcmd1bWVudHNbMF0pKTtcblx0XHRcdFx0Y2FzZSAyOlxuXHRcdFx0XHRcdC8vIOyytOqysCDrjbDsnbTthLBcblx0XHRcdFx0XHRyZXR1cm4ga2l3b29tLmNvbW1HZXREYXRhKGFyZ3VtZW50c1swXSwgXCItMVwiLCBcIlwiLCBhcmd1bWVudHNbMV0sIFwiXCIpO1xuXHRcdFx0XHRjYXNlIDM6XG5cdFx0XHRcdFx0aWYgKCFpc05hTihhcmd1bWVudHNbMV0pICYmIGlzTmFOKGFyZ3VtZW50c1syXSkpIHtcblx0XHRcdFx0XHRcdHZhciBfa2l3b29tO1xuXHRcblx0XHRcdFx0XHRcdC8vIHRyYW5zIOuNsOydtO2EsFxuXHRcdFx0XHRcdFx0Ly8gZ2V0KOKAnE9QVDAwMDAx4oCdLCAwLCDigJztmITsnqzqsIDigJ0pO1xuXHRcdFx0XHRcdFx0cmV0dXJuIChfa2l3b29tID0ga2l3b29tKS5jb21tR2V0RGF0YS5hcHBseShfa2l3b29tLCBbYXJndW1lbnRzWzBdLCBcIlwiXS5jb25jYXQoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKSkpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR2YXIgX2tpd29vbTI7XG5cdFxuXHRcdFx0XHRcdFx0Ly8gcmVhbCDrjbDsnbTthLBcblx0XHRcdFx0XHRcdC8vIOyiheuqqey9lOuTnCwgcmVhbFR5cGUsIGZpZFxuXHRcdFx0XHRcdFx0Ly8gZ2V0KFwiMDAwNjAwXCIsICdBJywgMTApO1xuXHRcdFx0XHRcdFx0cmV0dXJuIChfa2l3b29tMiA9IGtpd29vbSkuY29tbUdldERhdGEuYXBwbHkoX2tpd29vbTIsIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykuY29uY2F0KFswLCBcIlwiXSkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9O1xuXHRcblx0XHRyZXR1cm4gS2l3b29tSGVscGVyO1xuXHR9KCk7XG5cdFxuXHRLaXdvb21IZWxwZXIuRVZFTlRTID0gW1wicmVjZWl2ZU1zZ1wiLCBcInJlY2VpdmVUckRhdGFcIiwgXCJyZWNlaXZlUmVhbERhdGFcIiwgXCJyZWNlaXZlQ2hlamFuRGF0YVwiLCBcInJlY2VpdmVDb25kaXRpb25WZXJcIiwgXCJyZWNlaXZlVHJDb25kaXRpb25cIiwgXCJyZWNlaXZlUmVhbENvbmRpdGlvblwiXTtcblx0XG5cdC8vIHNpbmdsZXRvblxuXHRleHBvcnRzLmRlZmF1bHQgPSBuZXcgS2l3b29tSGVscGVyKCk7XG5cbi8qKiovIH0sXG4vKiAxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgcmVxdWlyZTt2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKHByb2Nlc3MsIGdsb2JhbCwgbW9kdWxlKSB7LyohXG5cdCAqIEBvdmVydmlldyBlczYtcHJvbWlzZSAtIGEgdGlueSBpbXBsZW1lbnRhdGlvbiBvZiBQcm9taXNlcy9BKy5cblx0ICogQGNvcHlyaWdodCBDb3B5cmlnaHQgKGMpIDIwMTQgWWVodWRhIEthdHosIFRvbSBEYWxlLCBTdGVmYW4gUGVubmVyIGFuZCBjb250cmlidXRvcnMgKENvbnZlcnNpb24gdG8gRVM2IEFQSSBieSBKYWtlIEFyY2hpYmFsZClcblx0ICogQGxpY2Vuc2UgICBMaWNlbnNlZCB1bmRlciBNSVQgbGljZW5zZVxuXHQgKiAgICAgICAgICAgIFNlZSBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vamFrZWFyY2hpYmFsZC9lczYtcHJvbWlzZS9tYXN0ZXIvTElDRU5TRVxuXHQgKiBAdmVyc2lvbiAgIDMuMi4xXG5cdCAqL1xuXHRcblx0KGZ1bmN0aW9uKCkge1xuXHQgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkdXRpbHMkJG9iamVjdE9yRnVuY3Rpb24oeCkge1xuXHQgICAgICByZXR1cm4gdHlwZW9mIHggPT09ICdmdW5jdGlvbicgfHwgKHR5cGVvZiB4ID09PSAnb2JqZWN0JyAmJiB4ICE9PSBudWxsKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkdXRpbHMkJGlzRnVuY3Rpb24oeCkge1xuXHQgICAgICByZXR1cm4gdHlwZW9mIHggPT09ICdmdW5jdGlvbic7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJHV0aWxzJCRpc01heWJlVGhlbmFibGUoeCkge1xuXHQgICAgICByZXR1cm4gdHlwZW9mIHggPT09ICdvYmplY3QnICYmIHggIT09IG51bGw7XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIGxpYiRlczYkcHJvbWlzZSR1dGlscyQkX2lzQXJyYXk7XG5cdCAgICBpZiAoIUFycmF5LmlzQXJyYXkpIHtcblx0ICAgICAgbGliJGVzNiRwcm9taXNlJHV0aWxzJCRfaXNBcnJheSA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh4KSA9PT0gJ1tvYmplY3QgQXJyYXldJztcblx0ICAgICAgfTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGxpYiRlczYkcHJvbWlzZSR1dGlscyQkX2lzQXJyYXkgPSBBcnJheS5pc0FycmF5O1xuXHQgICAgfVxuXHRcblx0ICAgIHZhciBsaWIkZXM2JHByb21pc2UkdXRpbHMkJGlzQXJyYXkgPSBsaWIkZXM2JHByb21pc2UkdXRpbHMkJF9pc0FycmF5O1xuXHQgICAgdmFyIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRsZW4gPSAwO1xuXHQgICAgdmFyIGxpYiRlczYkcHJvbWlzZSRhc2FwJCR2ZXJ0eE5leHQ7XG5cdCAgICB2YXIgbGliJGVzNiRwcm9taXNlJGFzYXAkJGN1c3RvbVNjaGVkdWxlckZuO1xuXHRcblx0ICAgIHZhciBsaWIkZXM2JHByb21pc2UkYXNhcCQkYXNhcCA9IGZ1bmN0aW9uIGFzYXAoY2FsbGJhY2ssIGFyZykge1xuXHQgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkcXVldWVbbGliJGVzNiRwcm9taXNlJGFzYXAkJGxlbl0gPSBjYWxsYmFjaztcblx0ICAgICAgbGliJGVzNiRwcm9taXNlJGFzYXAkJHF1ZXVlW2xpYiRlczYkcHJvbWlzZSRhc2FwJCRsZW4gKyAxXSA9IGFyZztcblx0ICAgICAgbGliJGVzNiRwcm9taXNlJGFzYXAkJGxlbiArPSAyO1xuXHQgICAgICBpZiAobGliJGVzNiRwcm9taXNlJGFzYXAkJGxlbiA9PT0gMikge1xuXHQgICAgICAgIC8vIElmIGxlbiBpcyAyLCB0aGF0IG1lYW5zIHRoYXQgd2UgbmVlZCB0byBzY2hlZHVsZSBhbiBhc3luYyBmbHVzaC5cblx0ICAgICAgICAvLyBJZiBhZGRpdGlvbmFsIGNhbGxiYWNrcyBhcmUgcXVldWVkIGJlZm9yZSB0aGUgcXVldWUgaXMgZmx1c2hlZCwgdGhleVxuXHQgICAgICAgIC8vIHdpbGwgYmUgcHJvY2Vzc2VkIGJ5IHRoaXMgZmx1c2ggdGhhdCB3ZSBhcmUgc2NoZWR1bGluZy5cblx0ICAgICAgICBpZiAobGliJGVzNiRwcm9taXNlJGFzYXAkJGN1c3RvbVNjaGVkdWxlckZuKSB7XG5cdCAgICAgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkY3VzdG9tU2NoZWR1bGVyRm4obGliJGVzNiRwcm9taXNlJGFzYXAkJGZsdXNoKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgbGliJGVzNiRwcm9taXNlJGFzYXAkJHNjaGVkdWxlRmx1c2goKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkYXNhcCQkc2V0U2NoZWR1bGVyKHNjaGVkdWxlRm4pIHtcblx0ICAgICAgbGliJGVzNiRwcm9taXNlJGFzYXAkJGN1c3RvbVNjaGVkdWxlckZuID0gc2NoZWR1bGVGbjtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkYXNhcCQkc2V0QXNhcChhc2FwRm4pIHtcblx0ICAgICAgbGliJGVzNiRwcm9taXNlJGFzYXAkJGFzYXAgPSBhc2FwRm47XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRicm93c2VyV2luZG93ID0gKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSA/IHdpbmRvdyA6IHVuZGVmaW5lZDtcblx0ICAgIHZhciBsaWIkZXM2JHByb21pc2UkYXNhcCQkYnJvd3Nlckdsb2JhbCA9IGxpYiRlczYkcHJvbWlzZSRhc2FwJCRicm93c2VyV2luZG93IHx8IHt9O1xuXHQgICAgdmFyIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRCcm93c2VyTXV0YXRpb25PYnNlcnZlciA9IGxpYiRlczYkcHJvbWlzZSRhc2FwJCRicm93c2VyR2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgbGliJGVzNiRwcm9taXNlJGFzYXAkJGJyb3dzZXJHbG9iYWwuV2ViS2l0TXV0YXRpb25PYnNlcnZlcjtcblx0ICAgIHZhciBsaWIkZXM2JHByb21pc2UkYXNhcCQkaXNOb2RlID0gdHlwZW9mIHNlbGYgPT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHByb2Nlc3MpID09PSAnW29iamVjdCBwcm9jZXNzXSc7XG5cdFxuXHQgICAgLy8gdGVzdCBmb3Igd2ViIHdvcmtlciBidXQgbm90IGluIElFMTBcblx0ICAgIHZhciBsaWIkZXM2JHByb21pc2UkYXNhcCQkaXNXb3JrZXIgPSB0eXBlb2YgVWludDhDbGFtcGVkQXJyYXkgIT09ICd1bmRlZmluZWQnICYmXG5cdCAgICAgIHR5cGVvZiBpbXBvcnRTY3JpcHRzICE9PSAndW5kZWZpbmVkJyAmJlxuXHQgICAgICB0eXBlb2YgTWVzc2FnZUNoYW5uZWwgIT09ICd1bmRlZmluZWQnO1xuXHRcblx0ICAgIC8vIG5vZGVcblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRhc2FwJCR1c2VOZXh0VGljaygpIHtcblx0ICAgICAgLy8gbm9kZSB2ZXJzaW9uIDAuMTAueCBkaXNwbGF5cyBhIGRlcHJlY2F0aW9uIHdhcm5pbmcgd2hlbiBuZXh0VGljayBpcyB1c2VkIHJlY3Vyc2l2ZWx5XG5cdCAgICAgIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vY3Vqb2pzL3doZW4vaXNzdWVzLzQxMCBmb3IgZGV0YWlsc1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgcHJvY2Vzcy5uZXh0VGljayhsaWIkZXM2JHByb21pc2UkYXNhcCQkZmx1c2gpO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIC8vIHZlcnR4XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkYXNhcCQkdXNlVmVydHhUaW1lcigpIHtcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGxpYiRlczYkcHJvbWlzZSRhc2FwJCR2ZXJ0eE5leHQobGliJGVzNiRwcm9taXNlJGFzYXAkJGZsdXNoKTtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkYXNhcCQkdXNlTXV0YXRpb25PYnNlcnZlcigpIHtcblx0ICAgICAgdmFyIGl0ZXJhdGlvbnMgPSAwO1xuXHQgICAgICB2YXIgb2JzZXJ2ZXIgPSBuZXcgbGliJGVzNiRwcm9taXNlJGFzYXAkJEJyb3dzZXJNdXRhdGlvbk9ic2VydmVyKGxpYiRlczYkcHJvbWlzZSRhc2FwJCRmbHVzaCk7XG5cdCAgICAgIHZhciBub2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpO1xuXHQgICAgICBvYnNlcnZlci5vYnNlcnZlKG5vZGUsIHsgY2hhcmFjdGVyRGF0YTogdHJ1ZSB9KTtcblx0XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcblx0ICAgICAgICBub2RlLmRhdGEgPSAoaXRlcmF0aW9ucyA9ICsraXRlcmF0aW9ucyAlIDIpO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIC8vIHdlYiB3b3JrZXJcblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRhc2FwJCR1c2VNZXNzYWdlQ2hhbm5lbCgpIHtcblx0ICAgICAgdmFyIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKTtcblx0ICAgICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBsaWIkZXM2JHByb21pc2UkYXNhcCQkZmx1c2g7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgY2hhbm5lbC5wb3J0Mi5wb3N0TWVzc2FnZSgwKTtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkYXNhcCQkdXNlU2V0VGltZW91dCgpIHtcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHNldFRpbWVvdXQobGliJGVzNiRwcm9taXNlJGFzYXAkJGZsdXNoLCAxKTtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICB2YXIgbGliJGVzNiRwcm9taXNlJGFzYXAkJHF1ZXVlID0gbmV3IEFycmF5KDEwMDApO1xuXHQgICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJGFzYXAkJGZsdXNoKCkge1xuXHQgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpYiRlczYkcHJvbWlzZSRhc2FwJCRsZW47IGkrPTIpIHtcblx0ICAgICAgICB2YXIgY2FsbGJhY2sgPSBsaWIkZXM2JHByb21pc2UkYXNhcCQkcXVldWVbaV07XG5cdCAgICAgICAgdmFyIGFyZyA9IGxpYiRlczYkcHJvbWlzZSRhc2FwJCRxdWV1ZVtpKzFdO1xuXHRcblx0ICAgICAgICBjYWxsYmFjayhhcmcpO1xuXHRcblx0ICAgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkcXVldWVbaV0gPSB1bmRlZmluZWQ7XG5cdCAgICAgICAgbGliJGVzNiRwcm9taXNlJGFzYXAkJHF1ZXVlW2krMV0gPSB1bmRlZmluZWQ7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRsZW4gPSAwO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRhdHRlbXB0VmVydHgoKSB7XG5cdCAgICAgIHRyeSB7XG5cdCAgICAgICAgdmFyIHIgPSByZXF1aXJlO1xuXHQgICAgICAgIHZhciB2ZXJ0eCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XG5cdCAgICAgICAgbGliJGVzNiRwcm9taXNlJGFzYXAkJHZlcnR4TmV4dCA9IHZlcnR4LnJ1bk9uTG9vcCB8fCB2ZXJ0eC5ydW5PbkNvbnRleHQ7XG5cdCAgICAgICAgcmV0dXJuIGxpYiRlczYkcHJvbWlzZSRhc2FwJCR1c2VWZXJ0eFRpbWVyKCk7XG5cdCAgICAgIH0gY2F0Y2goZSkge1xuXHQgICAgICAgIHJldHVybiBsaWIkZXM2JHByb21pc2UkYXNhcCQkdXNlU2V0VGltZW91dCgpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRzY2hlZHVsZUZsdXNoO1xuXHQgICAgLy8gRGVjaWRlIHdoYXQgYXN5bmMgbWV0aG9kIHRvIHVzZSB0byB0cmlnZ2VyaW5nIHByb2Nlc3Npbmcgb2YgcXVldWVkIGNhbGxiYWNrczpcblx0ICAgIGlmIChsaWIkZXM2JHByb21pc2UkYXNhcCQkaXNOb2RlKSB7XG5cdCAgICAgIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRzY2hlZHVsZUZsdXNoID0gbGliJGVzNiRwcm9taXNlJGFzYXAkJHVzZU5leHRUaWNrKCk7XG5cdCAgICB9IGVsc2UgaWYgKGxpYiRlczYkcHJvbWlzZSRhc2FwJCRCcm93c2VyTXV0YXRpb25PYnNlcnZlcikge1xuXHQgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkc2NoZWR1bGVGbHVzaCA9IGxpYiRlczYkcHJvbWlzZSRhc2FwJCR1c2VNdXRhdGlvbk9ic2VydmVyKCk7XG5cdCAgICB9IGVsc2UgaWYgKGxpYiRlczYkcHJvbWlzZSRhc2FwJCRpc1dvcmtlcikge1xuXHQgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkc2NoZWR1bGVGbHVzaCA9IGxpYiRlczYkcHJvbWlzZSRhc2FwJCR1c2VNZXNzYWdlQ2hhbm5lbCgpO1xuXHQgICAgfSBlbHNlIGlmIChsaWIkZXM2JHByb21pc2UkYXNhcCQkYnJvd3NlcldpbmRvdyA9PT0gdW5kZWZpbmVkICYmIFwiZnVuY3Rpb25cIiA9PT0gJ2Z1bmN0aW9uJykge1xuXHQgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkc2NoZWR1bGVGbHVzaCA9IGxpYiRlczYkcHJvbWlzZSRhc2FwJCRhdHRlbXB0VmVydHgoKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRzY2hlZHVsZUZsdXNoID0gbGliJGVzNiRwcm9taXNlJGFzYXAkJHVzZVNldFRpbWVvdXQoKTtcblx0ICAgIH1cblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSR0aGVuJCR0aGVuKG9uRnVsZmlsbG1lbnQsIG9uUmVqZWN0aW9uKSB7XG5cdCAgICAgIHZhciBwYXJlbnQgPSB0aGlzO1xuXHRcblx0ICAgICAgdmFyIGNoaWxkID0gbmV3IHRoaXMuY29uc3RydWN0b3IobGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkbm9vcCk7XG5cdFxuXHQgICAgICBpZiAoY2hpbGRbbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkUFJPTUlTRV9JRF0gPT09IHVuZGVmaW5lZCkge1xuXHQgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJG1ha2VQcm9taXNlKGNoaWxkKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgdmFyIHN0YXRlID0gcGFyZW50Ll9zdGF0ZTtcblx0XG5cdCAgICAgIGlmIChzdGF0ZSkge1xuXHQgICAgICAgIHZhciBjYWxsYmFjayA9IGFyZ3VtZW50c1tzdGF0ZSAtIDFdO1xuXHQgICAgICAgIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRhc2FwKGZ1bmN0aW9uKCl7XG5cdCAgICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRpbnZva2VDYWxsYmFjayhzdGF0ZSwgY2hpbGQsIGNhbGxiYWNrLCBwYXJlbnQuX3Jlc3VsdCk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkc3Vic2NyaWJlKHBhcmVudCwgY2hpbGQsIG9uRnVsZmlsbG1lbnQsIG9uUmVqZWN0aW9uKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIGNoaWxkO1xuXHQgICAgfVxuXHQgICAgdmFyIGxpYiRlczYkcHJvbWlzZSR0aGVuJCRkZWZhdWx0ID0gbGliJGVzNiRwcm9taXNlJHRoZW4kJHRoZW47XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRyZXNvbHZlJCRyZXNvbHZlKG9iamVjdCkge1xuXHQgICAgICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuXHQgICAgICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuXHRcblx0ICAgICAgaWYgKG9iamVjdCAmJiB0eXBlb2Ygb2JqZWN0ID09PSAnb2JqZWN0JyAmJiBvYmplY3QuY29uc3RydWN0b3IgPT09IENvbnN0cnVjdG9yKSB7XG5cdCAgICAgICAgcmV0dXJuIG9iamVjdDtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgdmFyIHByb21pc2UgPSBuZXcgQ29uc3RydWN0b3IobGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkbm9vcCk7XG5cdCAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlc29sdmUocHJvbWlzZSwgb2JqZWN0KTtcblx0ICAgICAgcmV0dXJuIHByb21pc2U7XG5cdCAgICB9XG5cdCAgICB2YXIgbGliJGVzNiRwcm9taXNlJHByb21pc2UkcmVzb2x2ZSQkZGVmYXVsdCA9IGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJHJlc29sdmUkJHJlc29sdmU7XG5cdCAgICB2YXIgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkUFJPTUlTRV9JRCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygxNik7XG5cdFxuXHQgICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkbm9vcCgpIHt9XG5cdFxuXHQgICAgdmFyIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFBFTkRJTkcgICA9IHZvaWQgMDtcblx0ICAgIHZhciBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRGVUxGSUxMRUQgPSAxO1xuXHQgICAgdmFyIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFJFSkVDVEVEICA9IDI7XG5cdFxuXHQgICAgdmFyIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJEdFVF9USEVOX0VSUk9SID0gbmV3IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJEVycm9yT2JqZWN0KCk7XG5cdFxuXHQgICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkc2VsZkZ1bGZpbGxtZW50KCkge1xuXHQgICAgICByZXR1cm4gbmV3IFR5cGVFcnJvcihcIllvdSBjYW5ub3QgcmVzb2x2ZSBhIHByb21pc2Ugd2l0aCBpdHNlbGZcIik7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkY2Fubm90UmV0dXJuT3duKCkge1xuXHQgICAgICByZXR1cm4gbmV3IFR5cGVFcnJvcignQSBwcm9taXNlcyBjYWxsYmFjayBjYW5ub3QgcmV0dXJuIHRoYXQgc2FtZSBwcm9taXNlLicpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGdldFRoZW4ocHJvbWlzZSkge1xuXHQgICAgICB0cnkge1xuXHQgICAgICAgIHJldHVybiBwcm9taXNlLnRoZW47XG5cdCAgICAgIH0gY2F0Y2goZXJyb3IpIHtcblx0ICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRHRVRfVEhFTl9FUlJPUi5lcnJvciA9IGVycm9yO1xuXHQgICAgICAgIHJldHVybiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRHRVRfVEhFTl9FUlJPUjtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHRyeVRoZW4odGhlbiwgdmFsdWUsIGZ1bGZpbGxtZW50SGFuZGxlciwgcmVqZWN0aW9uSGFuZGxlcikge1xuXHQgICAgICB0cnkge1xuXHQgICAgICAgIHRoZW4uY2FsbCh2YWx1ZSwgZnVsZmlsbG1lbnRIYW5kbGVyLCByZWplY3Rpb25IYW5kbGVyKTtcblx0ICAgICAgfSBjYXRjaChlKSB7XG5cdCAgICAgICAgcmV0dXJuIGU7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRoYW5kbGVGb3JlaWduVGhlbmFibGUocHJvbWlzZSwgdGhlbmFibGUsIHRoZW4pIHtcblx0ICAgICAgIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRhc2FwKGZ1bmN0aW9uKHByb21pc2UpIHtcblx0ICAgICAgICB2YXIgc2VhbGVkID0gZmFsc2U7XG5cdCAgICAgICAgdmFyIGVycm9yID0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkdHJ5VGhlbih0aGVuLCB0aGVuYWJsZSwgZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgICAgIGlmIChzZWFsZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgICAgICBzZWFsZWQgPSB0cnVlO1xuXHQgICAgICAgICAgaWYgKHRoZW5hYmxlICE9PSB2YWx1ZSkge1xuXHQgICAgICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRyZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuXHQgICAgICAgICAgaWYgKHNlYWxlZCkgeyByZXR1cm47IH1cblx0ICAgICAgICAgIHNlYWxlZCA9IHRydWU7XG5cdFxuXHQgICAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG5cdCAgICAgICAgfSwgJ1NldHRsZTogJyArIChwcm9taXNlLl9sYWJlbCB8fCAnIHVua25vd24gcHJvbWlzZScpKTtcblx0XG5cdCAgICAgICAgaWYgKCFzZWFsZWQgJiYgZXJyb3IpIHtcblx0ICAgICAgICAgIHNlYWxlZCA9IHRydWU7XG5cdCAgICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRyZWplY3QocHJvbWlzZSwgZXJyb3IpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSwgcHJvbWlzZSk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkaGFuZGxlT3duVGhlbmFibGUocHJvbWlzZSwgdGhlbmFibGUpIHtcblx0ICAgICAgaWYgKHRoZW5hYmxlLl9zdGF0ZSA9PT0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkRlVMRklMTEVEKSB7XG5cdCAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkZnVsZmlsbChwcm9taXNlLCB0aGVuYWJsZS5fcmVzdWx0KTtcblx0ICAgICAgfSBlbHNlIGlmICh0aGVuYWJsZS5fc3RhdGUgPT09IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFJFSkVDVEVEKSB7XG5cdCAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcmVqZWN0KHByb21pc2UsIHRoZW5hYmxlLl9yZXN1bHQpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHN1YnNjcmliZSh0aGVuYWJsZSwgdW5kZWZpbmVkLCBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7XG5cdCAgICAgICAgfSwgZnVuY3Rpb24ocmVhc29uKSB7XG5cdCAgICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRyZWplY3QocHJvbWlzZSwgcmVhc29uKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGhhbmRsZU1heWJlVGhlbmFibGUocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSwgdGhlbikge1xuXHQgICAgICBpZiAobWF5YmVUaGVuYWJsZS5jb25zdHJ1Y3RvciA9PT0gcHJvbWlzZS5jb25zdHJ1Y3RvciAmJlxuXHQgICAgICAgICAgdGhlbiA9PT0gbGliJGVzNiRwcm9taXNlJHRoZW4kJGRlZmF1bHQgJiZcblx0ICAgICAgICAgIGNvbnN0cnVjdG9yLnJlc29sdmUgPT09IGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJHJlc29sdmUkJGRlZmF1bHQpIHtcblx0ICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRoYW5kbGVPd25UaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBpZiAodGhlbiA9PT0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkR0VUX1RIRU5fRVJST1IpIHtcblx0ICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlamVjdChwcm9taXNlLCBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRHRVRfVEhFTl9FUlJPUi5lcnJvcik7XG5cdCAgICAgICAgfSBlbHNlIGlmICh0aGVuID09PSB1bmRlZmluZWQpIHtcblx0ICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGZ1bGZpbGwocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSk7XG5cdCAgICAgICAgfSBlbHNlIGlmIChsaWIkZXM2JHByb21pc2UkdXRpbHMkJGlzRnVuY3Rpb24odGhlbikpIHtcblx0ICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGhhbmRsZUZvcmVpZ25UaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlLCB0aGVuKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkZnVsZmlsbChwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRyZXNvbHZlKHByb21pc2UsIHZhbHVlKSB7XG5cdCAgICAgIGlmIChwcm9taXNlID09PSB2YWx1ZSkge1xuXHQgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlamVjdChwcm9taXNlLCBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRzZWxmRnVsZmlsbG1lbnQoKSk7XG5cdCAgICAgIH0gZWxzZSBpZiAobGliJGVzNiRwcm9taXNlJHV0aWxzJCRvYmplY3RPckZ1bmN0aW9uKHZhbHVlKSkge1xuXHQgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGhhbmRsZU1heWJlVGhlbmFibGUocHJvbWlzZSwgdmFsdWUsIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGdldFRoZW4odmFsdWUpKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRmdWxmaWxsKHByb21pc2UsIHZhbHVlKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHB1Ymxpc2hSZWplY3Rpb24ocHJvbWlzZSkge1xuXHQgICAgICBpZiAocHJvbWlzZS5fb25lcnJvcikge1xuXHQgICAgICAgIHByb21pc2UuX29uZXJyb3IocHJvbWlzZS5fcmVzdWx0KTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcHVibGlzaChwcm9taXNlKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRmdWxmaWxsKHByb21pc2UsIHZhbHVlKSB7XG5cdCAgICAgIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkUEVORElORykgeyByZXR1cm47IH1cblx0XG5cdCAgICAgIHByb21pc2UuX3Jlc3VsdCA9IHZhbHVlO1xuXHQgICAgICBwcm9taXNlLl9zdGF0ZSA9IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJEZVTEZJTExFRDtcblx0XG5cdCAgICAgIGlmIChwcm9taXNlLl9zdWJzY3JpYmVycy5sZW5ndGggIT09IDApIHtcblx0ICAgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkYXNhcChsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRwdWJsaXNoLCBwcm9taXNlKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlamVjdChwcm9taXNlLCByZWFzb24pIHtcblx0ICAgICAgaWYgKHByb21pc2UuX3N0YXRlICE9PSBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRQRU5ESU5HKSB7IHJldHVybjsgfVxuXHQgICAgICBwcm9taXNlLl9zdGF0ZSA9IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFJFSkVDVEVEO1xuXHQgICAgICBwcm9taXNlLl9yZXN1bHQgPSByZWFzb247XG5cdFxuXHQgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkYXNhcChsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRwdWJsaXNoUmVqZWN0aW9uLCBwcm9taXNlKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRzdWJzY3JpYmUocGFyZW50LCBjaGlsZCwgb25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pIHtcblx0ICAgICAgdmFyIHN1YnNjcmliZXJzID0gcGFyZW50Ll9zdWJzY3JpYmVycztcblx0ICAgICAgdmFyIGxlbmd0aCA9IHN1YnNjcmliZXJzLmxlbmd0aDtcblx0XG5cdCAgICAgIHBhcmVudC5fb25lcnJvciA9IG51bGw7XG5cdFxuXHQgICAgICBzdWJzY3JpYmVyc1tsZW5ndGhdID0gY2hpbGQ7XG5cdCAgICAgIHN1YnNjcmliZXJzW2xlbmd0aCArIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJEZVTEZJTExFRF0gPSBvbkZ1bGZpbGxtZW50O1xuXHQgICAgICBzdWJzY3JpYmVyc1tsZW5ndGggKyBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRSRUpFQ1RFRF0gID0gb25SZWplY3Rpb247XG5cdFxuXHQgICAgICBpZiAobGVuZ3RoID09PSAwICYmIHBhcmVudC5fc3RhdGUpIHtcblx0ICAgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkYXNhcChsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRwdWJsaXNoLCBwYXJlbnQpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcHVibGlzaChwcm9taXNlKSB7XG5cdCAgICAgIHZhciBzdWJzY3JpYmVycyA9IHByb21pc2UuX3N1YnNjcmliZXJzO1xuXHQgICAgICB2YXIgc2V0dGxlZCA9IHByb21pc2UuX3N0YXRlO1xuXHRcblx0ICAgICAgaWYgKHN1YnNjcmliZXJzLmxlbmd0aCA9PT0gMCkgeyByZXR1cm47IH1cblx0XG5cdCAgICAgIHZhciBjaGlsZCwgY2FsbGJhY2ssIGRldGFpbCA9IHByb21pc2UuX3Jlc3VsdDtcblx0XG5cdCAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3Vic2NyaWJlcnMubGVuZ3RoOyBpICs9IDMpIHtcblx0ICAgICAgICBjaGlsZCA9IHN1YnNjcmliZXJzW2ldO1xuXHQgICAgICAgIGNhbGxiYWNrID0gc3Vic2NyaWJlcnNbaSArIHNldHRsZWRdO1xuXHRcblx0ICAgICAgICBpZiAoY2hpbGQpIHtcblx0ICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGludm9rZUNhbGxiYWNrKHNldHRsZWQsIGNoaWxkLCBjYWxsYmFjaywgZGV0YWlsKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgY2FsbGJhY2soZGV0YWlsKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHByb21pc2UuX3N1YnNjcmliZXJzLmxlbmd0aCA9IDA7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkRXJyb3JPYmplY3QoKSB7XG5cdCAgICAgIHRoaXMuZXJyb3IgPSBudWxsO1xuXHQgICAgfVxuXHRcblx0ICAgIHZhciBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRUUllfQ0FUQ0hfRVJST1IgPSBuZXcgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkRXJyb3JPYmplY3QoKTtcblx0XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCR0cnlDYXRjaChjYWxsYmFjaywgZGV0YWlsKSB7XG5cdCAgICAgIHRyeSB7XG5cdCAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGRldGFpbCk7XG5cdCAgICAgIH0gY2F0Y2goZSkge1xuXHQgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFRSWV9DQVRDSF9FUlJPUi5lcnJvciA9IGU7XG5cdCAgICAgICAgcmV0dXJuIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFRSWV9DQVRDSF9FUlJPUjtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGludm9rZUNhbGxiYWNrKHNldHRsZWQsIHByb21pc2UsIGNhbGxiYWNrLCBkZXRhaWwpIHtcblx0ICAgICAgdmFyIGhhc0NhbGxiYWNrID0gbGliJGVzNiRwcm9taXNlJHV0aWxzJCRpc0Z1bmN0aW9uKGNhbGxiYWNrKSxcblx0ICAgICAgICAgIHZhbHVlLCBlcnJvciwgc3VjY2VlZGVkLCBmYWlsZWQ7XG5cdFxuXHQgICAgICBpZiAoaGFzQ2FsbGJhY2spIHtcblx0ICAgICAgICB2YWx1ZSA9IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHRyeUNhdGNoKGNhbGxiYWNrLCBkZXRhaWwpO1xuXHRcblx0ICAgICAgICBpZiAodmFsdWUgPT09IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFRSWV9DQVRDSF9FUlJPUikge1xuXHQgICAgICAgICAgZmFpbGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIGVycm9yID0gdmFsdWUuZXJyb3I7XG5cdCAgICAgICAgICB2YWx1ZSA9IG51bGw7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHN1Y2NlZWRlZCA9IHRydWU7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAocHJvbWlzZSA9PT0gdmFsdWUpIHtcblx0ICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlamVjdChwcm9taXNlLCBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRjYW5ub3RSZXR1cm5Pd24oKSk7XG5cdCAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICB2YWx1ZSA9IGRldGFpbDtcblx0ICAgICAgICBzdWNjZWVkZWQgPSB0cnVlO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBpZiAocHJvbWlzZS5fc3RhdGUgIT09IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFBFTkRJTkcpIHtcblx0ICAgICAgICAvLyBub29wXG5cdCAgICAgIH0gZWxzZSBpZiAoaGFzQ2FsbGJhY2sgJiYgc3VjY2VlZGVkKSB7XG5cdCAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7XG5cdCAgICAgIH0gZWxzZSBpZiAoZmFpbGVkKSB7XG5cdCAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcmVqZWN0KHByb21pc2UsIGVycm9yKTtcblx0ICAgICAgfSBlbHNlIGlmIChzZXR0bGVkID09PSBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRGVUxGSUxMRUQpIHtcblx0ICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRmdWxmaWxsKHByb21pc2UsIHZhbHVlKTtcblx0ICAgICAgfSBlbHNlIGlmIChzZXR0bGVkID09PSBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRSRUpFQ1RFRCkge1xuXHQgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlamVjdChwcm9taXNlLCB2YWx1ZSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRpbml0aWFsaXplUHJvbWlzZShwcm9taXNlLCByZXNvbHZlcikge1xuXHQgICAgICB0cnkge1xuXHQgICAgICAgIHJlc29sdmVyKGZ1bmN0aW9uIHJlc29sdmVQcm9taXNlKHZhbHVlKXtcblx0ICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlc29sdmUocHJvbWlzZSwgdmFsdWUpO1xuXHQgICAgICAgIH0sIGZ1bmN0aW9uIHJlamVjdFByb21pc2UocmVhc29uKSB7XG5cdCAgICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRyZWplY3QocHJvbWlzZSwgcmVhc29uKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfSBjYXRjaChlKSB7XG5cdCAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcmVqZWN0KHByb21pc2UsIGUpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGlkID0gMDtcblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJG5leHRJZCgpIHtcblx0ICAgICAgcmV0dXJuIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGlkKys7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkbWFrZVByb21pc2UocHJvbWlzZSkge1xuXHQgICAgICBwcm9taXNlW2xpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFBST01JU0VfSURdID0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkaWQrKztcblx0ICAgICAgcHJvbWlzZS5fc3RhdGUgPSB1bmRlZmluZWQ7XG5cdCAgICAgIHByb21pc2UuX3Jlc3VsdCA9IHVuZGVmaW5lZDtcblx0ICAgICAgcHJvbWlzZS5fc3Vic2NyaWJlcnMgPSBbXTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRhbGwkJGFsbChlbnRyaWVzKSB7XG5cdCAgICAgIHJldHVybiBuZXcgbGliJGVzNiRwcm9taXNlJGVudW1lcmF0b3IkJGRlZmF1bHQodGhpcywgZW50cmllcykucHJvbWlzZTtcblx0ICAgIH1cblx0ICAgIHZhciBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRhbGwkJGRlZmF1bHQgPSBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRhbGwkJGFsbDtcblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJHJhY2UkJHJhY2UoZW50cmllcykge1xuXHQgICAgICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuXHQgICAgICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuXHRcblx0ICAgICAgaWYgKCFsaWIkZXM2JHByb21pc2UkdXRpbHMkJGlzQXJyYXkoZW50cmllcykpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHQgICAgICAgICAgcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ1lvdSBtdXN0IHBhc3MgYW4gYXJyYXkgdG8gcmFjZS4nKSk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0ICAgICAgICAgIHZhciBsZW5ndGggPSBlbnRyaWVzLmxlbmd0aDtcblx0ICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgICAgQ29uc3RydWN0b3IucmVzb2x2ZShlbnRyaWVzW2ldKS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIHZhciBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRyYWNlJCRkZWZhdWx0ID0gbGliJGVzNiRwcm9taXNlJHByb21pc2UkcmFjZSQkcmFjZTtcblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJHJlamVjdCQkcmVqZWN0KHJlYXNvbikge1xuXHQgICAgICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuXHQgICAgICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuXHQgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3RvcihsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRub29wKTtcblx0ICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG5cdCAgICAgIHJldHVybiBwcm9taXNlO1xuXHQgICAgfVxuXHQgICAgdmFyIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJHJlamVjdCQkZGVmYXVsdCA9IGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJHJlamVjdCQkcmVqZWN0O1xuXHRcblx0XG5cdCAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSQkbmVlZHNSZXNvbHZlcigpIHtcblx0ICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignWW91IG11c3QgcGFzcyBhIHJlc29sdmVyIGZ1bmN0aW9uIGFzIHRoZSBmaXJzdCBhcmd1bWVudCB0byB0aGUgcHJvbWlzZSBjb25zdHJ1Y3RvcicpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRuZWVkc05ldygpIHtcblx0ICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkZhaWxlZCB0byBjb25zdHJ1Y3QgJ1Byb21pc2UnOiBQbGVhc2UgdXNlIHRoZSAnbmV3JyBvcGVyYXRvciwgdGhpcyBvYmplY3QgY29uc3RydWN0b3IgY2Fubm90IGJlIGNhbGxlZCBhcyBhIGZ1bmN0aW9uLlwiKTtcblx0ICAgIH1cblx0XG5cdCAgICB2YXIgbGliJGVzNiRwcm9taXNlJHByb21pc2UkJGRlZmF1bHQgPSBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSQkUHJvbWlzZTtcblx0ICAgIC8qKlxuXHQgICAgICBQcm9taXNlIG9iamVjdHMgcmVwcmVzZW50IHRoZSBldmVudHVhbCByZXN1bHQgb2YgYW4gYXN5bmNocm9ub3VzIG9wZXJhdGlvbi4gVGhlXG5cdCAgICAgIHByaW1hcnkgd2F5IG9mIGludGVyYWN0aW5nIHdpdGggYSBwcm9taXNlIGlzIHRocm91Z2ggaXRzIGB0aGVuYCBtZXRob2QsIHdoaWNoXG5cdCAgICAgIHJlZ2lzdGVycyBjYWxsYmFja3MgdG8gcmVjZWl2ZSBlaXRoZXIgYSBwcm9taXNlJ3MgZXZlbnR1YWwgdmFsdWUgb3IgdGhlIHJlYXNvblxuXHQgICAgICB3aHkgdGhlIHByb21pc2UgY2Fubm90IGJlIGZ1bGZpbGxlZC5cblx0XG5cdCAgICAgIFRlcm1pbm9sb2d5XG5cdCAgICAgIC0tLS0tLS0tLS0tXG5cdFxuXHQgICAgICAtIGBwcm9taXNlYCBpcyBhbiBvYmplY3Qgb3IgZnVuY3Rpb24gd2l0aCBhIGB0aGVuYCBtZXRob2Qgd2hvc2UgYmVoYXZpb3IgY29uZm9ybXMgdG8gdGhpcyBzcGVjaWZpY2F0aW9uLlxuXHQgICAgICAtIGB0aGVuYWJsZWAgaXMgYW4gb2JqZWN0IG9yIGZ1bmN0aW9uIHRoYXQgZGVmaW5lcyBhIGB0aGVuYCBtZXRob2QuXG5cdCAgICAgIC0gYHZhbHVlYCBpcyBhbnkgbGVnYWwgSmF2YVNjcmlwdCB2YWx1ZSAoaW5jbHVkaW5nIHVuZGVmaW5lZCwgYSB0aGVuYWJsZSwgb3IgYSBwcm9taXNlKS5cblx0ICAgICAgLSBgZXhjZXB0aW9uYCBpcyBhIHZhbHVlIHRoYXQgaXMgdGhyb3duIHVzaW5nIHRoZSB0aHJvdyBzdGF0ZW1lbnQuXG5cdCAgICAgIC0gYHJlYXNvbmAgaXMgYSB2YWx1ZSB0aGF0IGluZGljYXRlcyB3aHkgYSBwcm9taXNlIHdhcyByZWplY3RlZC5cblx0ICAgICAgLSBgc2V0dGxlZGAgdGhlIGZpbmFsIHJlc3Rpbmcgc3RhdGUgb2YgYSBwcm9taXNlLCBmdWxmaWxsZWQgb3IgcmVqZWN0ZWQuXG5cdFxuXHQgICAgICBBIHByb21pc2UgY2FuIGJlIGluIG9uZSBvZiB0aHJlZSBzdGF0ZXM6IHBlbmRpbmcsIGZ1bGZpbGxlZCwgb3IgcmVqZWN0ZWQuXG5cdFxuXHQgICAgICBQcm9taXNlcyB0aGF0IGFyZSBmdWxmaWxsZWQgaGF2ZSBhIGZ1bGZpbGxtZW50IHZhbHVlIGFuZCBhcmUgaW4gdGhlIGZ1bGZpbGxlZFxuXHQgICAgICBzdGF0ZS4gIFByb21pc2VzIHRoYXQgYXJlIHJlamVjdGVkIGhhdmUgYSByZWplY3Rpb24gcmVhc29uIGFuZCBhcmUgaW4gdGhlXG5cdCAgICAgIHJlamVjdGVkIHN0YXRlLiAgQSBmdWxmaWxsbWVudCB2YWx1ZSBpcyBuZXZlciBhIHRoZW5hYmxlLlxuXHRcblx0ICAgICAgUHJvbWlzZXMgY2FuIGFsc28gYmUgc2FpZCB0byAqcmVzb2x2ZSogYSB2YWx1ZS4gIElmIHRoaXMgdmFsdWUgaXMgYWxzbyBhXG5cdCAgICAgIHByb21pc2UsIHRoZW4gdGhlIG9yaWdpbmFsIHByb21pc2UncyBzZXR0bGVkIHN0YXRlIHdpbGwgbWF0Y2ggdGhlIHZhbHVlJ3Ncblx0ICAgICAgc2V0dGxlZCBzdGF0ZS4gIFNvIGEgcHJvbWlzZSB0aGF0ICpyZXNvbHZlcyogYSBwcm9taXNlIHRoYXQgcmVqZWN0cyB3aWxsXG5cdCAgICAgIGl0c2VsZiByZWplY3QsIGFuZCBhIHByb21pc2UgdGhhdCAqcmVzb2x2ZXMqIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbGxzIHdpbGxcblx0ICAgICAgaXRzZWxmIGZ1bGZpbGwuXG5cdFxuXHRcblx0ICAgICAgQmFzaWMgVXNhZ2U6XG5cdCAgICAgIC0tLS0tLS0tLS0tLVxuXHRcblx0ICAgICAgYGBganNcblx0ICAgICAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0ICAgICAgICAvLyBvbiBzdWNjZXNzXG5cdCAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG5cdFxuXHQgICAgICAgIC8vIG9uIGZhaWx1cmVcblx0ICAgICAgICByZWplY3QocmVhc29uKTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgICAvLyBvbiBmdWxmaWxsbWVudFxuXHQgICAgICB9LCBmdW5jdGlvbihyZWFzb24pIHtcblx0ICAgICAgICAvLyBvbiByZWplY3Rpb25cblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHRcblx0ICAgICAgQWR2YW5jZWQgVXNhZ2U6XG5cdCAgICAgIC0tLS0tLS0tLS0tLS0tLVxuXHRcblx0ICAgICAgUHJvbWlzZXMgc2hpbmUgd2hlbiBhYnN0cmFjdGluZyBhd2F5IGFzeW5jaHJvbm91cyBpbnRlcmFjdGlvbnMgc3VjaCBhc1xuXHQgICAgICBgWE1MSHR0cFJlcXVlc3Rgcy5cblx0XG5cdCAgICAgIGBgYGpzXG5cdCAgICAgIGZ1bmN0aW9uIGdldEpTT04odXJsKSB7XG5cdCAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG5cdCAgICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cdFxuXHQgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsIHVybCk7XG5cdCAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gaGFuZGxlcjtcblx0ICAgICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnanNvbic7XG5cdCAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcblx0ICAgICAgICAgIHhoci5zZW5kKCk7XG5cdFxuXHQgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlcigpIHtcblx0ICAgICAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gdGhpcy5ET05FKSB7XG5cdCAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSAyMDApIHtcblx0ICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5yZXNwb25zZSk7XG5cdCAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ2dldEpTT046IGAnICsgdXJsICsgJ2AgZmFpbGVkIHdpdGggc3RhdHVzOiBbJyArIHRoaXMuc3RhdHVzICsgJ10nKSk7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9O1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBnZXRKU09OKCcvcG9zdHMuanNvbicpLnRoZW4oZnVuY3Rpb24oanNvbikge1xuXHQgICAgICAgIC8vIG9uIGZ1bGZpbGxtZW50XG5cdCAgICAgIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuXHQgICAgICAgIC8vIG9uIHJlamVjdGlvblxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdFxuXHQgICAgICBVbmxpa2UgY2FsbGJhY2tzLCBwcm9taXNlcyBhcmUgZ3JlYXQgY29tcG9zYWJsZSBwcmltaXRpdmVzLlxuXHRcblx0ICAgICAgYGBganNcblx0ICAgICAgUHJvbWlzZS5hbGwoW1xuXHQgICAgICAgIGdldEpTT04oJy9wb3N0cycpLFxuXHQgICAgICAgIGdldEpTT04oJy9jb21tZW50cycpXG5cdCAgICAgIF0pLnRoZW4oZnVuY3Rpb24odmFsdWVzKXtcblx0ICAgICAgICB2YWx1ZXNbMF0gLy8gPT4gcG9zdHNKU09OXG5cdCAgICAgICAgdmFsdWVzWzFdIC8vID0+IGNvbW1lbnRzSlNPTlxuXHRcblx0ICAgICAgICByZXR1cm4gdmFsdWVzO1xuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdFxuXHQgICAgICBAY2xhc3MgUHJvbWlzZVxuXHQgICAgICBAcGFyYW0ge2Z1bmN0aW9ufSByZXNvbHZlclxuXHQgICAgICBVc2VmdWwgZm9yIHRvb2xpbmcuXG5cdCAgICAgIEBjb25zdHJ1Y3RvclxuXHQgICAgKi9cblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRQcm9taXNlKHJlc29sdmVyKSB7XG5cdCAgICAgIHRoaXNbbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkUFJPTUlTRV9JRF0gPSBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRuZXh0SWQoKTtcblx0ICAgICAgdGhpcy5fcmVzdWx0ID0gdGhpcy5fc3RhdGUgPSB1bmRlZmluZWQ7XG5cdCAgICAgIHRoaXMuX3N1YnNjcmliZXJzID0gW107XG5cdFxuXHQgICAgICBpZiAobGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkbm9vcCAhPT0gcmVzb2x2ZXIpIHtcblx0ICAgICAgICB0eXBlb2YgcmVzb2x2ZXIgIT09ICdmdW5jdGlvbicgJiYgbGliJGVzNiRwcm9taXNlJHByb21pc2UkJG5lZWRzUmVzb2x2ZXIoKTtcblx0ICAgICAgICB0aGlzIGluc3RhbmNlb2YgbGliJGVzNiRwcm9taXNlJHByb21pc2UkJFByb21pc2UgPyBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRpbml0aWFsaXplUHJvbWlzZSh0aGlzLCByZXNvbHZlcikgOiBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSQkbmVlZHNOZXcoKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRQcm9taXNlLmFsbCA9IGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJGFsbCQkZGVmYXVsdDtcblx0ICAgIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRQcm9taXNlLnJhY2UgPSBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRyYWNlJCRkZWZhdWx0O1xuXHQgICAgbGliJGVzNiRwcm9taXNlJHByb21pc2UkJFByb21pc2UucmVzb2x2ZSA9IGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJHJlc29sdmUkJGRlZmF1bHQ7XG5cdCAgICBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSQkUHJvbWlzZS5yZWplY3QgPSBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRyZWplY3QkJGRlZmF1bHQ7XG5cdCAgICBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSQkUHJvbWlzZS5fc2V0U2NoZWR1bGVyID0gbGliJGVzNiRwcm9taXNlJGFzYXAkJHNldFNjaGVkdWxlcjtcblx0ICAgIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRQcm9taXNlLl9zZXRBc2FwID0gbGliJGVzNiRwcm9taXNlJGFzYXAkJHNldEFzYXA7XG5cdCAgICBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSQkUHJvbWlzZS5fYXNhcCA9IGxpYiRlczYkcHJvbWlzZSRhc2FwJCRhc2FwO1xuXHRcblx0ICAgIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRQcm9taXNlLnByb3RvdHlwZSA9IHtcblx0ICAgICAgY29uc3RydWN0b3I6IGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRQcm9taXNlLFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICBUaGUgcHJpbWFyeSB3YXkgb2YgaW50ZXJhY3Rpbmcgd2l0aCBhIHByb21pc2UgaXMgdGhyb3VnaCBpdHMgYHRoZW5gIG1ldGhvZCxcblx0ICAgICAgd2hpY2ggcmVnaXN0ZXJzIGNhbGxiYWNrcyB0byByZWNlaXZlIGVpdGhlciBhIHByb21pc2UncyBldmVudHVhbCB2YWx1ZSBvciB0aGVcblx0ICAgICAgcmVhc29uIHdoeSB0aGUgcHJvbWlzZSBjYW5ub3QgYmUgZnVsZmlsbGVkLlxuXHRcblx0ICAgICAgYGBganNcblx0ICAgICAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uKHVzZXIpe1xuXHQgICAgICAgIC8vIHVzZXIgaXMgYXZhaWxhYmxlXG5cdCAgICAgIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG5cdCAgICAgICAgLy8gdXNlciBpcyB1bmF2YWlsYWJsZSwgYW5kIHlvdSBhcmUgZ2l2ZW4gdGhlIHJlYXNvbiB3aHlcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHRcblx0ICAgICAgQ2hhaW5pbmdcblx0ICAgICAgLS0tLS0tLS1cblx0XG5cdCAgICAgIFRoZSByZXR1cm4gdmFsdWUgb2YgYHRoZW5gIGlzIGl0c2VsZiBhIHByb21pc2UuICBUaGlzIHNlY29uZCwgJ2Rvd25zdHJlYW0nXG5cdCAgICAgIHByb21pc2UgaXMgcmVzb2x2ZWQgd2l0aCB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBmaXJzdCBwcm9taXNlJ3MgZnVsZmlsbG1lbnRcblx0ICAgICAgb3IgcmVqZWN0aW9uIGhhbmRsZXIsIG9yIHJlamVjdGVkIGlmIHRoZSBoYW5kbGVyIHRocm93cyBhbiBleGNlcHRpb24uXG5cdFxuXHQgICAgICBgYGBqc1xuXHQgICAgICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcblx0ICAgICAgICByZXR1cm4gdXNlci5uYW1lO1xuXHQgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG5cdCAgICAgICAgcmV0dXJuICdkZWZhdWx0IG5hbWUnO1xuXHQgICAgICB9KS50aGVuKGZ1bmN0aW9uICh1c2VyTmFtZSkge1xuXHQgICAgICAgIC8vIElmIGBmaW5kVXNlcmAgZnVsZmlsbGVkLCBgdXNlck5hbWVgIHdpbGwgYmUgdGhlIHVzZXIncyBuYW1lLCBvdGhlcndpc2UgaXRcblx0ICAgICAgICAvLyB3aWxsIGJlIGAnZGVmYXVsdCBuYW1lJ2Bcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcblx0ICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZvdW5kIHVzZXIsIGJ1dCBzdGlsbCB1bmhhcHB5Jyk7XG5cdCAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcblx0ICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2BmaW5kVXNlcmAgcmVqZWN0ZWQgYW5kIHdlJ3JlIHVuaGFwcHknKTtcblx0ICAgICAgfSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICAvLyBuZXZlciByZWFjaGVkXG5cdCAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcblx0ICAgICAgICAvLyBpZiBgZmluZFVzZXJgIGZ1bGZpbGxlZCwgYHJlYXNvbmAgd2lsbCBiZSAnRm91bmQgdXNlciwgYnV0IHN0aWxsIHVuaGFwcHknLlxuXHQgICAgICAgIC8vIElmIGBmaW5kVXNlcmAgcmVqZWN0ZWQsIGByZWFzb25gIHdpbGwgYmUgJ2BmaW5kVXNlcmAgcmVqZWN0ZWQgYW5kIHdlJ3JlIHVuaGFwcHknLlxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICAgIElmIHRoZSBkb3duc3RyZWFtIHByb21pc2UgZG9lcyBub3Qgc3BlY2lmeSBhIHJlamVjdGlvbiBoYW5kbGVyLCByZWplY3Rpb24gcmVhc29ucyB3aWxsIGJlIHByb3BhZ2F0ZWQgZnVydGhlciBkb3duc3RyZWFtLlxuXHRcblx0ICAgICAgYGBganNcblx0ICAgICAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG5cdCAgICAgICAgdGhyb3cgbmV3IFBlZGFnb2dpY2FsRXhjZXB0aW9uKCdVcHN0cmVhbSBlcnJvcicpO1xuXHQgICAgICB9KS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgIC8vIG5ldmVyIHJlYWNoZWRcblx0ICAgICAgfSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICAvLyBuZXZlciByZWFjaGVkXG5cdCAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcblx0ICAgICAgICAvLyBUaGUgYFBlZGdhZ29jaWFsRXhjZXB0aW9uYCBpcyBwcm9wYWdhdGVkIGFsbCB0aGUgd2F5IGRvd24gdG8gaGVyZVxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdFxuXHQgICAgICBBc3NpbWlsYXRpb25cblx0ICAgICAgLS0tLS0tLS0tLS0tXG5cdFxuXHQgICAgICBTb21ldGltZXMgdGhlIHZhbHVlIHlvdSB3YW50IHRvIHByb3BhZ2F0ZSB0byBhIGRvd25zdHJlYW0gcHJvbWlzZSBjYW4gb25seSBiZVxuXHQgICAgICByZXRyaWV2ZWQgYXN5bmNocm9ub3VzbHkuIFRoaXMgY2FuIGJlIGFjaGlldmVkIGJ5IHJldHVybmluZyBhIHByb21pc2UgaW4gdGhlXG5cdCAgICAgIGZ1bGZpbGxtZW50IG9yIHJlamVjdGlvbiBoYW5kbGVyLiBUaGUgZG93bnN0cmVhbSBwcm9taXNlIHdpbGwgdGhlbiBiZSBwZW5kaW5nXG5cdCAgICAgIHVudGlsIHRoZSByZXR1cm5lZCBwcm9taXNlIGlzIHNldHRsZWQuIFRoaXMgaXMgY2FsbGVkICphc3NpbWlsYXRpb24qLlxuXHRcblx0ICAgICAgYGBganNcblx0ICAgICAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG5cdCAgICAgICAgcmV0dXJuIGZpbmRDb21tZW50c0J5QXV0aG9yKHVzZXIpO1xuXHQgICAgICB9KS50aGVuKGZ1bmN0aW9uIChjb21tZW50cykge1xuXHQgICAgICAgIC8vIFRoZSB1c2VyJ3MgY29tbWVudHMgYXJlIG5vdyBhdmFpbGFibGVcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHRcblx0ICAgICAgSWYgdGhlIGFzc2ltbGlhdGVkIHByb21pc2UgcmVqZWN0cywgdGhlbiB0aGUgZG93bnN0cmVhbSBwcm9taXNlIHdpbGwgYWxzbyByZWplY3QuXG5cdFxuXHQgICAgICBgYGBqc1xuXHQgICAgICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcblx0ICAgICAgICByZXR1cm4gZmluZENvbW1lbnRzQnlBdXRob3IodXNlcik7XG5cdCAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGNvbW1lbnRzKSB7XG5cdCAgICAgICAgLy8gSWYgYGZpbmRDb21tZW50c0J5QXV0aG9yYCBmdWxmaWxscywgd2UnbGwgaGF2ZSB0aGUgdmFsdWUgaGVyZVxuXHQgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG5cdCAgICAgICAgLy8gSWYgYGZpbmRDb21tZW50c0J5QXV0aG9yYCByZWplY3RzLCB3ZSdsbCBoYXZlIHRoZSByZWFzb24gaGVyZVxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdFxuXHQgICAgICBTaW1wbGUgRXhhbXBsZVxuXHQgICAgICAtLS0tLS0tLS0tLS0tLVxuXHRcblx0ICAgICAgU3luY2hyb25vdXMgRXhhbXBsZVxuXHRcblx0ICAgICAgYGBgamF2YXNjcmlwdFxuXHQgICAgICB2YXIgcmVzdWx0O1xuXHRcblx0ICAgICAgdHJ5IHtcblx0ICAgICAgICByZXN1bHQgPSBmaW5kUmVzdWx0KCk7XG5cdCAgICAgICAgLy8gc3VjY2Vzc1xuXHQgICAgICB9IGNhdGNoKHJlYXNvbikge1xuXHQgICAgICAgIC8vIGZhaWx1cmVcblx0ICAgICAgfVxuXHQgICAgICBgYGBcblx0XG5cdCAgICAgIEVycmJhY2sgRXhhbXBsZVxuXHRcblx0ICAgICAgYGBganNcblx0ICAgICAgZmluZFJlc3VsdChmdW5jdGlvbihyZXN1bHQsIGVycil7XG5cdCAgICAgICAgaWYgKGVycikge1xuXHQgICAgICAgICAgLy8gZmFpbHVyZVxuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAvLyBzdWNjZXNzXG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdFxuXHQgICAgICBQcm9taXNlIEV4YW1wbGU7XG5cdFxuXHQgICAgICBgYGBqYXZhc2NyaXB0XG5cdCAgICAgIGZpbmRSZXN1bHQoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG5cdCAgICAgICAgLy8gc3VjY2Vzc1xuXHQgICAgICB9LCBmdW5jdGlvbihyZWFzb24pe1xuXHQgICAgICAgIC8vIGZhaWx1cmVcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHRcblx0ICAgICAgQWR2YW5jZWQgRXhhbXBsZVxuXHQgICAgICAtLS0tLS0tLS0tLS0tLVxuXHRcblx0ICAgICAgU3luY2hyb25vdXMgRXhhbXBsZVxuXHRcblx0ICAgICAgYGBgamF2YXNjcmlwdFxuXHQgICAgICB2YXIgYXV0aG9yLCBib29rcztcblx0XG5cdCAgICAgIHRyeSB7XG5cdCAgICAgICAgYXV0aG9yID0gZmluZEF1dGhvcigpO1xuXHQgICAgICAgIGJvb2tzICA9IGZpbmRCb29rc0J5QXV0aG9yKGF1dGhvcik7XG5cdCAgICAgICAgLy8gc3VjY2Vzc1xuXHQgICAgICB9IGNhdGNoKHJlYXNvbikge1xuXHQgICAgICAgIC8vIGZhaWx1cmVcblx0ICAgICAgfVxuXHQgICAgICBgYGBcblx0XG5cdCAgICAgIEVycmJhY2sgRXhhbXBsZVxuXHRcblx0ICAgICAgYGBganNcblx0XG5cdCAgICAgIGZ1bmN0aW9uIGZvdW5kQm9va3MoYm9va3MpIHtcblx0XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGZ1bmN0aW9uIGZhaWx1cmUocmVhc29uKSB7XG5cdFxuXHQgICAgICB9XG5cdFxuXHQgICAgICBmaW5kQXV0aG9yKGZ1bmN0aW9uKGF1dGhvciwgZXJyKXtcblx0ICAgICAgICBpZiAoZXJyKSB7XG5cdCAgICAgICAgICBmYWlsdXJlKGVycik7XG5cdCAgICAgICAgICAvLyBmYWlsdXJlXG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgIGZpbmRCb29va3NCeUF1dGhvcihhdXRob3IsIGZ1bmN0aW9uKGJvb2tzLCBlcnIpIHtcblx0ICAgICAgICAgICAgICBpZiAoZXJyKSB7XG5cdCAgICAgICAgICAgICAgICBmYWlsdXJlKGVycik7XG5cdCAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgICAgICAgIGZvdW5kQm9va3MoYm9va3MpO1xuXHQgICAgICAgICAgICAgICAgfSBjYXRjaChyZWFzb24pIHtcblx0ICAgICAgICAgICAgICAgICAgZmFpbHVyZShyZWFzb24pO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICB9IGNhdGNoKGVycm9yKSB7XG5cdCAgICAgICAgICAgIGZhaWx1cmUoZXJyKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIC8vIHN1Y2Nlc3Ncblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHQgICAgICBgYGBcblx0XG5cdCAgICAgIFByb21pc2UgRXhhbXBsZTtcblx0XG5cdCAgICAgIGBgYGphdmFzY3JpcHRcblx0ICAgICAgZmluZEF1dGhvcigpLlxuXHQgICAgICAgIHRoZW4oZmluZEJvb2tzQnlBdXRob3IpLlxuXHQgICAgICAgIHRoZW4oZnVuY3Rpb24oYm9va3Mpe1xuXHQgICAgICAgICAgLy8gZm91bmQgYm9va3Ncblx0ICAgICAgfSkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKXtcblx0ICAgICAgICAvLyBzb21ldGhpbmcgd2VudCB3cm9uZ1xuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdFxuXHQgICAgICBAbWV0aG9kIHRoZW5cblx0ICAgICAgQHBhcmFtIHtGdW5jdGlvbn0gb25GdWxmaWxsZWRcblx0ICAgICAgQHBhcmFtIHtGdW5jdGlvbn0gb25SZWplY3RlZFxuXHQgICAgICBVc2VmdWwgZm9yIHRvb2xpbmcuXG5cdCAgICAgIEByZXR1cm4ge1Byb21pc2V9XG5cdCAgICAqL1xuXHQgICAgICB0aGVuOiBsaWIkZXM2JHByb21pc2UkdGhlbiQkZGVmYXVsdCxcblx0XG5cdCAgICAvKipcblx0ICAgICAgYGNhdGNoYCBpcyBzaW1wbHkgc3VnYXIgZm9yIGB0aGVuKHVuZGVmaW5lZCwgb25SZWplY3Rpb24pYCB3aGljaCBtYWtlcyBpdCB0aGUgc2FtZVxuXHQgICAgICBhcyB0aGUgY2F0Y2ggYmxvY2sgb2YgYSB0cnkvY2F0Y2ggc3RhdGVtZW50LlxuXHRcblx0ICAgICAgYGBganNcblx0ICAgICAgZnVuY3Rpb24gZmluZEF1dGhvcigpe1xuXHQgICAgICAgIHRocm93IG5ldyBFcnJvcignY291bGRuJ3QgZmluZCB0aGF0IGF1dGhvcicpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAvLyBzeW5jaHJvbm91c1xuXHQgICAgICB0cnkge1xuXHQgICAgICAgIGZpbmRBdXRob3IoKTtcblx0ICAgICAgfSBjYXRjaChyZWFzb24pIHtcblx0ICAgICAgICAvLyBzb21ldGhpbmcgd2VudCB3cm9uZ1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAvLyBhc3luYyB3aXRoIHByb21pc2VzXG5cdCAgICAgIGZpbmRBdXRob3IoKS5jYXRjaChmdW5jdGlvbihyZWFzb24pe1xuXHQgICAgICAgIC8vIHNvbWV0aGluZyB3ZW50IHdyb25nXG5cdCAgICAgIH0pO1xuXHQgICAgICBgYGBcblx0XG5cdCAgICAgIEBtZXRob2QgY2F0Y2hcblx0ICAgICAgQHBhcmFtIHtGdW5jdGlvbn0gb25SZWplY3Rpb25cblx0ICAgICAgVXNlZnVsIGZvciB0b29saW5nLlxuXHQgICAgICBAcmV0dXJuIHtQcm9taXNlfVxuXHQgICAgKi9cblx0ICAgICAgJ2NhdGNoJzogZnVuY3Rpb24ob25SZWplY3Rpb24pIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy50aGVuKG51bGwsIG9uUmVqZWN0aW9uKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICAgIHZhciBsaWIkZXM2JHByb21pc2UkZW51bWVyYXRvciQkZGVmYXVsdCA9IGxpYiRlczYkcHJvbWlzZSRlbnVtZXJhdG9yJCRFbnVtZXJhdG9yO1xuXHQgICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJGVudW1lcmF0b3IkJEVudW1lcmF0b3IoQ29uc3RydWN0b3IsIGlucHV0KSB7XG5cdCAgICAgIHRoaXMuX2luc3RhbmNlQ29uc3RydWN0b3IgPSBDb25zdHJ1Y3Rvcjtcblx0ICAgICAgdGhpcy5wcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJG5vb3ApO1xuXHRcblx0ICAgICAgaWYgKCF0aGlzLnByb21pc2VbbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkUFJPTUlTRV9JRF0pIHtcblx0ICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRtYWtlUHJvbWlzZSh0aGlzLnByb21pc2UpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBpZiAobGliJGVzNiRwcm9taXNlJHV0aWxzJCRpc0FycmF5KGlucHV0KSkge1xuXHQgICAgICAgIHRoaXMuX2lucHV0ICAgICA9IGlucHV0O1xuXHQgICAgICAgIHRoaXMubGVuZ3RoICAgICA9IGlucHV0Lmxlbmd0aDtcblx0ICAgICAgICB0aGlzLl9yZW1haW5pbmcgPSBpbnB1dC5sZW5ndGg7XG5cdFxuXHQgICAgICAgIHRoaXMuX3Jlc3VsdCA9IG5ldyBBcnJheSh0aGlzLmxlbmd0aCk7XG5cdFxuXHQgICAgICAgIGlmICh0aGlzLmxlbmd0aCA9PT0gMCkge1xuXHQgICAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkZnVsZmlsbCh0aGlzLnByb21pc2UsIHRoaXMuX3Jlc3VsdCk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHRoaXMubGVuZ3RoID0gdGhpcy5sZW5ndGggfHwgMDtcblx0ICAgICAgICAgIHRoaXMuX2VudW1lcmF0ZSgpO1xuXHQgICAgICAgICAgaWYgKHRoaXMuX3JlbWFpbmluZyA9PT0gMCkge1xuXHQgICAgICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRmdWxmaWxsKHRoaXMucHJvbWlzZSwgdGhpcy5fcmVzdWx0KTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcmVqZWN0KHRoaXMucHJvbWlzZSwgbGliJGVzNiRwcm9taXNlJGVudW1lcmF0b3IkJHZhbGlkYXRpb25FcnJvcigpKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRlbnVtZXJhdG9yJCR2YWxpZGF0aW9uRXJyb3IoKSB7XG5cdCAgICAgIHJldHVybiBuZXcgRXJyb3IoJ0FycmF5IE1ldGhvZHMgbXVzdCBiZSBwcm92aWRlZCBhbiBBcnJheScpO1xuXHQgICAgfVxuXHRcblx0ICAgIGxpYiRlczYkcHJvbWlzZSRlbnVtZXJhdG9yJCRFbnVtZXJhdG9yLnByb3RvdHlwZS5fZW51bWVyYXRlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIHZhciBsZW5ndGggID0gdGhpcy5sZW5ndGg7XG5cdCAgICAgIHZhciBpbnB1dCAgID0gdGhpcy5faW5wdXQ7XG5cdFxuXHQgICAgICBmb3IgKHZhciBpID0gMDsgdGhpcy5fc3RhdGUgPT09IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFBFTkRJTkcgJiYgaSA8IGxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgdGhpcy5fZWFjaEVudHJ5KGlucHV0W2ldLCBpKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICBsaWIkZXM2JHByb21pc2UkZW51bWVyYXRvciQkRW51bWVyYXRvci5wcm90b3R5cGUuX2VhY2hFbnRyeSA9IGZ1bmN0aW9uKGVudHJ5LCBpKSB7XG5cdCAgICAgIHZhciBjID0gdGhpcy5faW5zdGFuY2VDb25zdHJ1Y3Rvcjtcblx0ICAgICAgdmFyIHJlc29sdmUgPSBjLnJlc29sdmU7XG5cdFxuXHQgICAgICBpZiAocmVzb2x2ZSA9PT0gbGliJGVzNiRwcm9taXNlJHByb21pc2UkcmVzb2x2ZSQkZGVmYXVsdCkge1xuXHQgICAgICAgIHZhciB0aGVuID0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkZ2V0VGhlbihlbnRyeSk7XG5cdFxuXHQgICAgICAgIGlmICh0aGVuID09PSBsaWIkZXM2JHByb21pc2UkdGhlbiQkZGVmYXVsdCAmJlxuXHQgICAgICAgICAgICBlbnRyeS5fc3RhdGUgIT09IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFBFTkRJTkcpIHtcblx0ICAgICAgICAgIHRoaXMuX3NldHRsZWRBdChlbnRyeS5fc3RhdGUsIGksIGVudHJ5Ll9yZXN1bHQpO1xuXHQgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoZW4gIT09ICdmdW5jdGlvbicpIHtcblx0ICAgICAgICAgIHRoaXMuX3JlbWFpbmluZy0tO1xuXHQgICAgICAgICAgdGhpcy5fcmVzdWx0W2ldID0gZW50cnk7XG5cdCAgICAgICAgfSBlbHNlIGlmIChjID09PSBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSQkZGVmYXVsdCkge1xuXHQgICAgICAgICAgdmFyIHByb21pc2UgPSBuZXcgYyhsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRub29wKTtcblx0ICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGhhbmRsZU1heWJlVGhlbmFibGUocHJvbWlzZSwgZW50cnksIHRoZW4pO1xuXHQgICAgICAgICAgdGhpcy5fd2lsbFNldHRsZUF0KHByb21pc2UsIGkpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB0aGlzLl93aWxsU2V0dGxlQXQobmV3IGMoZnVuY3Rpb24ocmVzb2x2ZSkgeyByZXNvbHZlKGVudHJ5KTsgfSksIGkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICB0aGlzLl93aWxsU2V0dGxlQXQocmVzb2x2ZShlbnRyeSksIGkpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIGxpYiRlczYkcHJvbWlzZSRlbnVtZXJhdG9yJCRFbnVtZXJhdG9yLnByb3RvdHlwZS5fc2V0dGxlZEF0ID0gZnVuY3Rpb24oc3RhdGUsIGksIHZhbHVlKSB7XG5cdCAgICAgIHZhciBwcm9taXNlID0gdGhpcy5wcm9taXNlO1xuXHRcblx0ICAgICAgaWYgKHByb21pc2UuX3N0YXRlID09PSBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRQRU5ESU5HKSB7XG5cdCAgICAgICAgdGhpcy5fcmVtYWluaW5nLS07XG5cdFxuXHQgICAgICAgIGlmIChzdGF0ZSA9PT0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkUkVKRUNURUQpIHtcblx0ICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlamVjdChwcm9taXNlLCB2YWx1ZSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHRoaXMuX3Jlc3VsdFtpXSA9IHZhbHVlO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHRcblx0ICAgICAgaWYgKHRoaXMuX3JlbWFpbmluZyA9PT0gMCkge1xuXHQgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGZ1bGZpbGwocHJvbWlzZSwgdGhpcy5fcmVzdWx0KTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICBsaWIkZXM2JHByb21pc2UkZW51bWVyYXRvciQkRW51bWVyYXRvci5wcm90b3R5cGUuX3dpbGxTZXR0bGVBdCA9IGZ1bmN0aW9uKHByb21pc2UsIGkpIHtcblx0ICAgICAgdmFyIGVudW1lcmF0b3IgPSB0aGlzO1xuXHRcblx0ICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkc3Vic2NyaWJlKHByb21pc2UsIHVuZGVmaW5lZCwgZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgICBlbnVtZXJhdG9yLl9zZXR0bGVkQXQobGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkRlVMRklMTEVELCBpLCB2YWx1ZSk7XG5cdCAgICAgIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuXHQgICAgICAgIGVudW1lcmF0b3IuX3NldHRsZWRBdChsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRSRUpFQ1RFRCwgaSwgcmVhc29uKTtcblx0ICAgICAgfSk7XG5cdCAgICB9O1xuXHQgICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJHBvbHlmaWxsJCRwb2x5ZmlsbCgpIHtcblx0ICAgICAgdmFyIGxvY2FsO1xuXHRcblx0ICAgICAgaWYgKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnKSB7XG5cdCAgICAgICAgICBsb2NhbCA9IGdsb2JhbDtcblx0ICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0ICAgICAgICAgIGxvY2FsID0gc2VsZjtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgICAgbG9jYWwgPSBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHQgICAgICAgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigncG9seWZpbGwgZmFpbGVkIGJlY2F1c2UgZ2xvYmFsIG9iamVjdCBpcyB1bmF2YWlsYWJsZSBpbiB0aGlzIGVudmlyb25tZW50Jyk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHZhciBQID0gbG9jYWwuUHJvbWlzZTtcblx0XG5cdCAgICAgIGlmIChQICYmIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChQLnJlc29sdmUoKSkgPT09ICdbb2JqZWN0IFByb21pc2VdJyAmJiAhUC5jYXN0KSB7XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBsb2NhbC5Qcm9taXNlID0gbGliJGVzNiRwcm9taXNlJHByb21pc2UkJGRlZmF1bHQ7XG5cdCAgICB9XG5cdCAgICB2YXIgbGliJGVzNiRwcm9taXNlJHBvbHlmaWxsJCRkZWZhdWx0ID0gbGliJGVzNiRwcm9taXNlJHBvbHlmaWxsJCRwb2x5ZmlsbDtcblx0XG5cdCAgICB2YXIgbGliJGVzNiRwcm9taXNlJHVtZCQkRVM2UHJvbWlzZSA9IHtcblx0ICAgICAgJ1Byb21pc2UnOiBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSQkZGVmYXVsdCxcblx0ICAgICAgJ3BvbHlmaWxsJzogbGliJGVzNiRwcm9taXNlJHBvbHlmaWxsJCRkZWZhdWx0XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qIGdsb2JhbCBkZWZpbmU6dHJ1ZSBtb2R1bGU6dHJ1ZSB3aW5kb3c6IHRydWUgKi9cblx0ICAgIGlmIChcImZ1bmN0aW9uXCIgPT09ICdmdW5jdGlvbicgJiYgX193ZWJwYWNrX3JlcXVpcmVfXygzKVsnYW1kJ10pIHtcblx0ICAgICAgIShfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gbGliJGVzNiRwcm9taXNlJHVtZCQkRVM2UHJvbWlzZTsgfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18sIGV4cG9ydHMsIG1vZHVsZSksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTtcblx0ICAgIH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlWydleHBvcnRzJ10pIHtcblx0ICAgICAgbW9kdWxlWydleHBvcnRzJ10gPSBsaWIkZXM2JHByb21pc2UkdW1kJCRFUzZQcm9taXNlO1xuXHQgICAgfSBlbHNlIGlmICh0eXBlb2YgdGhpcyAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0ICAgICAgdGhpc1snRVM2UHJvbWlzZSddID0gbGliJGVzNiRwcm9taXNlJHVtZCQkRVM2UHJvbWlzZTtcblx0ICAgIH1cblx0XG5cdCAgICBsaWIkZXM2JHByb21pc2UkcG9seWZpbGwkJGRlZmF1bHQoKTtcblx0fSkuY2FsbCh0aGlzKTtcblx0XG5cdFxuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXygyKSwgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSwgX193ZWJwYWNrX3JlcXVpcmVfXyg0KShtb2R1bGUpKSlcblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdC8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxuXHRcblx0dmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXHRcblx0Ly8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG5cdC8vIGRvbid0IGJyZWFrIHRoaW5ncy4gIEJ1dCB3ZSBuZWVkIHRvIHdyYXAgaXQgaW4gYSB0cnkgY2F0Y2ggaW4gY2FzZSBpdCBpc1xuXHQvLyB3cmFwcGVkIGluIHN0cmljdCBtb2RlIGNvZGUgd2hpY2ggZG9lc24ndCBkZWZpbmUgYW55IGdsb2JhbHMuICBJdCdzIGluc2lkZSBhXG5cdC8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cdFxuXHR2YXIgY2FjaGVkU2V0VGltZW91dDtcblx0dmFyIGNhY2hlZENsZWFyVGltZW91dDtcblx0XG5cdChmdW5jdGlvbiAoKSB7XG5cdCAgdHJ5IHtcblx0ICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuXHQgIH0gY2F0Y2ggKGUpIHtcblx0ICAgIGNhY2hlZFNldFRpbWVvdXQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRocm93IG5ldyBFcnJvcignc2V0VGltZW91dCBpcyBub3QgZGVmaW5lZCcpO1xuXHQgICAgfVxuXHQgIH1cblx0ICB0cnkge1xuXHQgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuXHQgIH0gY2F0Y2ggKGUpIHtcblx0ICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKCdjbGVhclRpbWVvdXQgaXMgbm90IGRlZmluZWQnKTtcblx0ICAgIH1cblx0ICB9XG5cdH0gKCkpXG5cdHZhciBxdWV1ZSA9IFtdO1xuXHR2YXIgZHJhaW5pbmcgPSBmYWxzZTtcblx0dmFyIGN1cnJlbnRRdWV1ZTtcblx0dmFyIHF1ZXVlSW5kZXggPSAtMTtcblx0XG5cdGZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcblx0ICAgIGlmICghZHJhaW5pbmcgfHwgIWN1cnJlbnRRdWV1ZSkge1xuXHQgICAgICAgIHJldHVybjtcblx0ICAgIH1cblx0ICAgIGRyYWluaW5nID0gZmFsc2U7XG5cdCAgICBpZiAoY3VycmVudFF1ZXVlLmxlbmd0aCkge1xuXHQgICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcblx0ICAgIH1cblx0ICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcblx0ICAgICAgICBkcmFpblF1ZXVlKCk7XG5cdCAgICB9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG5cdCAgICBpZiAoZHJhaW5pbmcpIHtcblx0ICAgICAgICByZXR1cm47XG5cdCAgICB9XG5cdCAgICB2YXIgdGltZW91dCA9IGNhY2hlZFNldFRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcblx0ICAgIGRyYWluaW5nID0gdHJ1ZTtcblx0XG5cdCAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuXHQgICAgd2hpbGUobGVuKSB7XG5cdCAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG5cdCAgICAgICAgcXVldWUgPSBbXTtcblx0ICAgICAgICB3aGlsZSAoKytxdWV1ZUluZGV4IDwgbGVuKSB7XG5cdCAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcblx0ICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG5cdCAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoO1xuXHQgICAgfVxuXHQgICAgY3VycmVudFF1ZXVlID0gbnVsbDtcblx0ICAgIGRyYWluaW5nID0gZmFsc2U7XG5cdCAgICBjYWNoZWRDbGVhclRpbWVvdXQodGltZW91dCk7XG5cdH1cblx0XG5cdHByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG5cdCAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG5cdCAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcblx0ICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cdCAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpO1xuXHQgICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHtcblx0ICAgICAgICBjYWNoZWRTZXRUaW1lb3V0KGRyYWluUXVldWUsIDApO1xuXHQgICAgfVxuXHR9O1xuXHRcblx0Ly8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0c1xuXHRmdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHtcblx0ICAgIHRoaXMuZnVuID0gZnVuO1xuXHQgICAgdGhpcy5hcnJheSA9IGFycmF5O1xuXHR9XG5cdEl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpO1xuXHR9O1xuXHRwcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xuXHRwcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xuXHRwcm9jZXNzLmVudiA9IHt9O1xuXHRwcm9jZXNzLmFyZ3YgPSBbXTtcblx0cHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzXG5cdHByb2Nlc3MudmVyc2lvbnMgPSB7fTtcblx0XG5cdGZ1bmN0aW9uIG5vb3AoKSB7fVxuXHRcblx0cHJvY2Vzcy5vbiA9IG5vb3A7XG5cdHByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xuXHRwcm9jZXNzLm9uY2UgPSBub29wO1xuXHRwcm9jZXNzLm9mZiA9IG5vb3A7XG5cdHByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xuXHRwcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7XG5cdHByb2Nlc3MuZW1pdCA9IG5vb3A7XG5cdFxuXHRwcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkge1xuXHQgICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xuXHR9O1xuXHRcblx0cHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcblx0cHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcblx0ICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkJyk7XG5cdH07XG5cdHByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG5cblxuLyoqKi8gfSxcbi8qIDMgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7IHRocm93IG5ldyBFcnJvcihcImRlZmluZSBjYW5ub3QgYmUgdXNlZCBpbmRpcmVjdFwiKTsgfTtcclxuXG5cbi8qKiovIH0sXG4vKiA0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG1vZHVsZSkge1xyXG5cdFx0aWYoIW1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHtcclxuXHRcdFx0bW9kdWxlLmRlcHJlY2F0ZSA9IGZ1bmN0aW9uKCkge307XHJcblx0XHRcdG1vZHVsZS5wYXRocyA9IFtdO1xyXG5cdFx0XHQvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHRcclxuXHRcdFx0bW9kdWxlLmNoaWxkcmVuID0gW107XHJcblx0XHRcdG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIG1vZHVsZTtcclxuXHR9XHJcblxuXG4vKioqLyB9LFxuLyogNSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0LyogKGlnbm9yZWQpICovXG5cbi8qKiovIH1cbi8qKioqKiovIF0pO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIGtpd29vbS1oZWxwZXIuanNcbiAqKi8iLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHdlYnBhY2svYm9vdHN0cmFwIDU3ZGVlOTY3ODAwMTQwNTkxMjZlXG4gKiovIiwiaW1wb3J0IHsgUHJvbWlzZSB9IGZyb20gXCJlczYtcHJvbWlzZVwiO1xyXG5cclxuLy8g7J2067Kk7Yq47J2YIO2CpOulvCDslrvsnYxcclxuZnVuY3Rpb24gZ2V0RXZlbnRLZXkoZXZlbnROYW1lLCB0ckNvZGUpIHtcclxuXHRyZXR1cm4gZXZlbnROYW1lICsgXCJfXCIgKyB0ckNvZGU7XHJcbn1cclxuXHJcbmNsYXNzIEtpd29vbUhlbHBlciB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHR3aW5kb3cuS2l3b29tSGVscGVyID0gdGhpcztcclxuXHRcdHRoaXMuX2V2ZW50SGFuZGxlciA9IHt9O1xyXG5cdFx0dGhpcy5fc2NyZWVuTm8gPSAwO1xyXG5cdFx0dGhpcy5fcmVxdWVzdFNjcmVlbnMgPSBbXTtcclxuXHRcdHRoaXMuX3JlZ2lzdGVyU2NyZWVucyA9IFtdO1xyXG5cdFx0dGhpcy5fYXR0YWNoKCk7XHJcblx0fVxyXG5cdF9hdHRhY2goKSB7XHJcblx0XHQvLyDsgqzsmqnsnpAg6rWs67aEIOyalOyyrSDrqoXsnYAgdHJDb2Rl7JmAIOuPmeydvO2VmOuLpC5cclxuXHRcdEtpd29vbUhlbHBlci5FVkVOVFMuZm9yRWFjaCh2ID0+IHtcclxuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcih2ICsgXCIua2l3b29tXCIsIHRoaXMpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cdC8vIO2ZlOuptCDrsojtmLjrpbwg7Ja77J2MXHJcblx0X2dldFNjcmVlbk5vKCkge1xyXG5cdFx0cmV0dXJuIFwiU1JDXCIgKyAodGhpcy5fc2NyZWVuTm8rKyk7XHJcblx0fVxyXG5cdGhhbmRsZUV2ZW50KGUpIHtcclxuXHRcdC8vIGNvbnNvbGUubG9nKGUudHlwZSwgZSk7XHJcblx0XHRsZXQgZGF0YSA9IGUuZGV0YWlsO1xyXG5cdFx0bGV0IHR5cGUgPSBlLnR5cGUuc3Vic3RyaW5nKDAsIGUudHlwZS5pbmRleE9mKFwiLmtpd29vbVwiKSk7XHJcblx0XHRpZiAodHlwZSA9PT0gXCJyZWNlaXZlVHJEYXRhXCIpIHtcclxuXHRcdFx0ZGF0YS5zaXplID0ga2l3b29tID8ga2l3b29tLmdldFJlcGVhdENudChkYXRhLnRyQ29kZSwgZGF0YS5yUU5hbWUpIDogMDtcclxuXHRcdH1cclxuXHJcblx0XHRsZXQgaGFuZGxlciA9IHRoaXMuX2V2ZW50SGFuZGxlcltnZXRFdmVudEtleSh0eXBlLCBkYXRhLnRyQ29kZSldO1xyXG5cdFx0Ly8gY29uc29sZS5sb2codHlwZSxkYXRhLGhhbmRsZXIpO1xyXG5cdFx0aGFuZGxlciAmJiBoYW5kbGVyLmNhbGwodGhpcywgZGF0YSk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEF0dGFjaCBhbiBldmVudCBoYW5kbGVyIGZ1bmN0aW9uLlxyXG5cdCAqIEBtZXRob2QgS2l3b29tSGVscGVyI29uXHJcblx0ICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZVxyXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSB0ckNvZGVcclxuXHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyXHJcblx0ICogQHJldHVybiB7dGhpc30gaW5zdGFuY2Ugb2YgaXRzZWxmXHJcblx0ICogQGV4YW1wbGVcclxuXHRcdC8vIOy9lOuTnOuzhCDtlbjrk6Trn6wg65Ox66GdIChzdHJpbmcpXHJcblx0XHRLaXdvb21IZWxwZXIub24oXCJyZWNlaXZlVHJEYXRhXCIsIFwib3B0MTAwMDFcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHQvLyAuLi5cclxuXHRcdH0pO1xyXG5cdFx0Ly8g7L2U65Oc67OEIO2VuOuTpOufrCDrk7HroZ0gKGhhc2htYXApXHJcblx0XHRLaXdvb21IZWxwZXIub24oXCJyZWNlaXZlVHJEYXRhXCIsIHtcclxuXHRcdFx0XCJvcHQxMDAwMVwiIDogZnVuY3Rpb24oZGF0YSkgeyAvLyAuLi4gfSxcclxuXHRcdFx0XCJvcHQxMDAwMlwiIDogZnVuY3Rpb24oZGF0YSkgeyAvLyAuLi4gfVxyXG5cdFx0fSk7XHJcblx0ICovXHJcblx0b24oZXZlbnROYW1lLCB0ckNvZGUsIGhhbmRsZXIpIHtcclxuXHRcdGlmICggS2l3b29tSGVscGVyLkVWRU5UUy5pbmRleE9mKGV2ZW50TmFtZSkgPT09IC0xKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyB0ckNvZGXqsIAgb2JqZWN0IOyduCDqsr3smrAuXHJcblx0XHRpZiAodHlwZW9mIHRyQ29kZSA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgaGFuZGxlciA9PT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0XHRPYmplY3Qua2V5cyh0ckNvZGUpLmZvckVhY2godiA9PiB7XHJcblx0XHRcdFx0dGhpcy5vbihldmVudE5hbWUsIHYsIHRyQ29kZVt2XSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdC8vIOuLqOqxtOyduCDqsr3smrAuXHJcblx0XHR9IGVsc2UgaWYgKHR5cGVvZiB0ckNvZGUgPT09IFwic3RyaW5nXCIgJiYgdHlwZW9mIGhhbmRsZXIgPT09IFwiZnVuY3Rpb25cIikge1xyXG5cdFx0XHR0aGlzLl9ldmVudEhhbmRsZXJbZ2V0RXZlbnRLZXkoZXZlbnROYW1lLCB0ckNvZGUpXSA9IGhhbmRsZXI7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9XHJcblx0LyoqXHJcblx0ICogRGV0YWNoIGFuIGV2ZW50IGhhbmRsZXIgZnVuY3Rpb24uXHJcblx0ICogQG1ldGhvZCBLaXdvb21IZWxwZXIjb2ZmXHJcblx0ICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZVxyXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSB0ckNvZGVcclxuXHQgKiBAcmV0dXJuIHt0aGlzfSBpbnN0YW5jZSBvZiBpdHNlbGZcclxuXHQgKiBAZXhhbXBsZVxyXG5cdFx0S2l3b29tSGVscGVyLm9mZigpO1xyXG5cdFx0S2l3b29tSGVscGVyLm9mZihcInJlY2VpdmVUckRhdGEua2l3b29tXCIpO1xyXG5cdFx0S2l3b29tSGVscGVyLm9mZihcInJlY2VpdmVUckRhdGEua2l3b29tXCIsIFwib3B0MTAwMDFcIik7XHJcblx0XHRLaXdvb21IZWxwZXIub2ZmKFwicmVjZWl2ZVRyRGF0YS5raXdvb21cIiwgW1wib3B0MTAwMDFcIiwgXCJvcHQxMDAwMlwiXSApO1xyXG5cdCAqL1xyXG5cdG9mZihldmVudE5hbWUsIHRyQ29kZSkge1xyXG5cdFx0Ly8gQWxsIGV2ZW50IGRldGFjaC5cclxuXHRcdGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XHJcblx0XHRcdHRoaXMuX2V2ZW50SGFuZGxlciA9IHt9O1xyXG5cdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdH1cclxuXHRcdGlmICh0eXBlb2YgdHJDb2RlID09PSBcInVuZGVmaW5lZFwiICkge1xyXG5cdFx0XHR0aGlzLl9ldmVudEhhbmRsZXJbZXZlbnROYW1lXSA9IHVuZGVmaW5lZDtcclxuXHRcdH0gZWxzZSBpZiAodHlwZW9mIHRyQ29kZSA9PT0gXCJzdHJpbmdcIikge1xyXG5cdFx0XHR0aGlzLl9ldmVudEhhbmRsZXJbZ2V0RXZlbnRLZXkoZXZlbnROYW1lLCB0ckNvZGUpXSA9IHVuZGVmaW5lZDtcclxuXHRcdH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh0ckNvZGUpKSB7XHJcblx0XHRcdE9iamVjdC5rZXlzKHRoaXMuX2V2ZW50SGFuZGxlcilcclxuXHRcdFx0XHQuZmlsdGVyKHYgPT4gdi5pbmRleE9mKGV2ZW50TmFtZSArIFwiX1wiKSA9PT0gMClcclxuXHRcdFx0XHQuZm9yRWFjaCh2ID0+IHtcclxuXHRcdFx0XHRcdHRoaXMuX2V2ZW50SGFuZGxlcltnZXRFdmVudEtleShldmVudE5hbWUsIHYpXSA9IHVuZGVmaW5lZDtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBpc0xvZ2luXHJcblx0ICogQG1ldGhvZCBLaXdvb21IZWxwZXIjaXNMb2dpblxyXG5cdCAqIEByZXR1cm4ge051bWJlcn0gbG9naW4gc3RhdHVzXHJcblx0ICogQGV4YW1wbGVcclxuXHRcdEtpd29vbUhlbHBlci5pc0xvZ2luKCk7XHJcblx0ICovXHJcblx0aXNMb2dpbigpIHtcclxuXHRcdHJldHVybiBraXdvb20uZ2V0Q29ubmVjdFN0YXRlKCk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIGxvZ2luXHJcblx0ICogQG1ldGhvZCBLaXdvb21IZWxwZXIjbG9naW5cclxuXHQgKiBAcmV0dXJuIHtQcm9taXNlfSBQcm9taXNlIGluc3RhbmNlXHJcblx0ICogQGV4YW1wbGVcclxuXHRcdEtpd29vbUhlbHBlci5sb2dpbigpLnRoZW4oZnVuY3Rpb24oKSB7XHJcblx0XHRcdC8vIC4uLlxyXG5cdFx0fSk7XHJcblx0ICovXHJcblx0bG9naW4oKSB7XHJcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cdFx0XHRjb25zdCBzdGF0dXMgPSBraXdvb20uZ2V0Q29ubmVjdFN0YXRlKCk7XHJcblx0XHQgICAgaWYoc3RhdHVzID09IDApIHtcclxuXHRcdCAgICAgICAgbGV0IHJ0ID0ga2l3b29tLmNvbW1Db25uZWN0KCk7XHJcblx0XHQgICAgICAgIHJ0IDwgMCAmJiByZWplY3QoRXJyb3IocnQpKTtcclxuXHRcdCAgICB9IGVsc2UgaWYoc3RhdHVzID09IDEpIHtcclxuXHRcdCAgICAgICAgcmVzb2x2ZSgpO1xyXG5cdFx0ICAgIH1cclxuXHRcdCAgICBsZXQgaGFuZGVyID0gKGUpID0+IHtcclxuXHRcdCAgICBcdHZhciBlcnJjb2RlID0gZS5kZXRhaWw7XHJcblx0XHRcdCAgICBlcnJjb2RlID09IDAgPyByZXNvbHZlKCkgOiByZWplY3QoRXJyb3IoZXJyY29kZSkpO1xyXG5cdFx0XHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJldmVudENvbm5lY3Qua2l3b29tXCIsIGhhbmRlcik7XHJcblx0XHQgICAgfVxyXG5cdFx0ICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJldmVudENvbm5lY3Qua2l3b29tXCIsIGhhbmRlcik7XHJcblxyXG5cdFx0fSk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIGdldCBsb2dpbiBpbmZvcm1hdGlvblxyXG5cdCAqIEBtZXRob2QgS2l3b29tSGVscGVyI2dldExvZ2luSW5mb1xyXG5cdCAqIEByZXR1cm4ge09iamVjdH0gdXNlciBpbmZvcm1hdGlvblxyXG5cdCAqIEBleGFtcGxlXHJcblx0XHRLaXdvb21IZWxwZXIuZ2V0TG9naW5JbmZvKCk7XHJcblx0ICovXHJcblx0Z2V0TG9naW5JbmZvKCkge1xyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0YWNjb3VudCA6IGtpd29vbS5nZXRMb2dpbkluZm8oXCJBQ0NOT1wiKS5yZXBsYWNlKC87JC8sXCJcIikuc3BsaXQoXCI7XCIpLFxyXG5cdFx0XHR1c2VyIDoge1xyXG5cdFx0XHRcdGlkIDoga2l3b29tLmdldExvZ2luSW5mbyhcIlVTRVJfSURcIiksXHJcblx0XHRcdFx0bmFtZSA6IGtpd29vbS5nZXRMb2dpbkluZm8oXCJVU0VSX05BTUVcIilcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogcmVxdWVzdFxyXG5cdCAqIEBtZXRob2QgS2l3b29tSGVscGVyI3JlcXVlc3RcclxuXHQgKiBAcGFyYW0ge1N0cmluZ30gdHJDb2RlXHJcblx0ICogQHBhcmFtIHtPYmplY3R9IGlucHV0XHJcblx0ICogQHBhcmFtIHtCb29sZWFufSBpc0NvbnRpbnVlPWZhbHNlXHJcblx0ICogQHJldHVybiB7U3RyaW5nfSBzY3JlZW5Ob1xyXG5cdCAqIEBleGFtcGxlXHJcblx0XHRLaXdvb21IZWxwZXIucmVxdWVzdChcIm9wdDEwMDAxXCIsIHtcclxuXHRcdFx0XCLsooXrqqnsvZTrk5xcIiA6IFwiMDM1NDIwXCJcclxuXHRcdH0pO1xyXG5cdCAqL1xyXG5cdHJlcXVlc3QodHJDb2RlLCBpbnB1dCwgaXNDb250aW51ZSA9IGZhbHNlKSB7XHJcblx0XHQvL0B0b2RvIHNjcmVlbk5vIDIwMOqwnOqwgCDrhJjsnLzrqbQg7JWI65Cc64ukLlxyXG5cdFx0Ly/si6Tsi5zqsIQg7KGw6rG06rKA7IOJ7J2AIOy1nOuMgCAxMOqwnFxyXG5cdFx0T2JqZWN0LmtleXMoaW5wdXQpLmZvckVhY2godiA9PiB7XHJcblx0XHRcdGtpd29vbS5zZXRJbnB1dFZhbHVlKHYsIGlucHV0W3ZdKTtcclxuXHRcdH0pO1xyXG5cdFx0Ly8g7ZmU66m0IOuyiO2YuOuKlCDsnpDrj5nsnLzroZxcclxuXHRcdGxldCBzY3JlZW5ObyA9IHRoaXMuX2dldFNjcmVlbk5vKCk7XHJcblx0XHRsZXQgcmVzdWx0ID0ga2l3b29tLmNvbW1ScURhdGEodHJDb2RlLCB0ckNvZGUsIGlzQ29udGludWUgPyAyIDogMCwgc2NyZWVuTm8pO1xyXG5cdFx0aWYocmVzdWx0ID09PSAwKSB7XHJcblx0XHRcdC8vIO2ZlOuptCDrsojtmLjrpbwg7KCA7J6lXHJcblx0XHRcdHRoaXMuX3JlcXVlc3RTY3JlZW5zLnB1c2goc2NyZWVuTm8pO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHNjcmVlbk5vO1xyXG5cdH1cclxuXHRyZWdpc3RlcihzdG9ja2NvZGVzLCBmaWRzLCBpc05ldyA9IHRydWUpIHtcclxuXHRcdGlmKCFBcnJheS5pc0FycmF5KHN0b2NrY29kZXMpKSB7XHJcblx0XHRcdHN0b2NrY29kZXMgPSBbc3RvY2tjb2Rlc107XHJcblx0XHR9XHJcblx0XHRpZighQXJyYXkuaXNBcnJheShmaWRzKSkge1xyXG5cdFx0XHRmaWRzID0gW2ZpZHNdO1xyXG5cdFx0fVxyXG5cdFx0bGV0IHNjcmVlbk5vID0gdGhpcy5fZ2V0U2NyZWVuTm8oKTtcclxuXHRcdGxldCByZXN1bHQgPSBraXdvb20uc2V0UmVhbFJlZyhzY3JlZW5Obywgc3RvY2tjb2Rlcy5qb2luKFwiO1wiKSwgZmlkcy5qb2luKFwiO1wiKSwgaXNOZXcgPyAwIDogMSk7XHJcblxyXG5cdFx0aWYocmVzdWx0ID09PSAwKSB7XHJcblx0XHRcdC8vIO2ZlOuptCDrsojtmLjrpbwg7KCA7J6lXHJcblx0XHRcdHRoaXMuX3JlZ2lzdGVyU2NyZWVucy5wdXNoKHNjcmVlbk5vKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiByZXN1bHQ7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIGRpc2Nvbm5lY3RcclxuXHQgKiBAbWV0aG9kIEtpd29vbUhlbHBlciNkaXNjb25uZWN0XHJcblx0ICogQHBhcmFtIHtTdHJpbmd9IHNjcmVlbk5vXHJcblx0ICogQHBhcmFtIHtTdHJpbmd9IFtzdG9ja2NvZGU9XCJBTExcIl1cclxuXHQgKiBAZXhhbXBsZVxyXG5cdFx0S2l3b29tSGVscGVyLmRpc2Nvbm5lY3QoXCJTUkMxXCIpO1xyXG5cdFx0S2l3b29tSGVscGVyLmRpc2Nvbm5lY3QoXCJTUkMyXCIsIFwiXCIwMzU0MjBcIik7XHJcblx0ICovXHJcblx0ZGlzY29ubmVjdChzY3JlZW5Obywgc3RvY2tjb2RlID0gXCJBTExcIikge1xyXG5cdFx0aWYoc2NyZWVuTm8pIHtcclxuXHRcdFx0aWYodGhpcy5fcmVxdWVzdFNjcmVlbnMuaW5kZXhPZihzY3JlZW5ObykgIT09IC0xKSB7XHJcblx0XHRcdFx0a2l3d29tLkRpc2Nvbm5lY3RSZWFsRGF0YShzY3JlZW5Obyk7XHJcblx0XHRcdH0gZWxzZSBpZih0aGlzLl9yZWdpc3RlclNjcmVlbnMuaW5kZXhPZihzY3JlZW5ObykgIT09IC0xKSB7XHJcblx0XHRcdFx0a2l3d29tLlNldFJlYWxSZW1vdmUoc2NyZWVuTm8sIHN0b2NrY29kZSk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMuX3JlcXVlc3RTY3JlZW5zLmZvckVhY2godiA9PiB7XHJcblx0XHRcdFx0a2l3d29tLkRpc2Nvbm5lY3RSZWFsRGF0YSh2KTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdHRoaXMuX3JlcXVlc3RTY3JlZW5zLmxlbmd0aCA9IDA7XHJcblx0XHRcdGtpd3dvbS5TZXRSZWFsUmVtb3ZlKFwiQUxMXCIsIFwiQUxMXCIpO1xyXG5cdFx0XHR0aGlzLl9yZWdpc3RlclNjcmVlbnMubGVuZ3RoID0gMDtcclxuXHRcdH1cclxuXHR9XHJcblx0Z2V0KCkge1xyXG5cdFx0c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpIHtcclxuXHRcdFx0Y2FzZSAxOlxyXG5cdFx0XHRcdC8vIOuMgOyaqeufiSDrjbDsnbTthLAgKHRyQ29kZeunjCDsnoXroKUpXHJcblx0XHRcdFx0cmV0dXJuIEpTT04ucGFyc2Uoa2l3b29tLmdldENvbW1EYXRhRXgoYXJndW1lbnRzWzBdLCBhcmd1bWVudHNbMF0pKTtcclxuXHRcdFx0Y2FzZSAyOlxyXG5cdFx0XHRcdC8vIOyytOqysCDrjbDsnbTthLBcclxuXHRcdFx0XHRyZXR1cm4ga2l3b29tLmNvbW1HZXREYXRhKGFyZ3VtZW50c1swXSwgXCItMVwiLCBcIlwiLCBhcmd1bWVudHNbMV0sIFwiXCIpO1xyXG5cdFx0XHRjYXNlIDM6XHJcblx0XHRcdFx0aWYoIWlzTmFOKGFyZ3VtZW50c1sxXSkgJiYgaXNOYU4oYXJndW1lbnRzWzJdKSkge1xyXG5cdFx0XHRcdFx0Ly8gdHJhbnMg642w7J207YSwXHJcblx0XHRcdFx0XHQvLyBnZXQo4oCcT1BUMDAwMDHigJ0sIDAsIOKAnO2YhOyerOqwgOKAnSk7XHJcblx0XHRcdFx0XHRyZXR1cm4ga2l3b29tLmNvbW1HZXREYXRhKGFyZ3VtZW50c1swXSwgXCJcIiwgLi4uYXJndW1lbnRzKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0Ly8gcmVhbCDrjbDsnbTthLBcclxuXHRcdFx0XHRcdC8vIOyiheuqqey9lOuTnCwgcmVhbFR5cGUsIGZpZFxyXG5cdFx0XHRcdFx0Ly8gZ2V0KFwiMDAwNjAwXCIsICdBJywgMTApO1xyXG5cdFx0XHRcdFx0cmV0dXJuIGtpd29vbS5jb21tR2V0RGF0YSguLi5hcmd1bWVudHMsICAwLCBcIlwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59XHJcbktpd29vbUhlbHBlci5FVkVOVFMgPSBbXHJcblx0XCJyZWNlaXZlTXNnXCIsXHJcblx0XCJyZWNlaXZlVHJEYXRhXCIsXHJcblx0XCJyZWNlaXZlUmVhbERhdGFcIixcclxuXHRcInJlY2VpdmVDaGVqYW5EYXRhXCIsXHJcblx0XCJyZWNlaXZlQ29uZGl0aW9uVmVyXCIsXHJcblx0XCJyZWNlaXZlVHJDb25kaXRpb25cIixcclxuXHRcInJlY2VpdmVSZWFsQ29uZGl0aW9uXCJcclxuXTtcclxuXHJcbi8vIHNpbmdsZXRvblxyXG5leHBvcnQgZGVmYXVsdCBuZXcgS2l3b29tSGVscGVyKCk7XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9raXdvb20taGVscGVyLmpzXG4gKiovIiwiLyohXG4gKiBAb3ZlcnZpZXcgZXM2LXByb21pc2UgLSBhIHRpbnkgaW1wbGVtZW50YXRpb24gb2YgUHJvbWlzZXMvQSsuXG4gKiBAY29weXJpZ2h0IENvcHlyaWdodCAoYykgMjAxNCBZZWh1ZGEgS2F0eiwgVG9tIERhbGUsIFN0ZWZhbiBQZW5uZXIgYW5kIGNvbnRyaWJ1dG9ycyAoQ29udmVyc2lvbiB0byBFUzYgQVBJIGJ5IEpha2UgQXJjaGliYWxkKVxuICogQGxpY2Vuc2UgICBMaWNlbnNlZCB1bmRlciBNSVQgbGljZW5zZVxuICogICAgICAgICAgICBTZWUgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2pha2VhcmNoaWJhbGQvZXM2LXByb21pc2UvbWFzdGVyL0xJQ0VOU0VcbiAqIEB2ZXJzaW9uICAgMy4yLjFcbiAqL1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJHV0aWxzJCRvYmplY3RPckZ1bmN0aW9uKHgpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgeCA9PT0gJ2Z1bmN0aW9uJyB8fCAodHlwZW9mIHggPT09ICdvYmplY3QnICYmIHggIT09IG51bGwpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSR1dGlscyQkaXNGdW5jdGlvbih4KSB7XG4gICAgICByZXR1cm4gdHlwZW9mIHggPT09ICdmdW5jdGlvbic7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJHV0aWxzJCRpc01heWJlVGhlbmFibGUoeCkge1xuICAgICAgcmV0dXJuIHR5cGVvZiB4ID09PSAnb2JqZWN0JyAmJiB4ICE9PSBudWxsO1xuICAgIH1cblxuICAgIHZhciBsaWIkZXM2JHByb21pc2UkdXRpbHMkJF9pc0FycmF5O1xuICAgIGlmICghQXJyYXkuaXNBcnJheSkge1xuICAgICAgbGliJGVzNiRwcm9taXNlJHV0aWxzJCRfaXNBcnJheSA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoeCkgPT09ICdbb2JqZWN0IEFycmF5XSc7XG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICBsaWIkZXM2JHByb21pc2UkdXRpbHMkJF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcbiAgICB9XG5cbiAgICB2YXIgbGliJGVzNiRwcm9taXNlJHV0aWxzJCRpc0FycmF5ID0gbGliJGVzNiRwcm9taXNlJHV0aWxzJCRfaXNBcnJheTtcbiAgICB2YXIgbGliJGVzNiRwcm9taXNlJGFzYXAkJGxlbiA9IDA7XG4gICAgdmFyIGxpYiRlczYkcHJvbWlzZSRhc2FwJCR2ZXJ0eE5leHQ7XG4gICAgdmFyIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRjdXN0b21TY2hlZHVsZXJGbjtcblxuICAgIHZhciBsaWIkZXM2JHByb21pc2UkYXNhcCQkYXNhcCA9IGZ1bmN0aW9uIGFzYXAoY2FsbGJhY2ssIGFyZykge1xuICAgICAgbGliJGVzNiRwcm9taXNlJGFzYXAkJHF1ZXVlW2xpYiRlczYkcHJvbWlzZSRhc2FwJCRsZW5dID0gY2FsbGJhY2s7XG4gICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkcXVldWVbbGliJGVzNiRwcm9taXNlJGFzYXAkJGxlbiArIDFdID0gYXJnO1xuICAgICAgbGliJGVzNiRwcm9taXNlJGFzYXAkJGxlbiArPSAyO1xuICAgICAgaWYgKGxpYiRlczYkcHJvbWlzZSRhc2FwJCRsZW4gPT09IDIpIHtcbiAgICAgICAgLy8gSWYgbGVuIGlzIDIsIHRoYXQgbWVhbnMgdGhhdCB3ZSBuZWVkIHRvIHNjaGVkdWxlIGFuIGFzeW5jIGZsdXNoLlxuICAgICAgICAvLyBJZiBhZGRpdGlvbmFsIGNhbGxiYWNrcyBhcmUgcXVldWVkIGJlZm9yZSB0aGUgcXVldWUgaXMgZmx1c2hlZCwgdGhleVxuICAgICAgICAvLyB3aWxsIGJlIHByb2Nlc3NlZCBieSB0aGlzIGZsdXNoIHRoYXQgd2UgYXJlIHNjaGVkdWxpbmcuXG4gICAgICAgIGlmIChsaWIkZXM2JHByb21pc2UkYXNhcCQkY3VzdG9tU2NoZWR1bGVyRm4pIHtcbiAgICAgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkY3VzdG9tU2NoZWR1bGVyRm4obGliJGVzNiRwcm9taXNlJGFzYXAkJGZsdXNoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkc2NoZWR1bGVGbHVzaCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJGFzYXAkJHNldFNjaGVkdWxlcihzY2hlZHVsZUZuKSB7XG4gICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkY3VzdG9tU2NoZWR1bGVyRm4gPSBzY2hlZHVsZUZuO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRzZXRBc2FwKGFzYXBGbikge1xuICAgICAgbGliJGVzNiRwcm9taXNlJGFzYXAkJGFzYXAgPSBhc2FwRm47XG4gICAgfVxuXG4gICAgdmFyIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRicm93c2VyV2luZG93ID0gKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSA/IHdpbmRvdyA6IHVuZGVmaW5lZDtcbiAgICB2YXIgbGliJGVzNiRwcm9taXNlJGFzYXAkJGJyb3dzZXJHbG9iYWwgPSBsaWIkZXM2JHByb21pc2UkYXNhcCQkYnJvd3NlcldpbmRvdyB8fCB7fTtcbiAgICB2YXIgbGliJGVzNiRwcm9taXNlJGFzYXAkJEJyb3dzZXJNdXRhdGlvbk9ic2VydmVyID0gbGliJGVzNiRwcm9taXNlJGFzYXAkJGJyb3dzZXJHbG9iYWwuTXV0YXRpb25PYnNlcnZlciB8fCBsaWIkZXM2JHByb21pc2UkYXNhcCQkYnJvd3Nlckdsb2JhbC5XZWJLaXRNdXRhdGlvbk9ic2VydmVyO1xuICAgIHZhciBsaWIkZXM2JHByb21pc2UkYXNhcCQkaXNOb2RlID0gdHlwZW9mIHNlbGYgPT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHByb2Nlc3MpID09PSAnW29iamVjdCBwcm9jZXNzXSc7XG5cbiAgICAvLyB0ZXN0IGZvciB3ZWIgd29ya2VyIGJ1dCBub3QgaW4gSUUxMFxuICAgIHZhciBsaWIkZXM2JHByb21pc2UkYXNhcCQkaXNXb3JrZXIgPSB0eXBlb2YgVWludDhDbGFtcGVkQXJyYXkgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICB0eXBlb2YgaW1wb3J0U2NyaXB0cyAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgIHR5cGVvZiBNZXNzYWdlQ2hhbm5lbCAhPT0gJ3VuZGVmaW5lZCc7XG5cbiAgICAvLyBub2RlXG4gICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJGFzYXAkJHVzZU5leHRUaWNrKCkge1xuICAgICAgLy8gbm9kZSB2ZXJzaW9uIDAuMTAueCBkaXNwbGF5cyBhIGRlcHJlY2F0aW9uIHdhcm5pbmcgd2hlbiBuZXh0VGljayBpcyB1c2VkIHJlY3Vyc2l2ZWx5XG4gICAgICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2N1am9qcy93aGVuL2lzc3Vlcy80MTAgZm9yIGRldGFpbHNcbiAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgcHJvY2Vzcy5uZXh0VGljayhsaWIkZXM2JHByb21pc2UkYXNhcCQkZmx1c2gpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyB2ZXJ0eFxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRhc2FwJCR1c2VWZXJ0eFRpbWVyKCkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkdmVydHhOZXh0KGxpYiRlczYkcHJvbWlzZSRhc2FwJCRmbHVzaCk7XG4gICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRhc2FwJCR1c2VNdXRhdGlvbk9ic2VydmVyKCkge1xuICAgICAgdmFyIGl0ZXJhdGlvbnMgPSAwO1xuICAgICAgdmFyIG9ic2VydmVyID0gbmV3IGxpYiRlczYkcHJvbWlzZSRhc2FwJCRCcm93c2VyTXV0YXRpb25PYnNlcnZlcihsaWIkZXM2JHByb21pc2UkYXNhcCQkZmx1c2gpO1xuICAgICAgdmFyIG5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnJyk7XG4gICAgICBvYnNlcnZlci5vYnNlcnZlKG5vZGUsIHsgY2hhcmFjdGVyRGF0YTogdHJ1ZSB9KTtcblxuICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICBub2RlLmRhdGEgPSAoaXRlcmF0aW9ucyA9ICsraXRlcmF0aW9ucyAlIDIpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyB3ZWIgd29ya2VyXG4gICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJGFzYXAkJHVzZU1lc3NhZ2VDaGFubmVsKCkge1xuICAgICAgdmFyIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKTtcbiAgICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gbGliJGVzNiRwcm9taXNlJGFzYXAkJGZsdXNoO1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2hhbm5lbC5wb3J0Mi5wb3N0TWVzc2FnZSgwKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJGFzYXAkJHVzZVNldFRpbWVvdXQoKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgIHNldFRpbWVvdXQobGliJGVzNiRwcm9taXNlJGFzYXAkJGZsdXNoLCAxKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgdmFyIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRxdWV1ZSA9IG5ldyBBcnJheSgxMDAwKTtcbiAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkYXNhcCQkZmx1c2goKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpYiRlczYkcHJvbWlzZSRhc2FwJCRsZW47IGkrPTIpIHtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gbGliJGVzNiRwcm9taXNlJGFzYXAkJHF1ZXVlW2ldO1xuICAgICAgICB2YXIgYXJnID0gbGliJGVzNiRwcm9taXNlJGFzYXAkJHF1ZXVlW2krMV07XG5cbiAgICAgICAgY2FsbGJhY2soYXJnKTtcblxuICAgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkcXVldWVbaV0gPSB1bmRlZmluZWQ7XG4gICAgICAgIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRxdWV1ZVtpKzFdID0gdW5kZWZpbmVkO1xuICAgICAgfVxuXG4gICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkbGVuID0gMDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkYXNhcCQkYXR0ZW1wdFZlcnR4KCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdmFyIHIgPSByZXF1aXJlO1xuICAgICAgICB2YXIgdmVydHggPSByKCd2ZXJ0eCcpO1xuICAgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkdmVydHhOZXh0ID0gdmVydHgucnVuT25Mb29wIHx8IHZlcnR4LnJ1bk9uQ29udGV4dDtcbiAgICAgICAgcmV0dXJuIGxpYiRlczYkcHJvbWlzZSRhc2FwJCR1c2VWZXJ0eFRpbWVyKCk7XG4gICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgcmV0dXJuIGxpYiRlczYkcHJvbWlzZSRhc2FwJCR1c2VTZXRUaW1lb3V0KCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRzY2hlZHVsZUZsdXNoO1xuICAgIC8vIERlY2lkZSB3aGF0IGFzeW5jIG1ldGhvZCB0byB1c2UgdG8gdHJpZ2dlcmluZyBwcm9jZXNzaW5nIG9mIHF1ZXVlZCBjYWxsYmFja3M6XG4gICAgaWYgKGxpYiRlczYkcHJvbWlzZSRhc2FwJCRpc05vZGUpIHtcbiAgICAgIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRzY2hlZHVsZUZsdXNoID0gbGliJGVzNiRwcm9taXNlJGFzYXAkJHVzZU5leHRUaWNrKCk7XG4gICAgfSBlbHNlIGlmIChsaWIkZXM2JHByb21pc2UkYXNhcCQkQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAgIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRzY2hlZHVsZUZsdXNoID0gbGliJGVzNiRwcm9taXNlJGFzYXAkJHVzZU11dGF0aW9uT2JzZXJ2ZXIoKTtcbiAgICB9IGVsc2UgaWYgKGxpYiRlczYkcHJvbWlzZSRhc2FwJCRpc1dvcmtlcikge1xuICAgICAgbGliJGVzNiRwcm9taXNlJGFzYXAkJHNjaGVkdWxlRmx1c2ggPSBsaWIkZXM2JHByb21pc2UkYXNhcCQkdXNlTWVzc2FnZUNoYW5uZWwoKTtcbiAgICB9IGVsc2UgaWYgKGxpYiRlczYkcHJvbWlzZSRhc2FwJCRicm93c2VyV2luZG93ID09PSB1bmRlZmluZWQgJiYgdHlwZW9mIHJlcXVpcmUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRzY2hlZHVsZUZsdXNoID0gbGliJGVzNiRwcm9taXNlJGFzYXAkJGF0dGVtcHRWZXJ0eCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkc2NoZWR1bGVGbHVzaCA9IGxpYiRlczYkcHJvbWlzZSRhc2FwJCR1c2VTZXRUaW1lb3V0KCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSR0aGVuJCR0aGVuKG9uRnVsZmlsbG1lbnQsIG9uUmVqZWN0aW9uKSB7XG4gICAgICB2YXIgcGFyZW50ID0gdGhpcztcblxuICAgICAgdmFyIGNoaWxkID0gbmV3IHRoaXMuY29uc3RydWN0b3IobGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkbm9vcCk7XG5cbiAgICAgIGlmIChjaGlsZFtsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRQUk9NSVNFX0lEXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJG1ha2VQcm9taXNlKGNoaWxkKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHN0YXRlID0gcGFyZW50Ll9zdGF0ZTtcblxuICAgICAgaWYgKHN0YXRlKSB7XG4gICAgICAgIHZhciBjYWxsYmFjayA9IGFyZ3VtZW50c1tzdGF0ZSAtIDFdO1xuICAgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkYXNhcChmdW5jdGlvbigpe1xuICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGludm9rZUNhbGxiYWNrKHN0YXRlLCBjaGlsZCwgY2FsbGJhY2ssIHBhcmVudC5fcmVzdWx0KTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRzdWJzY3JpYmUocGFyZW50LCBjaGlsZCwgb25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY2hpbGQ7XG4gICAgfVxuICAgIHZhciBsaWIkZXM2JHByb21pc2UkdGhlbiQkZGVmYXVsdCA9IGxpYiRlczYkcHJvbWlzZSR0aGVuJCR0aGVuO1xuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJHJlc29sdmUkJHJlc29sdmUob2JqZWN0KSB7XG4gICAgICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICAgICAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcblxuICAgICAgaWYgKG9iamVjdCAmJiB0eXBlb2Ygb2JqZWN0ID09PSAnb2JqZWN0JyAmJiBvYmplY3QuY29uc3RydWN0b3IgPT09IENvbnN0cnVjdG9yKSB7XG4gICAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgICB9XG5cbiAgICAgIHZhciBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJG5vb3ApO1xuICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcmVzb2x2ZShwcm9taXNlLCBvYmplY3QpO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfVxuICAgIHZhciBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRyZXNvbHZlJCRkZWZhdWx0ID0gbGliJGVzNiRwcm9taXNlJHByb21pc2UkcmVzb2x2ZSQkcmVzb2x2ZTtcbiAgICB2YXIgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkUFJPTUlTRV9JRCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygxNik7XG5cbiAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRub29wKCkge31cblxuICAgIHZhciBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRQRU5ESU5HICAgPSB2b2lkIDA7XG4gICAgdmFyIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJEZVTEZJTExFRCA9IDE7XG4gICAgdmFyIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFJFSkVDVEVEICA9IDI7XG5cbiAgICB2YXIgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkR0VUX1RIRU5fRVJST1IgPSBuZXcgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkRXJyb3JPYmplY3QoKTtcblxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHNlbGZGdWxmaWxsbWVudCgpIHtcbiAgICAgIHJldHVybiBuZXcgVHlwZUVycm9yKFwiWW91IGNhbm5vdCByZXNvbHZlIGEgcHJvbWlzZSB3aXRoIGl0c2VsZlwiKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRjYW5ub3RSZXR1cm5Pd24oKSB7XG4gICAgICByZXR1cm4gbmV3IFR5cGVFcnJvcignQSBwcm9taXNlcyBjYWxsYmFjayBjYW5ub3QgcmV0dXJuIHRoYXQgc2FtZSBwcm9taXNlLicpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGdldFRoZW4ocHJvbWlzZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbjtcbiAgICAgIH0gY2F0Y2goZXJyb3IpIHtcbiAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkR0VUX1RIRU5fRVJST1IuZXJyb3IgPSBlcnJvcjtcbiAgICAgICAgcmV0dXJuIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJEdFVF9USEVOX0VSUk9SO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHRyeVRoZW4odGhlbiwgdmFsdWUsIGZ1bGZpbGxtZW50SGFuZGxlciwgcmVqZWN0aW9uSGFuZGxlcikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhlbi5jYWxsKHZhbHVlLCBmdWxmaWxsbWVudEhhbmRsZXIsIHJlamVjdGlvbkhhbmRsZXIpO1xuICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgIHJldHVybiBlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGhhbmRsZUZvcmVpZ25UaGVuYWJsZShwcm9taXNlLCB0aGVuYWJsZSwgdGhlbikge1xuICAgICAgIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRhc2FwKGZ1bmN0aW9uKHByb21pc2UpIHtcbiAgICAgICAgdmFyIHNlYWxlZCA9IGZhbHNlO1xuICAgICAgICB2YXIgZXJyb3IgPSBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCR0cnlUaGVuKHRoZW4sIHRoZW5hYmxlLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIGlmIChzZWFsZWQpIHsgcmV0dXJuOyB9XG4gICAgICAgICAgc2VhbGVkID0gdHJ1ZTtcbiAgICAgICAgICBpZiAodGhlbmFibGUgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRyZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkZnVsZmlsbChwcm9taXNlLCB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICBpZiAoc2VhbGVkKSB7IHJldHVybjsgfVxuICAgICAgICAgIHNlYWxlZCA9IHRydWU7XG5cbiAgICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRyZWplY3QocHJvbWlzZSwgcmVhc29uKTtcbiAgICAgICAgfSwgJ1NldHRsZTogJyArIChwcm9taXNlLl9sYWJlbCB8fCAnIHVua25vd24gcHJvbWlzZScpKTtcblxuICAgICAgICBpZiAoIXNlYWxlZCAmJiBlcnJvcikge1xuICAgICAgICAgIHNlYWxlZCA9IHRydWU7XG4gICAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcmVqZWN0KHByb21pc2UsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfSwgcHJvbWlzZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkaGFuZGxlT3duVGhlbmFibGUocHJvbWlzZSwgdGhlbmFibGUpIHtcbiAgICAgIGlmICh0aGVuYWJsZS5fc3RhdGUgPT09IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJEZVTEZJTExFRCkge1xuICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRmdWxmaWxsKHByb21pc2UsIHRoZW5hYmxlLl9yZXN1bHQpO1xuICAgICAgfSBlbHNlIGlmICh0aGVuYWJsZS5fc3RhdGUgPT09IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFJFSkVDVEVEKSB7XG4gICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlamVjdChwcm9taXNlLCB0aGVuYWJsZS5fcmVzdWx0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHN1YnNjcmliZSh0aGVuYWJsZSwgdW5kZWZpbmVkLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlc29sdmUocHJvbWlzZSwgdmFsdWUpO1xuICAgICAgICB9LCBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRyZWplY3QocHJvbWlzZSwgcmVhc29uKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkaGFuZGxlTWF5YmVUaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlLCB0aGVuKSB7XG4gICAgICBpZiAobWF5YmVUaGVuYWJsZS5jb25zdHJ1Y3RvciA9PT0gcHJvbWlzZS5jb25zdHJ1Y3RvciAmJlxuICAgICAgICAgIHRoZW4gPT09IGxpYiRlczYkcHJvbWlzZSR0aGVuJCRkZWZhdWx0ICYmXG4gICAgICAgICAgY29uc3RydWN0b3IucmVzb2x2ZSA9PT0gbGliJGVzNiRwcm9taXNlJHByb21pc2UkcmVzb2x2ZSQkZGVmYXVsdCkge1xuICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRoYW5kbGVPd25UaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0aGVuID09PSBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRHRVRfVEhFTl9FUlJPUikge1xuICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlamVjdChwcm9taXNlLCBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRHRVRfVEhFTl9FUlJPUi5lcnJvcik7XG4gICAgICAgIH0gZWxzZSBpZiAodGhlbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkZnVsZmlsbChwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcbiAgICAgICAgfSBlbHNlIGlmIChsaWIkZXM2JHByb21pc2UkdXRpbHMkJGlzRnVuY3Rpb24odGhlbikpIHtcbiAgICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRoYW5kbGVGb3JlaWduVGhlbmFibGUocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSwgdGhlbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkZnVsZmlsbChwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlc29sdmUocHJvbWlzZSwgdmFsdWUpIHtcbiAgICAgIGlmIChwcm9taXNlID09PSB2YWx1ZSkge1xuICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRyZWplY3QocHJvbWlzZSwgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkc2VsZkZ1bGZpbGxtZW50KCkpO1xuICAgICAgfSBlbHNlIGlmIChsaWIkZXM2JHByb21pc2UkdXRpbHMkJG9iamVjdE9yRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGhhbmRsZU1heWJlVGhlbmFibGUocHJvbWlzZSwgdmFsdWUsIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGdldFRoZW4odmFsdWUpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHB1Ymxpc2hSZWplY3Rpb24ocHJvbWlzZSkge1xuICAgICAgaWYgKHByb21pc2UuX29uZXJyb3IpIHtcbiAgICAgICAgcHJvbWlzZS5fb25lcnJvcihwcm9taXNlLl9yZXN1bHQpO1xuICAgICAgfVxuXG4gICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRwdWJsaXNoKHByb21pc2UpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpIHtcbiAgICAgIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkUEVORElORykgeyByZXR1cm47IH1cblxuICAgICAgcHJvbWlzZS5fcmVzdWx0ID0gdmFsdWU7XG4gICAgICBwcm9taXNlLl9zdGF0ZSA9IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJEZVTEZJTExFRDtcblxuICAgICAgaWYgKHByb21pc2UuX3N1YnNjcmliZXJzLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkYXNhcChsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRwdWJsaXNoLCBwcm9taXNlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRyZWplY3QocHJvbWlzZSwgcmVhc29uKSB7XG4gICAgICBpZiAocHJvbWlzZS5fc3RhdGUgIT09IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFBFTkRJTkcpIHsgcmV0dXJuOyB9XG4gICAgICBwcm9taXNlLl9zdGF0ZSA9IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFJFSkVDVEVEO1xuICAgICAgcHJvbWlzZS5fcmVzdWx0ID0gcmVhc29uO1xuXG4gICAgICBsaWIkZXM2JHByb21pc2UkYXNhcCQkYXNhcChsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRwdWJsaXNoUmVqZWN0aW9uLCBwcm9taXNlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRzdWJzY3JpYmUocGFyZW50LCBjaGlsZCwgb25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pIHtcbiAgICAgIHZhciBzdWJzY3JpYmVycyA9IHBhcmVudC5fc3Vic2NyaWJlcnM7XG4gICAgICB2YXIgbGVuZ3RoID0gc3Vic2NyaWJlcnMubGVuZ3RoO1xuXG4gICAgICBwYXJlbnQuX29uZXJyb3IgPSBudWxsO1xuXG4gICAgICBzdWJzY3JpYmVyc1tsZW5ndGhdID0gY2hpbGQ7XG4gICAgICBzdWJzY3JpYmVyc1tsZW5ndGggKyBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRGVUxGSUxMRURdID0gb25GdWxmaWxsbWVudDtcbiAgICAgIHN1YnNjcmliZXJzW2xlbmd0aCArIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFJFSkVDVEVEXSAgPSBvblJlamVjdGlvbjtcblxuICAgICAgaWYgKGxlbmd0aCA9PT0gMCAmJiBwYXJlbnQuX3N0YXRlKSB7XG4gICAgICAgIGxpYiRlczYkcHJvbWlzZSRhc2FwJCRhc2FwKGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHB1Ymxpc2gsIHBhcmVudCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcHVibGlzaChwcm9taXNlKSB7XG4gICAgICB2YXIgc3Vic2NyaWJlcnMgPSBwcm9taXNlLl9zdWJzY3JpYmVycztcbiAgICAgIHZhciBzZXR0bGVkID0gcHJvbWlzZS5fc3RhdGU7XG5cbiAgICAgIGlmIChzdWJzY3JpYmVycy5sZW5ndGggPT09IDApIHsgcmV0dXJuOyB9XG5cbiAgICAgIHZhciBjaGlsZCwgY2FsbGJhY2ssIGRldGFpbCA9IHByb21pc2UuX3Jlc3VsdDtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWJzY3JpYmVycy5sZW5ndGg7IGkgKz0gMykge1xuICAgICAgICBjaGlsZCA9IHN1YnNjcmliZXJzW2ldO1xuICAgICAgICBjYWxsYmFjayA9IHN1YnNjcmliZXJzW2kgKyBzZXR0bGVkXTtcblxuICAgICAgICBpZiAoY2hpbGQpIHtcbiAgICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRpbnZva2VDYWxsYmFjayhzZXR0bGVkLCBjaGlsZCwgY2FsbGJhY2ssIGRldGFpbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2FsbGJhY2soZGV0YWlsKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBwcm9taXNlLl9zdWJzY3JpYmVycy5sZW5ndGggPSAwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJEVycm9yT2JqZWN0KCkge1xuICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG4gICAgfVxuXG4gICAgdmFyIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFRSWV9DQVRDSF9FUlJPUiA9IG5ldyBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRFcnJvck9iamVjdCgpO1xuXG4gICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkdHJ5Q2F0Y2goY2FsbGJhY2ssIGRldGFpbCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGRldGFpbCk7XG4gICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkVFJZX0NBVENIX0VSUk9SLmVycm9yID0gZTtcbiAgICAgICAgcmV0dXJuIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFRSWV9DQVRDSF9FUlJPUjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRpbnZva2VDYWxsYmFjayhzZXR0bGVkLCBwcm9taXNlLCBjYWxsYmFjaywgZGV0YWlsKSB7XG4gICAgICB2YXIgaGFzQ2FsbGJhY2sgPSBsaWIkZXM2JHByb21pc2UkdXRpbHMkJGlzRnVuY3Rpb24oY2FsbGJhY2spLFxuICAgICAgICAgIHZhbHVlLCBlcnJvciwgc3VjY2VlZGVkLCBmYWlsZWQ7XG5cbiAgICAgIGlmIChoYXNDYWxsYmFjaykge1xuICAgICAgICB2YWx1ZSA9IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHRyeUNhdGNoKGNhbGxiYWNrLCBkZXRhaWwpO1xuXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkVFJZX0NBVENIX0VSUk9SKSB7XG4gICAgICAgICAgZmFpbGVkID0gdHJ1ZTtcbiAgICAgICAgICBlcnJvciA9IHZhbHVlLmVycm9yO1xuICAgICAgICAgIHZhbHVlID0gbnVsbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdWNjZWVkZWQgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHByb21pc2UgPT09IHZhbHVlKSB7XG4gICAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcmVqZWN0KHByb21pc2UsIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGNhbm5vdFJldHVybk93bigpKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsdWUgPSBkZXRhaWw7XG4gICAgICAgIHN1Y2NlZWRlZCA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkUEVORElORykge1xuICAgICAgICAvLyBub29wXG4gICAgICB9IGVsc2UgaWYgKGhhc0NhbGxiYWNrICYmIHN1Y2NlZWRlZCkge1xuICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRyZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcbiAgICAgIH0gZWxzZSBpZiAoZmFpbGVkKSB7XG4gICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlamVjdChwcm9taXNlLCBlcnJvcik7XG4gICAgICB9IGVsc2UgaWYgKHNldHRsZWQgPT09IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJEZVTEZJTExFRCkge1xuICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRmdWxmaWxsKHByb21pc2UsIHZhbHVlKTtcbiAgICAgIH0gZWxzZSBpZiAoc2V0dGxlZCA9PT0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkUkVKRUNURUQpIHtcbiAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcmVqZWN0KHByb21pc2UsIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRpbml0aWFsaXplUHJvbWlzZShwcm9taXNlLCByZXNvbHZlcikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmVzb2x2ZXIoZnVuY3Rpb24gcmVzb2x2ZVByb21pc2UodmFsdWUpe1xuICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlc29sdmUocHJvbWlzZSwgdmFsdWUpO1xuICAgICAgICB9LCBmdW5jdGlvbiByZWplY3RQcm9taXNlKHJlYXNvbikge1xuICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlamVjdChwcm9taXNlLCByZWFzb24pO1xuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2goZSkge1xuICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRyZWplY3QocHJvbWlzZSwgZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGlkID0gMDtcbiAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRuZXh0SWQoKSB7XG4gICAgICByZXR1cm4gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkaWQrKztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRtYWtlUHJvbWlzZShwcm9taXNlKSB7XG4gICAgICBwcm9taXNlW2xpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFBST01JU0VfSURdID0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkaWQrKztcbiAgICAgIHByb21pc2UuX3N0YXRlID0gdW5kZWZpbmVkO1xuICAgICAgcHJvbWlzZS5fcmVzdWx0ID0gdW5kZWZpbmVkO1xuICAgICAgcHJvbWlzZS5fc3Vic2NyaWJlcnMgPSBbXTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRhbGwkJGFsbChlbnRyaWVzKSB7XG4gICAgICByZXR1cm4gbmV3IGxpYiRlczYkcHJvbWlzZSRlbnVtZXJhdG9yJCRkZWZhdWx0KHRoaXMsIGVudHJpZXMpLnByb21pc2U7XG4gICAgfVxuICAgIHZhciBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRhbGwkJGRlZmF1bHQgPSBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRhbGwkJGFsbDtcbiAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRyYWNlJCRyYWNlKGVudHJpZXMpIHtcbiAgICAgIC8qanNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gICAgICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuXG4gICAgICBpZiAoIWxpYiRlczYkcHJvbWlzZSR1dGlscyQkaXNBcnJheShlbnRyaWVzKSkge1xuICAgICAgICByZXR1cm4gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgIHJlamVjdChuZXcgVHlwZUVycm9yKCdZb3UgbXVzdCBwYXNzIGFuIGFycmF5IHRvIHJhY2UuJykpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgQ29uc3RydWN0b3IoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgdmFyIGxlbmd0aCA9IGVudHJpZXMubGVuZ3RoO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIENvbnN0cnVjdG9yLnJlc29sdmUoZW50cmllc1tpXSkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIHZhciBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRyYWNlJCRkZWZhdWx0ID0gbGliJGVzNiRwcm9taXNlJHByb21pc2UkcmFjZSQkcmFjZTtcbiAgICBmdW5jdGlvbiBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRyZWplY3QkJHJlamVjdChyZWFzb24pIHtcbiAgICAgIC8qanNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gICAgICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuICAgICAgdmFyIHByb21pc2UgPSBuZXcgQ29uc3RydWN0b3IobGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkbm9vcCk7XG4gICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRyZWplY3QocHJvbWlzZSwgcmVhc29uKTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH1cbiAgICB2YXIgbGliJGVzNiRwcm9taXNlJHByb21pc2UkcmVqZWN0JCRkZWZhdWx0ID0gbGliJGVzNiRwcm9taXNlJHByb21pc2UkcmVqZWN0JCRyZWplY3Q7XG5cblxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRuZWVkc1Jlc29sdmVyKCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignWW91IG11c3QgcGFzcyBhIHJlc29sdmVyIGZ1bmN0aW9uIGFzIHRoZSBmaXJzdCBhcmd1bWVudCB0byB0aGUgcHJvbWlzZSBjb25zdHJ1Y3RvcicpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRuZWVkc05ldygpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJGYWlsZWQgdG8gY29uc3RydWN0ICdQcm9taXNlJzogUGxlYXNlIHVzZSB0aGUgJ25ldycgb3BlcmF0b3IsIHRoaXMgb2JqZWN0IGNvbnN0cnVjdG9yIGNhbm5vdCBiZSBjYWxsZWQgYXMgYSBmdW5jdGlvbi5cIik7XG4gICAgfVxuXG4gICAgdmFyIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRkZWZhdWx0ID0gbGliJGVzNiRwcm9taXNlJHByb21pc2UkJFByb21pc2U7XG4gICAgLyoqXG4gICAgICBQcm9taXNlIG9iamVjdHMgcmVwcmVzZW50IHRoZSBldmVudHVhbCByZXN1bHQgb2YgYW4gYXN5bmNocm9ub3VzIG9wZXJhdGlvbi4gVGhlXG4gICAgICBwcmltYXJ5IHdheSBvZiBpbnRlcmFjdGluZyB3aXRoIGEgcHJvbWlzZSBpcyB0aHJvdWdoIGl0cyBgdGhlbmAgbWV0aG9kLCB3aGljaFxuICAgICAgcmVnaXN0ZXJzIGNhbGxiYWNrcyB0byByZWNlaXZlIGVpdGhlciBhIHByb21pc2UncyBldmVudHVhbCB2YWx1ZSBvciB0aGUgcmVhc29uXG4gICAgICB3aHkgdGhlIHByb21pc2UgY2Fubm90IGJlIGZ1bGZpbGxlZC5cblxuICAgICAgVGVybWlub2xvZ3lcbiAgICAgIC0tLS0tLS0tLS0tXG5cbiAgICAgIC0gYHByb21pc2VgIGlzIGFuIG9iamVjdCBvciBmdW5jdGlvbiB3aXRoIGEgYHRoZW5gIG1ldGhvZCB3aG9zZSBiZWhhdmlvciBjb25mb3JtcyB0byB0aGlzIHNwZWNpZmljYXRpb24uXG4gICAgICAtIGB0aGVuYWJsZWAgaXMgYW4gb2JqZWN0IG9yIGZ1bmN0aW9uIHRoYXQgZGVmaW5lcyBhIGB0aGVuYCBtZXRob2QuXG4gICAgICAtIGB2YWx1ZWAgaXMgYW55IGxlZ2FsIEphdmFTY3JpcHQgdmFsdWUgKGluY2x1ZGluZyB1bmRlZmluZWQsIGEgdGhlbmFibGUsIG9yIGEgcHJvbWlzZSkuXG4gICAgICAtIGBleGNlcHRpb25gIGlzIGEgdmFsdWUgdGhhdCBpcyB0aHJvd24gdXNpbmcgdGhlIHRocm93IHN0YXRlbWVudC5cbiAgICAgIC0gYHJlYXNvbmAgaXMgYSB2YWx1ZSB0aGF0IGluZGljYXRlcyB3aHkgYSBwcm9taXNlIHdhcyByZWplY3RlZC5cbiAgICAgIC0gYHNldHRsZWRgIHRoZSBmaW5hbCByZXN0aW5nIHN0YXRlIG9mIGEgcHJvbWlzZSwgZnVsZmlsbGVkIG9yIHJlamVjdGVkLlxuXG4gICAgICBBIHByb21pc2UgY2FuIGJlIGluIG9uZSBvZiB0aHJlZSBzdGF0ZXM6IHBlbmRpbmcsIGZ1bGZpbGxlZCwgb3IgcmVqZWN0ZWQuXG5cbiAgICAgIFByb21pc2VzIHRoYXQgYXJlIGZ1bGZpbGxlZCBoYXZlIGEgZnVsZmlsbG1lbnQgdmFsdWUgYW5kIGFyZSBpbiB0aGUgZnVsZmlsbGVkXG4gICAgICBzdGF0ZS4gIFByb21pc2VzIHRoYXQgYXJlIHJlamVjdGVkIGhhdmUgYSByZWplY3Rpb24gcmVhc29uIGFuZCBhcmUgaW4gdGhlXG4gICAgICByZWplY3RlZCBzdGF0ZS4gIEEgZnVsZmlsbG1lbnQgdmFsdWUgaXMgbmV2ZXIgYSB0aGVuYWJsZS5cblxuICAgICAgUHJvbWlzZXMgY2FuIGFsc28gYmUgc2FpZCB0byAqcmVzb2x2ZSogYSB2YWx1ZS4gIElmIHRoaXMgdmFsdWUgaXMgYWxzbyBhXG4gICAgICBwcm9taXNlLCB0aGVuIHRoZSBvcmlnaW5hbCBwcm9taXNlJ3Mgc2V0dGxlZCBzdGF0ZSB3aWxsIG1hdGNoIHRoZSB2YWx1ZSdzXG4gICAgICBzZXR0bGVkIHN0YXRlLiAgU28gYSBwcm9taXNlIHRoYXQgKnJlc29sdmVzKiBhIHByb21pc2UgdGhhdCByZWplY3RzIHdpbGxcbiAgICAgIGl0c2VsZiByZWplY3QsIGFuZCBhIHByb21pc2UgdGhhdCAqcmVzb2x2ZXMqIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbGxzIHdpbGxcbiAgICAgIGl0c2VsZiBmdWxmaWxsLlxuXG5cbiAgICAgIEJhc2ljIFVzYWdlOlxuICAgICAgLS0tLS0tLS0tLS0tXG5cbiAgICAgIGBgYGpzXG4gICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAvLyBvbiBzdWNjZXNzXG4gICAgICAgIHJlc29sdmUodmFsdWUpO1xuXG4gICAgICAgIC8vIG9uIGZhaWx1cmVcbiAgICAgICAgcmVqZWN0KHJlYXNvbik7XG4gICAgICB9KTtcblxuICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIC8vIG9uIGZ1bGZpbGxtZW50XG4gICAgICB9LCBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgLy8gb24gcmVqZWN0aW9uXG4gICAgICB9KTtcbiAgICAgIGBgYFxuXG4gICAgICBBZHZhbmNlZCBVc2FnZTpcbiAgICAgIC0tLS0tLS0tLS0tLS0tLVxuXG4gICAgICBQcm9taXNlcyBzaGluZSB3aGVuIGFic3RyYWN0aW5nIGF3YXkgYXN5bmNocm9ub3VzIGludGVyYWN0aW9ucyBzdWNoIGFzXG4gICAgICBgWE1MSHR0cFJlcXVlc3Rgcy5cblxuICAgICAgYGBganNcbiAgICAgIGZ1bmN0aW9uIGdldEpTT04odXJsKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgICAgICAgIHhoci5vcGVuKCdHRVQnLCB1cmwpO1xuICAgICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBoYW5kbGVyO1xuICAgICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnanNvbic7XG4gICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgICAgICAgeGhyLnNlbmQoKTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZXIoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSB0aGlzLkRPTkUpIHtcbiAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMucmVzcG9uc2UpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ2dldEpTT046IGAnICsgdXJsICsgJ2AgZmFpbGVkIHdpdGggc3RhdHVzOiBbJyArIHRoaXMuc3RhdHVzICsgJ10nKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZ2V0SlNPTignL3Bvc3RzLmpzb24nKS50aGVuKGZ1bmN0aW9uKGpzb24pIHtcbiAgICAgICAgLy8gb24gZnVsZmlsbG1lbnRcbiAgICAgIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAvLyBvbiByZWplY3Rpb25cbiAgICAgIH0pO1xuICAgICAgYGBgXG5cbiAgICAgIFVubGlrZSBjYWxsYmFja3MsIHByb21pc2VzIGFyZSBncmVhdCBjb21wb3NhYmxlIHByaW1pdGl2ZXMuXG5cbiAgICAgIGBgYGpzXG4gICAgICBQcm9taXNlLmFsbChbXG4gICAgICAgIGdldEpTT04oJy9wb3N0cycpLFxuICAgICAgICBnZXRKU09OKCcvY29tbWVudHMnKVxuICAgICAgXSkudGhlbihmdW5jdGlvbih2YWx1ZXMpe1xuICAgICAgICB2YWx1ZXNbMF0gLy8gPT4gcG9zdHNKU09OXG4gICAgICAgIHZhbHVlc1sxXSAvLyA9PiBjb21tZW50c0pTT05cblxuICAgICAgICByZXR1cm4gdmFsdWVzO1xuICAgICAgfSk7XG4gICAgICBgYGBcblxuICAgICAgQGNsYXNzIFByb21pc2VcbiAgICAgIEBwYXJhbSB7ZnVuY3Rpb259IHJlc29sdmVyXG4gICAgICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gICAgICBAY29uc3RydWN0b3JcbiAgICAqL1xuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRQcm9taXNlKHJlc29sdmVyKSB7XG4gICAgICB0aGlzW2xpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFBST01JU0VfSURdID0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkbmV4dElkKCk7XG4gICAgICB0aGlzLl9yZXN1bHQgPSB0aGlzLl9zdGF0ZSA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMuX3N1YnNjcmliZXJzID0gW107XG5cbiAgICAgIGlmIChsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRub29wICE9PSByZXNvbHZlcikge1xuICAgICAgICB0eXBlb2YgcmVzb2x2ZXIgIT09ICdmdW5jdGlvbicgJiYgbGliJGVzNiRwcm9taXNlJHByb21pc2UkJG5lZWRzUmVzb2x2ZXIoKTtcbiAgICAgICAgdGhpcyBpbnN0YW5jZW9mIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRQcm9taXNlID8gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkaW5pdGlhbGl6ZVByb21pc2UodGhpcywgcmVzb2x2ZXIpIDogbGliJGVzNiRwcm9taXNlJHByb21pc2UkJG5lZWRzTmV3KCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGliJGVzNiRwcm9taXNlJHByb21pc2UkJFByb21pc2UuYWxsID0gbGliJGVzNiRwcm9taXNlJHByb21pc2UkYWxsJCRkZWZhdWx0O1xuICAgIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRQcm9taXNlLnJhY2UgPSBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRyYWNlJCRkZWZhdWx0O1xuICAgIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRQcm9taXNlLnJlc29sdmUgPSBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSRyZXNvbHZlJCRkZWZhdWx0O1xuICAgIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRQcm9taXNlLnJlamVjdCA9IGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJHJlamVjdCQkZGVmYXVsdDtcbiAgICBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSQkUHJvbWlzZS5fc2V0U2NoZWR1bGVyID0gbGliJGVzNiRwcm9taXNlJGFzYXAkJHNldFNjaGVkdWxlcjtcbiAgICBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSQkUHJvbWlzZS5fc2V0QXNhcCA9IGxpYiRlczYkcHJvbWlzZSRhc2FwJCRzZXRBc2FwO1xuICAgIGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRQcm9taXNlLl9hc2FwID0gbGliJGVzNiRwcm9taXNlJGFzYXAkJGFzYXA7XG5cbiAgICBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSQkUHJvbWlzZS5wcm90b3R5cGUgPSB7XG4gICAgICBjb25zdHJ1Y3RvcjogbGliJGVzNiRwcm9taXNlJHByb21pc2UkJFByb21pc2UsXG5cbiAgICAvKipcbiAgICAgIFRoZSBwcmltYXJ5IHdheSBvZiBpbnRlcmFjdGluZyB3aXRoIGEgcHJvbWlzZSBpcyB0aHJvdWdoIGl0cyBgdGhlbmAgbWV0aG9kLFxuICAgICAgd2hpY2ggcmVnaXN0ZXJzIGNhbGxiYWNrcyB0byByZWNlaXZlIGVpdGhlciBhIHByb21pc2UncyBldmVudHVhbCB2YWx1ZSBvciB0aGVcbiAgICAgIHJlYXNvbiB3aHkgdGhlIHByb21pc2UgY2Fubm90IGJlIGZ1bGZpbGxlZC5cblxuICAgICAgYGBganNcbiAgICAgIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbih1c2VyKXtcbiAgICAgICAgLy8gdXNlciBpcyBhdmFpbGFibGVcbiAgICAgIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgICAgIC8vIHVzZXIgaXMgdW5hdmFpbGFibGUsIGFuZCB5b3UgYXJlIGdpdmVuIHRoZSByZWFzb24gd2h5XG4gICAgICB9KTtcbiAgICAgIGBgYFxuXG4gICAgICBDaGFpbmluZ1xuICAgICAgLS0tLS0tLS1cblxuICAgICAgVGhlIHJldHVybiB2YWx1ZSBvZiBgdGhlbmAgaXMgaXRzZWxmIGEgcHJvbWlzZS4gIFRoaXMgc2Vjb25kLCAnZG93bnN0cmVhbSdcbiAgICAgIHByb21pc2UgaXMgcmVzb2x2ZWQgd2l0aCB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBmaXJzdCBwcm9taXNlJ3MgZnVsZmlsbG1lbnRcbiAgICAgIG9yIHJlamVjdGlvbiBoYW5kbGVyLCBvciByZWplY3RlZCBpZiB0aGUgaGFuZGxlciB0aHJvd3MgYW4gZXhjZXB0aW9uLlxuXG4gICAgICBgYGBqc1xuICAgICAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIHJldHVybiB1c2VyLm5hbWU7XG4gICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgIHJldHVybiAnZGVmYXVsdCBuYW1lJztcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHVzZXJOYW1lKSB7XG4gICAgICAgIC8vIElmIGBmaW5kVXNlcmAgZnVsZmlsbGVkLCBgdXNlck5hbWVgIHdpbGwgYmUgdGhlIHVzZXIncyBuYW1lLCBvdGhlcndpc2UgaXRcbiAgICAgICAgLy8gd2lsbCBiZSBgJ2RlZmF1bHQgbmFtZSdgXG4gICAgICB9KTtcblxuICAgICAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRm91bmQgdXNlciwgYnV0IHN0aWxsIHVuaGFwcHknKTtcbiAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdgZmluZFVzZXJgIHJlamVjdGVkIGFuZCB3ZSdyZSB1bmhhcHB5Jyk7XG4gICAgICB9KS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAvLyBuZXZlciByZWFjaGVkXG4gICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgIC8vIGlmIGBmaW5kVXNlcmAgZnVsZmlsbGVkLCBgcmVhc29uYCB3aWxsIGJlICdGb3VuZCB1c2VyLCBidXQgc3RpbGwgdW5oYXBweScuXG4gICAgICAgIC8vIElmIGBmaW5kVXNlcmAgcmVqZWN0ZWQsIGByZWFzb25gIHdpbGwgYmUgJ2BmaW5kVXNlcmAgcmVqZWN0ZWQgYW5kIHdlJ3JlIHVuaGFwcHknLlxuICAgICAgfSk7XG4gICAgICBgYGBcbiAgICAgIElmIHRoZSBkb3duc3RyZWFtIHByb21pc2UgZG9lcyBub3Qgc3BlY2lmeSBhIHJlamVjdGlvbiBoYW5kbGVyLCByZWplY3Rpb24gcmVhc29ucyB3aWxsIGJlIHByb3BhZ2F0ZWQgZnVydGhlciBkb3duc3RyZWFtLlxuXG4gICAgICBgYGBqc1xuICAgICAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIHRocm93IG5ldyBQZWRhZ29naWNhbEV4Y2VwdGlvbignVXBzdHJlYW0gZXJyb3InKTtcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIC8vIG5ldmVyIHJlYWNoZWRcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIC8vIG5ldmVyIHJlYWNoZWRcbiAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgICAgLy8gVGhlIGBQZWRnYWdvY2lhbEV4Y2VwdGlvbmAgaXMgcHJvcGFnYXRlZCBhbGwgdGhlIHdheSBkb3duIHRvIGhlcmVcbiAgICAgIH0pO1xuICAgICAgYGBgXG5cbiAgICAgIEFzc2ltaWxhdGlvblxuICAgICAgLS0tLS0tLS0tLS0tXG5cbiAgICAgIFNvbWV0aW1lcyB0aGUgdmFsdWUgeW91IHdhbnQgdG8gcHJvcGFnYXRlIHRvIGEgZG93bnN0cmVhbSBwcm9taXNlIGNhbiBvbmx5IGJlXG4gICAgICByZXRyaWV2ZWQgYXN5bmNocm9ub3VzbHkuIFRoaXMgY2FuIGJlIGFjaGlldmVkIGJ5IHJldHVybmluZyBhIHByb21pc2UgaW4gdGhlXG4gICAgICBmdWxmaWxsbWVudCBvciByZWplY3Rpb24gaGFuZGxlci4gVGhlIGRvd25zdHJlYW0gcHJvbWlzZSB3aWxsIHRoZW4gYmUgcGVuZGluZ1xuICAgICAgdW50aWwgdGhlIHJldHVybmVkIHByb21pc2UgaXMgc2V0dGxlZC4gVGhpcyBpcyBjYWxsZWQgKmFzc2ltaWxhdGlvbiouXG5cbiAgICAgIGBgYGpzXG4gICAgICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGZpbmRDb21tZW50c0J5QXV0aG9yKHVzZXIpO1xuICAgICAgfSkudGhlbihmdW5jdGlvbiAoY29tbWVudHMpIHtcbiAgICAgICAgLy8gVGhlIHVzZXIncyBjb21tZW50cyBhcmUgbm93IGF2YWlsYWJsZVxuICAgICAgfSk7XG4gICAgICBgYGBcblxuICAgICAgSWYgdGhlIGFzc2ltbGlhdGVkIHByb21pc2UgcmVqZWN0cywgdGhlbiB0aGUgZG93bnN0cmVhbSBwcm9taXNlIHdpbGwgYWxzbyByZWplY3QuXG5cbiAgICAgIGBgYGpzXG4gICAgICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGZpbmRDb21tZW50c0J5QXV0aG9yKHVzZXIpO1xuICAgICAgfSkudGhlbihmdW5jdGlvbiAoY29tbWVudHMpIHtcbiAgICAgICAgLy8gSWYgYGZpbmRDb21tZW50c0J5QXV0aG9yYCBmdWxmaWxscywgd2UnbGwgaGF2ZSB0aGUgdmFsdWUgaGVyZVxuICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgICAvLyBJZiBgZmluZENvbW1lbnRzQnlBdXRob3JgIHJlamVjdHMsIHdlJ2xsIGhhdmUgdGhlIHJlYXNvbiBoZXJlXG4gICAgICB9KTtcbiAgICAgIGBgYFxuXG4gICAgICBTaW1wbGUgRXhhbXBsZVxuICAgICAgLS0tLS0tLS0tLS0tLS1cblxuICAgICAgU3luY2hyb25vdXMgRXhhbXBsZVxuXG4gICAgICBgYGBqYXZhc2NyaXB0XG4gICAgICB2YXIgcmVzdWx0O1xuXG4gICAgICB0cnkge1xuICAgICAgICByZXN1bHQgPSBmaW5kUmVzdWx0KCk7XG4gICAgICAgIC8vIHN1Y2Nlc3NcbiAgICAgIH0gY2F0Y2gocmVhc29uKSB7XG4gICAgICAgIC8vIGZhaWx1cmVcbiAgICAgIH1cbiAgICAgIGBgYFxuXG4gICAgICBFcnJiYWNrIEV4YW1wbGVcblxuICAgICAgYGBganNcbiAgICAgIGZpbmRSZXN1bHQoZnVuY3Rpb24ocmVzdWx0LCBlcnIpe1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgLy8gZmFpbHVyZVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIHN1Y2Nlc3NcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBgYGBcblxuICAgICAgUHJvbWlzZSBFeGFtcGxlO1xuXG4gICAgICBgYGBqYXZhc2NyaXB0XG4gICAgICBmaW5kUmVzdWx0KCkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgICAvLyBzdWNjZXNzXG4gICAgICB9LCBmdW5jdGlvbihyZWFzb24pe1xuICAgICAgICAvLyBmYWlsdXJlXG4gICAgICB9KTtcbiAgICAgIGBgYFxuXG4gICAgICBBZHZhbmNlZCBFeGFtcGxlXG4gICAgICAtLS0tLS0tLS0tLS0tLVxuXG4gICAgICBTeW5jaHJvbm91cyBFeGFtcGxlXG5cbiAgICAgIGBgYGphdmFzY3JpcHRcbiAgICAgIHZhciBhdXRob3IsIGJvb2tzO1xuXG4gICAgICB0cnkge1xuICAgICAgICBhdXRob3IgPSBmaW5kQXV0aG9yKCk7XG4gICAgICAgIGJvb2tzICA9IGZpbmRCb29rc0J5QXV0aG9yKGF1dGhvcik7XG4gICAgICAgIC8vIHN1Y2Nlc3NcbiAgICAgIH0gY2F0Y2gocmVhc29uKSB7XG4gICAgICAgIC8vIGZhaWx1cmVcbiAgICAgIH1cbiAgICAgIGBgYFxuXG4gICAgICBFcnJiYWNrIEV4YW1wbGVcblxuICAgICAgYGBganNcblxuICAgICAgZnVuY3Rpb24gZm91bmRCb29rcyhib29rcykge1xuXG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGZhaWx1cmUocmVhc29uKSB7XG5cbiAgICAgIH1cblxuICAgICAgZmluZEF1dGhvcihmdW5jdGlvbihhdXRob3IsIGVycil7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICBmYWlsdXJlKGVycik7XG4gICAgICAgICAgLy8gZmFpbHVyZVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmaW5kQm9vb2tzQnlBdXRob3IoYXV0aG9yLCBmdW5jdGlvbihib29rcywgZXJyKSB7XG4gICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICBmYWlsdXJlKGVycik7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgIGZvdW5kQm9va3MoYm9va3MpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2gocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICBmYWlsdXJlKHJlYXNvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGNhdGNoKGVycm9yKSB7XG4gICAgICAgICAgICBmYWlsdXJlKGVycik7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIHN1Y2Nlc3NcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBgYGBcblxuICAgICAgUHJvbWlzZSBFeGFtcGxlO1xuXG4gICAgICBgYGBqYXZhc2NyaXB0XG4gICAgICBmaW5kQXV0aG9yKCkuXG4gICAgICAgIHRoZW4oZmluZEJvb2tzQnlBdXRob3IpLlxuICAgICAgICB0aGVuKGZ1bmN0aW9uKGJvb2tzKXtcbiAgICAgICAgICAvLyBmb3VuZCBib29rc1xuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKXtcbiAgICAgICAgLy8gc29tZXRoaW5nIHdlbnQgd3JvbmdcbiAgICAgIH0pO1xuICAgICAgYGBgXG5cbiAgICAgIEBtZXRob2QgdGhlblxuICAgICAgQHBhcmFtIHtGdW5jdGlvbn0gb25GdWxmaWxsZWRcbiAgICAgIEBwYXJhbSB7RnVuY3Rpb259IG9uUmVqZWN0ZWRcbiAgICAgIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgICAgIEByZXR1cm4ge1Byb21pc2V9XG4gICAgKi9cbiAgICAgIHRoZW46IGxpYiRlczYkcHJvbWlzZSR0aGVuJCRkZWZhdWx0LFxuXG4gICAgLyoqXG4gICAgICBgY2F0Y2hgIGlzIHNpbXBseSBzdWdhciBmb3IgYHRoZW4odW5kZWZpbmVkLCBvblJlamVjdGlvbilgIHdoaWNoIG1ha2VzIGl0IHRoZSBzYW1lXG4gICAgICBhcyB0aGUgY2F0Y2ggYmxvY2sgb2YgYSB0cnkvY2F0Y2ggc3RhdGVtZW50LlxuXG4gICAgICBgYGBqc1xuICAgICAgZnVuY3Rpb24gZmluZEF1dGhvcigpe1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkbid0IGZpbmQgdGhhdCBhdXRob3InKTtcbiAgICAgIH1cblxuICAgICAgLy8gc3luY2hyb25vdXNcbiAgICAgIHRyeSB7XG4gICAgICAgIGZpbmRBdXRob3IoKTtcbiAgICAgIH0gY2F0Y2gocmVhc29uKSB7XG4gICAgICAgIC8vIHNvbWV0aGluZyB3ZW50IHdyb25nXG4gICAgICB9XG5cbiAgICAgIC8vIGFzeW5jIHdpdGggcHJvbWlzZXNcbiAgICAgIGZpbmRBdXRob3IoKS5jYXRjaChmdW5jdGlvbihyZWFzb24pe1xuICAgICAgICAvLyBzb21ldGhpbmcgd2VudCB3cm9uZ1xuICAgICAgfSk7XG4gICAgICBgYGBcblxuICAgICAgQG1ldGhvZCBjYXRjaFxuICAgICAgQHBhcmFtIHtGdW5jdGlvbn0gb25SZWplY3Rpb25cbiAgICAgIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgICAgIEByZXR1cm4ge1Byb21pc2V9XG4gICAgKi9cbiAgICAgICdjYXRjaCc6IGZ1bmN0aW9uKG9uUmVqZWN0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRoZW4obnVsbCwgb25SZWplY3Rpb24pO1xuICAgICAgfVxuICAgIH07XG4gICAgdmFyIGxpYiRlczYkcHJvbWlzZSRlbnVtZXJhdG9yJCRkZWZhdWx0ID0gbGliJGVzNiRwcm9taXNlJGVudW1lcmF0b3IkJEVudW1lcmF0b3I7XG4gICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJGVudW1lcmF0b3IkJEVudW1lcmF0b3IoQ29uc3RydWN0b3IsIGlucHV0KSB7XG4gICAgICB0aGlzLl9pbnN0YW5jZUNvbnN0cnVjdG9yID0gQ29uc3RydWN0b3I7XG4gICAgICB0aGlzLnByb21pc2UgPSBuZXcgQ29uc3RydWN0b3IobGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkbm9vcCk7XG5cbiAgICAgIGlmICghdGhpcy5wcm9taXNlW2xpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFBST01JU0VfSURdKSB7XG4gICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJG1ha2VQcm9taXNlKHRoaXMucHJvbWlzZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChsaWIkZXM2JHByb21pc2UkdXRpbHMkJGlzQXJyYXkoaW5wdXQpKSB7XG4gICAgICAgIHRoaXMuX2lucHV0ICAgICA9IGlucHV0O1xuICAgICAgICB0aGlzLmxlbmd0aCAgICAgPSBpbnB1dC5sZW5ndGg7XG4gICAgICAgIHRoaXMuX3JlbWFpbmluZyA9IGlucHV0Lmxlbmd0aDtcblxuICAgICAgICB0aGlzLl9yZXN1bHQgPSBuZXcgQXJyYXkodGhpcy5sZW5ndGgpO1xuXG4gICAgICAgIGlmICh0aGlzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGZ1bGZpbGwodGhpcy5wcm9taXNlLCB0aGlzLl9yZXN1bHQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubGVuZ3RoID0gdGhpcy5sZW5ndGggfHwgMDtcbiAgICAgICAgICB0aGlzLl9lbnVtZXJhdGUoKTtcbiAgICAgICAgICBpZiAodGhpcy5fcmVtYWluaW5nID09PSAwKSB7XG4gICAgICAgICAgICBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRmdWxmaWxsKHRoaXMucHJvbWlzZSwgdGhpcy5fcmVzdWx0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHJlamVjdCh0aGlzLnByb21pc2UsIGxpYiRlczYkcHJvbWlzZSRlbnVtZXJhdG9yJCR2YWxpZGF0aW9uRXJyb3IoKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGliJGVzNiRwcm9taXNlJGVudW1lcmF0b3IkJHZhbGlkYXRpb25FcnJvcigpIHtcbiAgICAgIHJldHVybiBuZXcgRXJyb3IoJ0FycmF5IE1ldGhvZHMgbXVzdCBiZSBwcm92aWRlZCBhbiBBcnJheScpO1xuICAgIH1cblxuICAgIGxpYiRlczYkcHJvbWlzZSRlbnVtZXJhdG9yJCRFbnVtZXJhdG9yLnByb3RvdHlwZS5fZW51bWVyYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbGVuZ3RoICA9IHRoaXMubGVuZ3RoO1xuICAgICAgdmFyIGlucHV0ICAgPSB0aGlzLl9pbnB1dDtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IHRoaXMuX3N0YXRlID09PSBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRQRU5ESU5HICYmIGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLl9lYWNoRW50cnkoaW5wdXRbaV0sIGkpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBsaWIkZXM2JHByb21pc2UkZW51bWVyYXRvciQkRW51bWVyYXRvci5wcm90b3R5cGUuX2VhY2hFbnRyeSA9IGZ1bmN0aW9uKGVudHJ5LCBpKSB7XG4gICAgICB2YXIgYyA9IHRoaXMuX2luc3RhbmNlQ29uc3RydWN0b3I7XG4gICAgICB2YXIgcmVzb2x2ZSA9IGMucmVzb2x2ZTtcblxuICAgICAgaWYgKHJlc29sdmUgPT09IGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJHJlc29sdmUkJGRlZmF1bHQpIHtcbiAgICAgICAgdmFyIHRoZW4gPSBsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRnZXRUaGVuKGVudHJ5KTtcblxuICAgICAgICBpZiAodGhlbiA9PT0gbGliJGVzNiRwcm9taXNlJHRoZW4kJGRlZmF1bHQgJiZcbiAgICAgICAgICAgIGVudHJ5Ll9zdGF0ZSAhPT0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkUEVORElORykge1xuICAgICAgICAgIHRoaXMuX3NldHRsZWRBdChlbnRyeS5fc3RhdGUsIGksIGVudHJ5Ll9yZXN1bHQpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB0aGVuICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgdGhpcy5fcmVtYWluaW5nLS07XG4gICAgICAgICAgdGhpcy5fcmVzdWx0W2ldID0gZW50cnk7XG4gICAgICAgIH0gZWxzZSBpZiAoYyA9PT0gbGliJGVzNiRwcm9taXNlJHByb21pc2UkJGRlZmF1bHQpIHtcbiAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBjKGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJG5vb3ApO1xuICAgICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGhhbmRsZU1heWJlVGhlbmFibGUocHJvbWlzZSwgZW50cnksIHRoZW4pO1xuICAgICAgICAgIHRoaXMuX3dpbGxTZXR0bGVBdChwcm9taXNlLCBpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl93aWxsU2V0dGxlQXQobmV3IGMoZnVuY3Rpb24ocmVzb2x2ZSkgeyByZXNvbHZlKGVudHJ5KTsgfSksIGkpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl93aWxsU2V0dGxlQXQocmVzb2x2ZShlbnRyeSksIGkpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBsaWIkZXM2JHByb21pc2UkZW51bWVyYXRvciQkRW51bWVyYXRvci5wcm90b3R5cGUuX3NldHRsZWRBdCA9IGZ1bmN0aW9uKHN0YXRlLCBpLCB2YWx1ZSkge1xuICAgICAgdmFyIHByb21pc2UgPSB0aGlzLnByb21pc2U7XG5cbiAgICAgIGlmIChwcm9taXNlLl9zdGF0ZSA9PT0gbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkUEVORElORykge1xuICAgICAgICB0aGlzLl9yZW1haW5pbmctLTtcblxuICAgICAgICBpZiAoc3RhdGUgPT09IGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJFJFSkVDVEVEKSB7XG4gICAgICAgICAgbGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkcmVqZWN0KHByb21pc2UsIHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl9yZXN1bHRbaV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5fcmVtYWluaW5nID09PSAwKSB7XG4gICAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJGZ1bGZpbGwocHJvbWlzZSwgdGhpcy5fcmVzdWx0KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgbGliJGVzNiRwcm9taXNlJGVudW1lcmF0b3IkJEVudW1lcmF0b3IucHJvdG90eXBlLl93aWxsU2V0dGxlQXQgPSBmdW5jdGlvbihwcm9taXNlLCBpKSB7XG4gICAgICB2YXIgZW51bWVyYXRvciA9IHRoaXM7XG5cbiAgICAgIGxpYiRlczYkcHJvbWlzZSQkaW50ZXJuYWwkJHN1YnNjcmliZShwcm9taXNlLCB1bmRlZmluZWQsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIGVudW1lcmF0b3IuX3NldHRsZWRBdChsaWIkZXM2JHByb21pc2UkJGludGVybmFsJCRGVUxGSUxMRUQsIGksIHZhbHVlKTtcbiAgICAgIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICBlbnVtZXJhdG9yLl9zZXR0bGVkQXQobGliJGVzNiRwcm9taXNlJCRpbnRlcm5hbCQkUkVKRUNURUQsIGksIHJlYXNvbik7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIGZ1bmN0aW9uIGxpYiRlczYkcHJvbWlzZSRwb2x5ZmlsbCQkcG9seWZpbGwoKSB7XG4gICAgICB2YXIgbG9jYWw7XG5cbiAgICAgIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgIGxvY2FsID0gZ2xvYmFsO1xuICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICBsb2NhbCA9IHNlbGY7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGxvY2FsID0gRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigncG9seWZpbGwgZmFpbGVkIGJlY2F1c2UgZ2xvYmFsIG9iamVjdCBpcyB1bmF2YWlsYWJsZSBpbiB0aGlzIGVudmlyb25tZW50Jyk7XG4gICAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB2YXIgUCA9IGxvY2FsLlByb21pc2U7XG5cbiAgICAgIGlmIChQICYmIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChQLnJlc29sdmUoKSkgPT09ICdbb2JqZWN0IFByb21pc2VdJyAmJiAhUC5jYXN0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbG9jYWwuUHJvbWlzZSA9IGxpYiRlczYkcHJvbWlzZSRwcm9taXNlJCRkZWZhdWx0O1xuICAgIH1cbiAgICB2YXIgbGliJGVzNiRwcm9taXNlJHBvbHlmaWxsJCRkZWZhdWx0ID0gbGliJGVzNiRwcm9taXNlJHBvbHlmaWxsJCRwb2x5ZmlsbDtcblxuICAgIHZhciBsaWIkZXM2JHByb21pc2UkdW1kJCRFUzZQcm9taXNlID0ge1xuICAgICAgJ1Byb21pc2UnOiBsaWIkZXM2JHByb21pc2UkcHJvbWlzZSQkZGVmYXVsdCxcbiAgICAgICdwb2x5ZmlsbCc6IGxpYiRlczYkcHJvbWlzZSRwb2x5ZmlsbCQkZGVmYXVsdFxuICAgIH07XG5cbiAgICAvKiBnbG9iYWwgZGVmaW5lOnRydWUgbW9kdWxlOnRydWUgd2luZG93OiB0cnVlICovXG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lWydhbWQnXSkge1xuICAgICAgZGVmaW5lKGZ1bmN0aW9uKCkgeyByZXR1cm4gbGliJGVzNiRwcm9taXNlJHVtZCQkRVM2UHJvbWlzZTsgfSk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGVbJ2V4cG9ydHMnXSkge1xuICAgICAgbW9kdWxlWydleHBvcnRzJ10gPSBsaWIkZXM2JHByb21pc2UkdW1kJCRFUzZQcm9taXNlO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aGlzWydFUzZQcm9taXNlJ10gPSBsaWIkZXM2JHByb21pc2UkdW1kJCRFUzZQcm9taXNlO1xuICAgIH1cblxuICAgIGxpYiRlczYkcHJvbWlzZSRwb2x5ZmlsbCQkZGVmYXVsdCgpO1xufSkuY2FsbCh0aGlzKTtcblxuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2VzNi1wcm9taXNlL2Rpc3QvZXM2LXByb21pc2UuanNcbiAqKiBtb2R1bGUgaWQgPSAxXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcblxudmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG4vLyBjYWNoZWQgZnJvbSB3aGF0ZXZlciBnbG9iYWwgaXMgcHJlc2VudCBzbyB0aGF0IHRlc3QgcnVubmVycyB0aGF0IHN0dWIgaXRcbi8vIGRvbid0IGJyZWFrIHRoaW5ncy4gIEJ1dCB3ZSBuZWVkIHRvIHdyYXAgaXQgaW4gYSB0cnkgY2F0Y2ggaW4gY2FzZSBpdCBpc1xuLy8gd3JhcHBlZCBpbiBzdHJpY3QgbW9kZSBjb2RlIHdoaWNoIGRvZXNuJ3QgZGVmaW5lIGFueSBnbG9iYWxzLiAgSXQncyBpbnNpZGUgYVxuLy8gZnVuY3Rpb24gYmVjYXVzZSB0cnkvY2F0Y2hlcyBkZW9wdGltaXplIGluIGNlcnRhaW4gZW5naW5lcy5cblxudmFyIGNhY2hlZFNldFRpbWVvdXQ7XG52YXIgY2FjaGVkQ2xlYXJUaW1lb3V0O1xuXG4oZnVuY3Rpb24gKCkge1xuICB0cnkge1xuICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICB9IGNhdGNoIChlKSB7XG4gICAgY2FjaGVkU2V0VGltZW91dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignc2V0VGltZW91dCBpcyBub3QgZGVmaW5lZCcpO1xuICAgIH1cbiAgfVxuICB0cnkge1xuICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGlzIG5vdCBkZWZpbmVkJyk7XG4gICAgfVxuICB9XG59ICgpKVxudmFyIHF1ZXVlID0gW107XG52YXIgZHJhaW5pbmcgPSBmYWxzZTtcbnZhciBjdXJyZW50UXVldWU7XG52YXIgcXVldWVJbmRleCA9IC0xO1xuXG5mdW5jdGlvbiBjbGVhblVwTmV4dFRpY2soKSB7XG4gICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBpZiAoY3VycmVudFF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBxdWV1ZSA9IGN1cnJlbnRRdWV1ZS5jb25jYXQocXVldWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICB9XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBkcmFpblF1ZXVlKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcmFpblF1ZXVlKCkge1xuICAgIGlmIChkcmFpbmluZykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0aW1lb3V0ID0gY2FjaGVkU2V0VGltZW91dChjbGVhblVwTmV4dFRpY2spO1xuICAgIGRyYWluaW5nID0gdHJ1ZTtcblxuICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgd2hpbGUobGVuKSB7XG4gICAgICAgIGN1cnJlbnRRdWV1ZSA9IHF1ZXVlO1xuICAgICAgICBxdWV1ZSA9IFtdO1xuICAgICAgICB3aGlsZSAoKytxdWV1ZUluZGV4IDwgbGVuKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudFF1ZXVlKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFF1ZXVlW3F1ZXVlSW5kZXhdLnJ1bigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIH1cbiAgICBjdXJyZW50UXVldWUgPSBudWxsO1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgY2FjaGVkQ2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xufVxuXG5wcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikge1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dChkcmFpblF1ZXVlLCAwKTtcbiAgICB9XG59O1xuXG4vLyB2OCBsaWtlcyBwcmVkaWN0aWJsZSBvYmplY3RzXG5mdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHtcbiAgICB0aGlzLmZ1biA9IGZ1bjtcbiAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG59XG5JdGVtLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7XG59O1xucHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcbnByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5wcm9jZXNzLmVudiA9IHt9O1xucHJvY2Vzcy5hcmd2ID0gW107XG5wcm9jZXNzLnZlcnNpb24gPSAnJzsgLy8gZW1wdHkgc3RyaW5nIHRvIGF2b2lkIHJlZ2V4cCBpc3N1ZXNcbnByb2Nlc3MudmVyc2lvbnMgPSB7fTtcblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbnByb2Nlc3Mub24gPSBub29wO1xucHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLm9uY2UgPSBub29wO1xucHJvY2Vzcy5vZmYgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7XG5wcm9jZXNzLmVtaXQgPSBub29wO1xuXG5wcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5cbnByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07XG5wcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xucHJvY2Vzcy51bWFzayA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gMDsgfTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9wcm9jZXNzL2Jyb3dzZXIuanNcbiAqKiBtb2R1bGUgaWQgPSAyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJkZWZpbmUgY2Fubm90IGJlIHVzZWQgaW5kaXJlY3RcIik7IH07XHJcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi93ZWJwYWNrL2J1aWxkaW4vYW1kLWRlZmluZS5qc1xuICoqIG1vZHVsZSBpZCA9IDNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obW9kdWxlKSB7XHJcblx0aWYoIW1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHtcclxuXHRcdG1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9O1xyXG5cdFx0bW9kdWxlLnBhdGhzID0gW107XHJcblx0XHQvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHRcclxuXHRcdG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xyXG5cdFx0bW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7XHJcblx0fVxyXG5cdHJldHVybiBtb2R1bGU7XHJcbn1cclxuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L3dlYnBhY2svYnVpbGRpbi9tb2R1bGUuanNcbiAqKiBtb2R1bGUgaWQgPSA0XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwic291cmNlUm9vdCI6IiJ9